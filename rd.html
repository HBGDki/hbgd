<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="generator" content="pandoc" />

    <meta name="author" content="Ryan Hafen" />
  
  
  <title>hbgd</title>

    <script src="rd_files/jquery-1.11.3/jquery.min.js"></script>
  <link href="rd_files/bootstrap-3.3.2/css/bootstrap.min.css" rel="stylesheet" />
  <script src="rd_files/bootstrap-3.3.2/js/bootstrap.min.js"></script>
  <script src="rd_files/bootstrap-3.3.2/shim/html5shiv.min.js"></script>
  <script src="rd_files/bootstrap-3.3.2/shim/respond.min.js"></script>
  <link href="rd_files/highlight-8.4/tomorrow.css" rel="stylesheet" />
  <script src="rd_files/highlight-8.4/highlight.pack.js"></script>
  <link href="rd_files/fontawesome-4.3.0/css/font-awesome.min.css" rel="stylesheet" />
  <script src="rd_files/stickykit-1.1.1/sticky-kit.min.js"></script>
  <script src="rd_files/jqueryeasing-1.3/jquery.easing.min.js"></script>
  <link href="rd_files/recliner-0.2.2/recliner.css" rel="stylesheet" />
  <script src="rd_files/recliner-0.2.2/recliner.min.js"></script>
  <script src="rd_files/recliner-0.2.2/onload.js"></script>
  <link href="rd_files/packagedocs-0.0.1/pd.css" rel="stylesheet" />
  <script src="rd_files/packagedocs-0.0.1/pd.js"></script>
  <script src="rd_files/packagedocs-0.0.1/pd-collapse-toc.js"></script>
  
  
  
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
</head>

<body>

  
  <header class="navbar navbar-white navbar-fixed-top" role="banner" id="header">
    <div class="container">
      <div class="navbar-header">
        <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
                <a href="index.html" class="navbar-brand page-scroll">
        hbgd - Healthy birth, growth &amp; development
        </a>
      </div>
            <nav class="collapse navbar-collapse" role="navigation">
        <ul class="nav nav-pills pull-right">
<li>
<a href='index.html'>Docs</a>
</li>
<li class="active">
<a href='rd.html'>Package Ref</a>
</li>
<li>
<a href='https://github.com/HBGDki/hbgd'>Github <i class='fa fa-github'></i></a>
</li>
        </ul>
      </nav>
          </div>
  </header>

  <!-- Begin Body -->
  <div class="container">
    <div class="row">
            <div class="col-md-3" id="sidebar-col">
        <div id="toc">
          <ul>
          <li><a href="#data-handling">Data Handling</a><ul>
          <li><a href="#check_data">check_data</a></li>
          <li><a href="#get-subject-and-time-data">Get subject and time data</a></li>
          <li><a href="#fix_height">fix_height</a></li>
          <li><a href="#add_holdout_ind">add_holdout_ind</a></li>
          <li><a href="#view_variables">view_variables</a></li>
          <li><a href="#get_data_attributes">get_data_attributes</a></li>
          </ul></li>
          <li><a href="#who-growth-standards">WHO Growth Standards</a><ul>
          <li><a href="#generic-centilez-score-to-value">generic centile/z-score to value</a></li>
          <li><a href="#generic-value-to-centilez-score">generic value to centile/z-score</a></li>
          <li><a href="#specific-centilez-score-to-value">specific centile/z-score to value</a></li>
          <li><a href="#specific-value-to-centilez-score">specific value to centile/z-score</a></li>
          </ul></li>
          <li><a href="#intergrowth-birth-standards">Intergrowth Birth Standards</a><ul>
          <li><a href="#generic-centilez-score-to-value-1">generic centile/z-score to value</a></li>
          <li><a href="#generic-value-to-centilez-score-1">generic value to centile/z-score</a></li>
          <li><a href="#specific-centilez-score-to-value-1">specific centile/z-score to value</a></li>
          <li><a href="#specific-value-to-centilez-score-1">specific value to centile/z-score</a></li>
          </ul></li>
          <li><a href="#intergrowth-fetal-standards">Intergrowth Fetal Standards</a><ul>
          <li><a href="#generic-centilez-score-to-value-2">generic centile/z-score to value</a></li>
          <li><a href="#generic-value-to-centilez-score-2">generic value to centile/z-score</a></li>
          <li><a href="#specific-centilez-score-to-value-2">specific centile/z-score to value</a></li>
          <li><a href="#specific-value-to-centilez-score-2">specific value to centile/z-score</a></li>
          </ul></li>
          <li><a href="#growth-standard-vis">Growth Standard Vis</a><ul>
          <li><a href="#growth-standard-methods">Growth standard methods</a></li>
          <li><a href="#z-score-scale-methods">z-score scale methods</a></li>
          </ul></li>
          <li><a href="#modeling">Modeling</a><ul>
          <li><a href="#get_fit">get_fit</a></li>
          <li><a href="#fit_trajectory">fit_trajectory</a></li>
          <li><a href="#fit_all_trajectories">fit_all_trajectories</a></li>
          <li><a href="#get_fit_holdout_mse">get_fit_holdout_mse</a></li>
          <li><a href="#get_fit_holdout_errors">get_fit_holdout_errors</a></li>
          <li><a href="#plot.fittedtrajectory">plot.fittedTrajectory</a></li>
          <li><a href="#plot_z">plot_z</a></li>
          <li><a href="#plot_velocity">plot_velocity</a></li>
          <li><a href="#plot_zvelocity">plot_zvelocity</a></li>
          <li><a href="#get_avail_methods">get_avail_methods</a></li>
          <li><a href="#fit_method.brokenstick">fit_method.brokenstick</a></li>
          <li><a href="#fit_method.face">fit_method.face</a></li>
          <li><a href="#fit_method.fda">fit_method.fda</a></li>
          <li><a href="#fit_method.gam">fit_method.gam</a></li>
          <li><a href="#fit_method.loess">fit_method.loess</a></li>
          <li><a href="#fit_method.lwmod">fit_method.lwmod</a></li>
          <li><a href="#fit_method.rlm">fit_method.rlm</a></li>
          <li><a href="#fit_method.sitar">fit_method.sitar</a></li>
          <li><a href="#fit_method.smooth.spline">fit_method.smooth.spline</a></li>
          <li><a href="#fit_method.wand">fit_method.wand</a></li>
          <li><a href="#auto_loess">auto_loess</a></li>
          </ul></li>
          <li><a href="#summary-vis">Summary Vis</a><ul>
          <li><a href="#plot_univar">plot_univar</a></li>
          <li><a href="#plot_missing">plot_missing</a></li>
          <li><a href="#plot_complete_pairs">plot_complete_pairs</a></li>
          <li><a href="#plot_agefreq">plot_agefreq</a></li>
          <li><a href="#plot_first_visit_age">plot_first_visit_age</a></li>
          <li><a href="#plot_visit_distn">plot_visit_distn</a></li>
          </ul></li>
          <li><a href="#multi-study-vis">Multi-Study Vis</a><ul>
          <li><a href="#plot_var_matrix">plot_var_matrix</a></li>
          <li><a href="#plot_multi_subj_boxplot">plot_multi_subj_boxplot</a></li>
          <li><a href="#plot_time_count_grid">plot_time_count_grid</a></li>
          </ul></li>
          <li><a href="#trelliscope-vis">Trelliscope Vis</a><ul>
          <li><a href="#trscope_trajectories">trscope_trajectories</a></li>
          <li><a href="#trscope_velocities">trscope_velocities</a></li>
          </ul></li>
          <li><a href="#divisions">Divisions</a><ul>
          <li><a href="#by_subject">by_subject</a></li>
          <li><a href="#by_trajectory_checkpoints">by_trajectory_checkpoints</a></li>
          </ul></li>
          <li><a href="#data-sets">Data Sets</a><ul>
          <li><a href="#cpp">cpp</a></li>
          <li><a href="#get_smocc_data">get_smocc_data</a></li>
          <li><a href="#who_coefs">who_coefs</a></li>
          <li><a href="#ig_coefs">ig_coefs</a></li>
          <li><a href="#ig_early_coefs">ig_early_coefs</a></li>
          <li><a href="#hbgd_labels">hbgd_labels</a></li>
          <li><a href="#hbgd_labels_df">hbgd_labels_df</a></li>
          </ul></li>
          <li><a href="#misc">Misc</a><ul>
          <li><a href="#get_x_range">get_x_range</a></li>
          <li><a href="#grid_deriv">grid_deriv</a></li>
          <li><a href="#get_agefreq">get_agefreq</a></li>
          <li><a href="#log10_1">log10_1</a></li>
          <li><a href="#exp10_1">exp10_1</a></li>
          <li><a href="#get_nadir">get_nadir</a></li>
          <li><a href="#get_recovery">get_recovery</a></li>
          </ul></li>
          <li><a href="#unit-conversion">Unit Conversion</a><ul>
          <li><a href="#unit-conversion-1">Unit conversion</a></li>
          </ul></li>
          </ul>
        </div>
      </div>
      <div class="col-md-9" id="content-col">
      
<div id="content-top"></div>
<h1>
Healthy birth, growth &amp; development
</h1>
<p>
<strong>Authors:</strong> <a href="mailto:rhafen@gmail.com">Ryan Hafen</a> [aut, cre],<a href="mailto:craig.anderson@uts.edu.au">Craig Anderson</a> [ctb],<a href="mailto:schloerke@gmail.com">Barret Schloerke</a> [ctb]
</p>
<p>
<strong>Version:</strong> 0.3.6
</p>
<p>
<strong>License:</strong> MIT + file LICENSE
</p>
<h4>
Description
</h4>
<p>
A package for visual and analytical methods for the analysis of longitudinal growth data.
</p>
<h4>
Depends
</h4>
<p>
R (&gt;= 3.1), datadr (&gt;= 0.8.1), trelliscope (&gt;= 0.9.2)
</p>
<h4>
Imports
</h4>
<p>
dplyr, lattice, rbokeh (&gt;= 0.5.0), ggplot2, mgcv, MASS, numDeriv, gamlss.dist, fda, sitar (&gt;= 1.0.3), DT, lme4, nlme, scales, crayon, stringdist
</p>
<h4>
Suggests
</h4>
<p>
testthat, packagedocs, brokenstick (&gt;= 0.49), face (&gt;= 0.1-2)
</p>
<div id="data-handling" class="section level1">
<h1>Data Handling</h1>
<div id="check_data" class="section level2">
<h2>check_data</h2>
<a id="check_data_alias"></a>
<h3>
Check a dataset to ensure it will be compatible with hbgd methods
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>check_data(dat, has_height&nbsp;=&nbsp;TRUE, has_weight&nbsp;=&nbsp;TRUE, has_hcir&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
a data frame
</dd>
<dt>
has_height
</dt>
<dd class="rd-dd">
does this dataset contain anthropometric height data?
</dd>
<dt>
has_weight
</dt>
<dd class="rd-dd">
does this dataset contain anthropometric weight data?
</dd>
<dt>
has_hcir
</dt>
<dd class="rd-dd">
does this dataset contain anthropometric head circumference data?
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>check_data(cpp, has_hcir = FALSE)</code></pre>
<pre><code>## Checking if data is a data frame...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking variable name case...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking for variable &#39;subjid&#39;...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking for variable &#39;agedays&#39;...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking for variable &#39;sex&#39;...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking values of variable &#39;sex&#39;...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking for variable &#39;lencm&#39;...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking for variable &#39;htcm&#39;...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking for variable &#39;wtkg&#39;...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking for both &#39;lencm&#39; and &#39;htcm&#39;...</code></pre>
<pre><code>## Checking z-score variable &#39;haz&#39; for height...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking z-score variable &#39;waz&#39; for weight...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking to see if data is longitudinal...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking names in data that are not standard &#39;hbgd&#39; variables...</code></pre>
<pre><code>## All checks passed!</code></pre>
<pre><code>## As a final check, please ensure the units of measurement match</code></pre>
<pre><code>## the variable descriptions (e.g. age in days, height in centimeters, etc.).</code></pre>
<pre class="r"><code>smc &lt;- brokenstick::smocc.hgtwgt
check_data(smc, has_hcir = FALSE)</code></pre>
<pre><code>## Checking if data is a data frame...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking variable name case...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking for variable &#39;subjid&#39;...</code></pre>
<pre><code>## [31m✗[39m</code></pre>
<pre><code>##   Variable &#39;subjid&#39; was not found in the data.</code></pre>
<pre><code>##   Closest matches (with index): id (2), bw (9)</code></pre>
<pre><code>##   Definition: Subject ID</code></pre>
<pre><code>##   This variable is required.</code></pre>
<pre><code>##   Please create or rename the appropriate variable.</code></pre>
<pre><code>##   To rename, choose the appropriate index i and:</code></pre>
<pre><code>##   names(dat)[i] &lt;- &#39;subjid&#39;</code></pre>
<pre><code>## Checking for variable &#39;agedays&#39;...</code></pre>
<pre><code>## [31m✗[39m</code></pre>
<pre><code>##   Variable &#39;agedays&#39; was not found in the data.</code></pre>
<pre><code>##   Closest matches (with index): age (5), ga (8)</code></pre>
<pre><code>##   Definition: Age since birth at examination (days)</code></pre>
<pre><code>##   This variable is required.</code></pre>
<pre><code>##   Please create or rename the appropriate variable.</code></pre>
<pre><code>##   To rename, choose the appropriate index i and:</code></pre>
<pre><code>##   names(dat)[i] &lt;- &#39;agedays&#39;</code></pre>
<pre><code>## Checking for variable &#39;sex&#39;...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking values of variable &#39;sex&#39;...</code></pre>
<pre><code>## [31m✗[39m</code></pre>
<pre><code>##   All values of variable &#39;sex&#39; must be &#39;Male&#39; and &#39;Female&#39;.</code></pre>
<pre><code>## Checking for variable &#39;lencm&#39;...</code></pre>
<pre><code>## </code></pre>
<pre><code>##   Variable &#39;lencm&#39; was not found in the data.</code></pre>
<pre><code>##   Closest matches (with index): nrec (4), rec (3)</code></pre>
<pre><code>##   Definition: Recumbent length (cm)</code></pre>
<pre><code>##   This variable is not required but if it exists in the data</code></pre>
<pre><code>##   under a different name, please rename it to &#39;lencm&#39;.</code></pre>
<pre><code>## Checking for variable &#39;htcm&#39;...</code></pre>
<pre><code>## </code></pre>
<pre><code>##   Variable &#39;htcm&#39; was not found in the data.</code></pre>
<pre><code>##   Closest matches (with index): hgt (10), hgt.z (12)</code></pre>
<pre><code>##   Definition: Standing height (cm)</code></pre>
<pre><code>##   This variable is not required but if it exists in the data</code></pre>
<pre><code>##   under a different name, please rename it to &#39;htcm&#39;.</code></pre>
<pre><code>## Checking for variable &#39;wtkg&#39;...</code></pre>
<pre><code>## </code></pre>
<pre><code>##   Variable &#39;wtkg&#39; was not found in the data.</code></pre>
<pre><code>##   Closest matches (with index): wgt (11), hgt (10)</code></pre>
<pre><code>##   Definition: Weight (kg)</code></pre>
<pre><code>##   This variable is not required but if it exists in the data</code></pre>
<pre><code>##   under a different name, please rename it to &#39;wtkg&#39;.</code></pre>
<pre><code>## Checking for both &#39;lencm&#39; and &#39;htcm&#39;...</code></pre>
<pre><code>## Checking names in data that are not standard &#39;hbgd&#39; variables...</code></pre>
<pre><code>##   The following variables were found in the data:</code></pre>
<pre><code>##   src, id, rec, nrec, age, etn, ga, bw, hgt, wgt, hgt.z</code></pre>
<pre><code>##   Run view_variables() to see if any of these can be mapped</code></pre>
<pre><code>##   to an &#39;hbgd&#39; variable name.</code></pre>
<pre><code>## Some checks did not pass - please take action accordingly.</code></pre>
<pre class="r"><code>names(smc)[2] &lt;- &quot;subjid&quot;
names(smc)[5] &lt;- &quot;agedays&quot;
smc$sex &lt;- as.character(smc$sex)
smc$sex[smc$sex == &quot;male&quot;] &lt;- &quot;Male&quot;
smc$sex[smc$sex == &quot;female&quot;] &lt;- &quot;Female&quot;
names(smc)[10] &lt;- &quot;htcm&quot;
names(smc)[11] &lt;- &quot;wtkg&quot;

check_data(smc, has_hcir = FALSE)</code></pre>
<pre><code>## Checking if data is a data frame...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking variable name case...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking for variable &#39;subjid&#39;...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking for variable &#39;agedays&#39;...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking for variable &#39;sex&#39;...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking values of variable &#39;sex&#39;...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking for variable &#39;lencm&#39;...</code></pre>
<pre><code>## </code></pre>
<pre><code>##   Variable &#39;lencm&#39; was not found in the data.</code></pre>
<pre><code>##   Closest matches (with index): nrec (4), rec (3)</code></pre>
<pre><code>##   Definition: Recumbent length (cm)</code></pre>
<pre><code>##   This variable is not required but if it exists in the data</code></pre>
<pre><code>##   under a different name, please rename it to &#39;lencm&#39;.</code></pre>
<pre><code>## Checking for variable &#39;htcm&#39;...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking for variable &#39;wtkg&#39;...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking for both &#39;lencm&#39; and &#39;htcm&#39;...</code></pre>
<pre><code>## Checking z-score variable &#39;haz&#39; for height...</code></pre>
<pre><code>## </code></pre>
<pre><code>##   Could not find height z-score variable &#39;haz&#39;.</code></pre>
<pre><code>##   If it exists, rename it to &#39;haz&#39;.</code></pre>
<pre><code>##   If it doesn&#39;t exist, create it with:</code></pre>
<pre><code>##   dat$haz &lt;- who_htcm2zscore(dat$agedays, dat$htcm, dat$sex)</code></pre>
<pre><code>## Checking z-score variable &#39;waz&#39; for weight...</code></pre>
<pre><code>## </code></pre>
<pre><code>##   Could not find weight z-score variable &#39;waz&#39;.</code></pre>
<pre><code>##   If it exists, rename it to &#39;waz&#39;.</code></pre>
<pre><code>##   If it doesn&#39;t exist, create it with:</code></pre>
<pre><code>##   dat$waz &lt;- who_wtkg2zscore(dat$agedays, dat$wtkg, dat$sex)</code></pre>
<pre><code>## Checking to see if data is longitudinal...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking names in data that are not standard &#39;hbgd&#39; variables...</code></pre>
<pre><code>##   The following variables were found in the data:</code></pre>
<pre><code>##   src, rec, nrec, etn, ga, bw, hgt.z</code></pre>
<pre><code>##   Run view_variables() to see if any of these can be mapped</code></pre>
<pre><code>##   to an &#39;hbgd&#39; variable name.</code></pre>
<pre><code>## All checks passed!</code></pre>
<pre><code>## As a final check, please ensure the units of measurement match</code></pre>
<pre><code>## the variable descriptions (e.g. age in days, height in centimeters, etc.).</code></pre>
<pre class="r"><code>names(smc)[12] &lt;- &quot;haz&quot;
smc$waz &lt;- who_wtkg2zscore(smc$agedays, smc$wtkg, smc$sex)
smc$agedays &lt;- smc$agedays * 365.25

check_data(smc, has_hcir = FALSE)</code></pre>
<pre><code>## Checking if data is a data frame...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking variable name case...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking for variable &#39;subjid&#39;...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking for variable &#39;agedays&#39;...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking for variable &#39;sex&#39;...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking values of variable &#39;sex&#39;...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking for variable &#39;lencm&#39;...</code></pre>
<pre><code>## </code></pre>
<pre><code>##   Variable &#39;lencm&#39; was not found in the data.</code></pre>
<pre><code>##   Closest matches (with index): nrec (4), rec (3)</code></pre>
<pre><code>##   Definition: Recumbent length (cm)</code></pre>
<pre><code>##   This variable is not required but if it exists in the data</code></pre>
<pre><code>##   under a different name, please rename it to &#39;lencm&#39;.</code></pre>
<pre><code>## Checking for variable &#39;htcm&#39;...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking for variable &#39;wtkg&#39;...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking for both &#39;lencm&#39; and &#39;htcm&#39;...</code></pre>
<pre><code>## Checking z-score variable &#39;haz&#39; for height...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking z-score variable &#39;waz&#39; for weight...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking to see if data is longitudinal...</code></pre>
<pre><code>## [32m✓[39m</code></pre>
<pre><code>## Checking names in data that are not standard &#39;hbgd&#39; variables...</code></pre>
<pre><code>##   The following variables were found in the data:</code></pre>
<pre><code>##   src, rec, nrec, etn, ga, bw</code></pre>
<pre><code>##   Run view_variables() to see if any of these can be mapped</code></pre>
<pre><code>##   to an &#39;hbgd&#39; variable name.</code></pre>
<pre><code>## All checks passed!</code></pre>
<pre><code>## As a final check, please ensure the units of measurement match</code></pre>
<pre><code>## the variable descriptions (e.g. age in days, height in centimeters, etc.).</code></pre>
</div>
<div id="get-subject-and-time-data" class="section level2">
<h2>Get subject and time data</h2>
<a id="subjecttime_alias"></a>
<h3>
Get subject-level or time-varying variables and rows of longitudinal data
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>get_subject_data(dat)</div>
<div>get_time_data(dat)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
data frame with longitudinal data
</dd>
</dl>
</div>
<div id="fix_height" class="section level2">
<h2>fix_height</h2>
<a id="fix_height_alias"></a>
<h3>
Merge ‘htcm’ and ‘lencm’ into the ‘htcm’ variable
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>fix_height(dat)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
data
</dd>
</dl>
</div>
<div id="add_holdout_ind" class="section level2">
<h2>add_holdout_ind</h2>
<a id="add_holdout_ind_alias"></a>
<h3>
Add indicator column for per-subject holdout
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>add_holdout_ind(dat, random&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
data
</dd>
<dt>
random
</dt>
<dd class="rd-dd">
if TRUE, a random observation per subject will be designated as the holdout, if FALSE, the endpoint for each subject will be designated as the holdout
</dd>
</dl>
</div>
<div id="view_variables" class="section level2">
<h2>view_variables</h2>
<a id="view_variables_alias"></a>
<h3>
View known hbgd variables
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>view_variables()</div></code></pre>
</div>
<div id="get_data_attributes" class="section level2">
<h2>get_data_attributes</h2>
<a id="get_data_attributes_alias"></a>
<h3>
Infer and attach attributes to a longitudinal growth study dataset
</h3>
<p class="rd-p">
Infer attributes such as variable types of a longitudinal growth study and add as attributes to the dataset.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>get_data_attributes(dat, meta&nbsp;=&nbsp;NULL, study_meta&nbsp;=&nbsp;NULL)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
a longitudinal growth study dataset
</dd>
<dt>
meta
</dt>
<dd class="rd-dd">
a data frame of meta data about the variables (a row for each variable)
</dd>
<dt>
study_meta
</dt>
<dd class="rd-dd">
a single-row data frame or named list of meta data about the study (such as study description, etc.)
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
attributes added: - <code>subjectlevel_vars</code>: vector of names of subject-level variables - <code>timevarying_vars</code>: vector of names of time-varying variables - <code>time_vars</code>: vector of names of measures of age - <code>var_summ</code>: data frame containing variable summaries with columns <code>variable</code>, <code>label</code>, <code>type</code>[subject id, time indicator, time-varying, constant], <code>n_unique</code> - <code>subj_count</code>: data frame of counts of records for each subject with columns <code>subjid</code>, <code>n</code> - <code>n_subj</code>: scalar containing total number of subjects - <code>labels</code> named list of variable labels - either populated by matching names with a pre-set list of labels (see <code><a href=#hbgd_labels>hbgd_labels</a></code>) or from a list provided from the <code>meta</code> argument - <code>study_meta</code>: data frame of meta data (if provided from the <code>study_meta</code> argument) - <code>short_id</code>: scalar containing the short unique identifier for the study (if <code>study_meta</code> is provided)
</p>
<h4>
Examples
</h4>
<pre class="r"><code>cpp &lt;- get_data_attributes(cpp)
str(attributes(cpp))</code></pre>
<pre><code>## List of 4
##  $ names    : chr [1:37] &quot;subjid&quot; &quot;agedays&quot; &quot;wtkg&quot; &quot;htcm&quot; ...
##  $ row.names: int [1:1912] 1 2 3 4 5 6 7 8 9 10 ...
##  $ hbgd     :List of 8
##   ..$ labels           :List of 37
##   .. ..$ subjid  : chr &quot;Subject ID&quot;
##   .. ..$ agedays : chr &quot;Age since birth at examination (days)&quot;
##   .. ..$ wtkg    : chr &quot;Weight (kg)&quot;
##   .. ..$ htcm    : chr &quot;Standing height (cm)&quot;
##   .. ..$ lencm   : chr &quot;Recumbent length (cm)&quot;
##   .. ..$ bmi     : chr &quot;BMI (kg/m**2)&quot;
##   .. ..$ waz     : chr &quot;Weight for age z-score&quot;
##   .. ..$ haz     : chr &quot;Length/height for age z-score&quot;
##   .. ..$ whz     : chr &quot;Weight for length/height z-score&quot;
##   .. ..$ baz     : chr &quot;BMI for age z-score&quot;
##   .. ..$ siteid  : chr &quot;Investigational Site ID&quot;
##   .. ..$ sexn    : chr &quot;Sex (numeric)&quot;
##   .. ..$ sex     : chr &quot;Sex&quot;
##   .. ..$ feedingn: chr &quot;Feeding practice (numeric)&quot;
##   .. ..$ feeding : chr &quot;Feeding practice&quot;
##   .. ..$ gagebrth: chr &quot;Gestational age at birth (days)&quot;
##   .. ..$ birthwt : chr &quot;Birth weight (gm)&quot;
##   .. ..$ birthlen: chr &quot;Birth length (cm)&quot;
##   .. ..$ apgar1  : chr &quot;APGAR Score 1 min after birth&quot;
##   .. ..$ apgar5  : chr &quot;APGAR Score 5 min after birth&quot;
##   .. ..$ mage    : chr &quot;Maternal age at birth of child (yrs)&quot;
##   .. ..$ mracen  : chr &quot;Maternal race (num)&quot;
##   .. ..$ mrace   : chr &quot;Maternal race&quot;
##   .. ..$ mmaritn : chr &quot;Mothers marital status (num)&quot;
##   .. ..$ mmarit  : chr &quot;Mothers marital status&quot;
##   .. ..$ meducyrs: chr &quot;Mother, years of education&quot;
##   .. ..$ sesn    : chr &quot;Socioeconomic status of parent (num)&quot;
##   .. ..$ ses     : chr &quot;Socioeconomic status of parent&quot;
##   .. ..$ parity  : chr &quot;Maternal parity&quot;
##   .. ..$ gravida : chr &quot;Maternal num pregnancies&quot;
##   .. ..$ smoked  : chr &quot;Mom smoked during pregnancy?&quot;
##   .. ..$ mcignum : chr &quot;Num cigarettes mom smoked per day&quot;
##   .. ..$ preeclmp: chr &quot;Preeclampsia&quot;
##   .. ..$ comprisk: chr &quot;Pregnancy complications/risk factors&quot;
##   .. ..$ geniq   : chr &quot;Intelligence Quotient General Intelligence IQ&quot;
##   .. ..$ sysbp   : chr &quot;Systolic Blood Pressure&quot;
##   .. ..$ diabp   : chr &quot;Diastolic Blood Pressure&quot;
##   ..$ subjectlevel_vars: chr [1:24] &quot;siteid&quot; &quot;sexn&quot; &quot;sex&quot; &quot;feedingn&quot; ...
##   ..$ timevarying_vars : chr [1:11] &quot;wtkg&quot; &quot;htcm&quot; &quot;lencm&quot; &quot;bmi&quot; ...
##   ..$ time_vars        : chr &quot;agedays&quot;
##   ..$ var_summ         :Classes &#39;var_summ&#39; and &#39;data.frame&#39;: 37 obs. of  5 variables:
##   .. ..$ variable: chr [1:37] &quot;subjid&quot; &quot;agedays&quot; &quot;wtkg&quot; &quot;htcm&quot; ...
##   .. ..$ label   : chr [1:37] &quot;Subject ID&quot; &quot;Age since birth at examination (days)&quot; &quot;Weight (kg)&quot; &quot;Standing height (cm)&quot; ...
##   .. ..$ type    : chr [1:37] &quot;subject id&quot; &quot;time indicator&quot; &quot;time-varying&quot; &quot;time-varying&quot; ...
##   .. ..$ vtype   : chr [1:37] &quot;num&quot; &quot;cat&quot; &quot;num&quot; &quot;num&quot; ...
##   .. ..$ n_unique: int [1:37] 500 5 417 81 42 956 527 137 413 392 ...
##   ..$ subj_count       :&#39;data.frame&#39;:    500 obs. of  2 variables:
##   .. ..$ subjid: int [1:500] 1 2 3 4 5 6 7 8 9 10 ...
##   .. ..$ n     : int [1:500] 3 4 1 1 1 1 4 5 5 2 ...
##   ..$ n_subj           : int 500
##   ..$ ad_tab           :Classes &#39;ad_tab&#39; and &#39;data.frame&#39;:   5 obs. of  2 variables:
##   .. ..$ agedays: int [1:5] 1 123 366 1462 2558
##   .. ..$ n      : int [1:5] 500 460 428 137 387
##  $ class    : chr &quot;data.frame&quot;</code></pre>
<h4>
See also
</h4>
<p><code><a href=#get_data_attributes>get_data_attributes</a></code></p>
</div>
</div>
<div id="who-growth-standards" class="section level1">
<h1>WHO Growth Standards</h1>
<div id="generic-centilez-score-to-value" class="section level2">
<h2>generic centile/z-score to value</h2>
<a id="who_centile2value_alias"></a>
<h3>
Convert WHO z-scores/centiles to anthro measurements (generic)
</h3>
<p class="rd-p">
Get values of a specified measurement for a given WHO centile/z-score and growth standard pair (e.g. length vs. age) and sex over a specified grid
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>who_centile2value(x, p&nbsp;=&nbsp;50, x_var&nbsp;=&nbsp;"agedays", y_var&nbsp;=&nbsp;"htcm", sex&nbsp;=&nbsp;"Female", data&nbsp;=&nbsp;NULL)</div>
<div>who_zscore2value(x, z&nbsp;=&nbsp;0, y_var&nbsp;=&nbsp;"htcm", x_var&nbsp;=&nbsp;"agedays", sex&nbsp;=&nbsp;"Female", data&nbsp;=&nbsp;NULL)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
vector specifying the values of x over which to provide the centiles for y
</dd>
<dt>
p
</dt>
<dd class="rd-dd">
centile or vector of centiles at which to compute values (a number between 0 and 100 - 50 is median)
</dd>
<dt>
x_var
</dt>
<dd class="rd-dd">
x variable name (typically “agedays”) - see details
</dd>
<dt>
y_var
</dt>
<dd class="rd-dd">
y variable name (typically “htcm” or “wtkg”) that specifies which variable of values should be returned for the specified value of q - see details
</dd>
<dt>
sex
</dt>
<dd class="rd-dd">
“Male” or “Female”
</dd>
<dt>
data
</dt>
<dd class="rd-dd">
optional data frame that supplies any of the other variables provided to the function
</dd>
<dt>
z
</dt>
<dd class="rd-dd">
z-score or vector of z-scores at which to compute values
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
for all supported pairings of <code>x_var</code> and <code>y_var</code>, type <code>names(who)</code>
</p>
<h4>
Examples
</h4>
<pre class="r"><code># median height vs. age for females
x &lt;- seq(0, 365, by = 7)
med &lt;- who_centile2value(x)
plot(x, med, xlab = &quot;age in days&quot;, ylab = &quot;median female height (cm)&quot;)</code></pre>
<p><img src="rd_files/figure-html/who_centile2value_id_7-1.png" width="624" /></p>
<pre class="r"><code># 99th percentile of weight vs. age for males from age 0 to 1461 days
dat &lt;- data.frame(x = rep(seq(0, 1461, length = 100), 2),
  sex = rep(c(&quot;Male&quot;, &quot;Female&quot;), each = 100))
dat$p99 &lt;- who_centile2value(x, p = 99, y_var = &quot;wtkg&quot;, sex = sex, data = dat)
lattice::xyplot(kg2lb(p99) ~ days2years(x), groups = sex, data = dat,
  ylab = &quot;99th percentile weight (pounds) for males&quot;,
  xlab = &quot;age (years)&quot;, auto.key = TRUE)</code></pre>
<p><img src="rd_files/figure-html/who_centile2value_id_7-2.png" width="624" /></p>
<h4>
See also
</h4>
<p><code><a href=#who_value2zscore>who_value2centile</a></code>, <code><a href=#who_value2zscore>who_value2zscore</a></code></p>
</div>
<div id="generic-value-to-centilez-score" class="section level2">
<h2>generic value to centile/z-score</h2>
<a id="who_value2zscore_alias"></a>
<h3>
Convert anthro measurements to WHO z-scores/centiles (generic)
</h3>
<p class="rd-p">
Compute z-scores or centiles with respect to the WHO growth standard for given values of x vs. y (typically x is “agedays” and y is a measure like “htcm”).
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>who_value2zscore(x, y, x_var&nbsp;=&nbsp;"agedays", y_var&nbsp;=&nbsp;"htcm", sex&nbsp;=&nbsp;"Female", data&nbsp;=&nbsp;NULL)</div>
<div>who_value2centile(x, y, x_var&nbsp;=&nbsp;"agedays", y_var&nbsp;=&nbsp;"htcm", sex&nbsp;=&nbsp;"Female", data&nbsp;=&nbsp;NULL)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
value or vector of values that correspond to a measure defined by <code>x_var</code>
</dd>
<dt>
y
</dt>
<dd class="rd-dd">
value or vector of values that correspond to a measure defined by <code>y_var</code>
</dd>
<dt>
x_var
</dt>
<dd class="rd-dd">
x variable name (typically “agedays”) - see details
</dd>
<dt>
y_var
</dt>
<dd class="rd-dd">
y variable name (typically “htcm” or “wtkg”) - see details
</dd>
<dt>
sex
</dt>
<dd class="rd-dd">
“Male” or “Female”
</dd>
<dt>
data
</dt>
<dd class="rd-dd">
optional data frame that supplies any of the other variables provided to the function
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
for all supported pairings of <code>x_var</code> and <code>y_var</code>, type <code>names(who)</code>
</p>
<h4>
Examples
</h4>
<pre class="r"><code># z-scores
who_value2zscore(1670, in2cm(44))</code></pre>
<pre><code>## [1] 1.117365</code></pre>
<pre class="r"><code>who_value2zscore(1670, lb2kg(48), y_var = &quot;wtkg&quot;)</code></pre>
<pre><code>## [1] 1.527048</code></pre>
<pre class="r"><code>who_value2centile(1670, in2cm(44))</code></pre>
<pre><code>## [1] 86.80809</code></pre>
<pre class="r"><code>who_value2centile(1670, lb2kg(48), y_var = &quot;wtkg&quot;)</code></pre>
<pre><code>## [1] 93.66255</code></pre>
<pre class="r"><code># add haz derived from WHO data and compare to that provided with data
cpp$haz2 &lt;- who_value2zscore(x = agedays,  y = lencm, sex = sex, data = cpp)
plot(cpp$haz, cpp$haz2)</code></pre>
<p><img src="rd_files/figure-html/who_value2zscore_id_8-1.png" width="624" /></p>
<pre class="r"><code># note that you can also do it this way
#&#39; cpp$haz2 &lt;- who_value2zscore(cpp$agedays, cpp$lencm, sex = cpp$sex)</code></pre>
<h4>
See also
</h4>
<p><code><a href=#who_centile2value>who_centile2value</a></code>, <code><a href=#who_centile2value>who_zscore2value</a></code></p>
</div>
<div id="specific-centilez-score-to-value" class="section level2">
<h2>specific centile/z-score to value</h2>
<a id="who_zscore2var_alias"></a>
<h3>
Convert WHO z-scores/centiles to anthro measurements
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>who_zscore2htcm(agedays, z&nbsp;=&nbsp;0, sex&nbsp;=&nbsp;"Female")</div>
<div>who_zscore2wtkg(agedays, z&nbsp;=&nbsp;0, sex&nbsp;=&nbsp;"Female")</div>
<div>who_zscore2bmi(agedays, z&nbsp;=&nbsp;0, sex&nbsp;=&nbsp;"Female")</div>
<div>who_zscore2hcircm(agedays, z&nbsp;=&nbsp;0, sex&nbsp;=&nbsp;"Female")</div>
<div>who_zscore2muaccm(agedays, z&nbsp;=&nbsp;0, sex&nbsp;=&nbsp;"Female")</div>
<div>who_zscore2ssftmm(agedays, z&nbsp;=&nbsp;0, sex&nbsp;=&nbsp;"Female")</div>
<div>who_zscore2tsftmm(agedays, z&nbsp;=&nbsp;0, sex&nbsp;=&nbsp;"Female")</div>
<div>who_centile2htcm(agedays, p&nbsp;=&nbsp;50, sex&nbsp;=&nbsp;"Female")</div>
<div>who_centile2wtkg(agedays, p&nbsp;=&nbsp;50, sex&nbsp;=&nbsp;"Female")</div>
<div>who_centile2bmi(agedays, p&nbsp;=&nbsp;50, sex&nbsp;=&nbsp;"Female")</div>
<div>who_centile2hcircm(agedays, p&nbsp;=&nbsp;50, sex&nbsp;=&nbsp;"Female")</div>
<div>who_centile2muaccm(agedays, p&nbsp;=&nbsp;50, sex&nbsp;=&nbsp;"Female")</div>
<div>who_centile2ssftmm(agedays, p&nbsp;=&nbsp;50, sex&nbsp;=&nbsp;"Female")</div>
<div>who_centile2tsftmm(agedays, p&nbsp;=&nbsp;50, sex&nbsp;=&nbsp;"Female")</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
agedays
</dt>
<dd class="rd-dd">
age in days
</dd>
<dt>
z
</dt>
<dd class="rd-dd">
z-score(s) to convert
</dd>
<dt>
sex
</dt>
<dd class="rd-dd">
“Male” or “Female”
</dd>
<dt>
p
</dt>
<dd class="rd-dd">
centile(s) to convert (must be between 0 and 100)
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>htcm &lt;- who_zscore2htcm(cpp$agedays, cpp$haz, cpp$sex)</code></pre>
</div>
<div id="specific-value-to-centilez-score" class="section level2">
<h2>specific value to centile/z-score</h2>
<a id="who_var2zscore_alias"></a>
<h3>
Convert anthro measurements to WHO z-scores/centiles
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>who_wtkg2zscore(agedays, wtkg, sex&nbsp;=&nbsp;"Female")</div>
<div>who_htcm2zscore(agedays, htcm, sex&nbsp;=&nbsp;"Female")</div>
<div>who_bmi2zscore(agedays, bmi, sex&nbsp;=&nbsp;"Female")</div>
<div>who_hcircm2zscore(agedays, hcircm, sex&nbsp;=&nbsp;"Female")</div>
<div>who_muaccm2zscore(agedays, muaccm, sex&nbsp;=&nbsp;"Female")</div>
<div>who_ssftmm2zscore(agedays, ssftmm, sex&nbsp;=&nbsp;"Female")</div>
<div>who_tsftmm2zscore(agedays, tsftmm, sex&nbsp;=&nbsp;"Female")</div>
<div>who_wtkg2centile(agedays, wtkg, sex&nbsp;=&nbsp;"Female")</div>
<div>who_htcm2centile(agedays, htcm, sex&nbsp;=&nbsp;"Female")</div>
<div>who_bmi2centile(agedays, bmi, sex&nbsp;=&nbsp;"Female")</div>
<div>who_hcircm2centile(agedays, hcircm, sex&nbsp;=&nbsp;"Female")</div>
<div>who_muaccm2centile(agedays, muaccm, sex&nbsp;=&nbsp;"Female")</div>
<div>who_ssftmm2centile(agedays, ssftmm, sex&nbsp;=&nbsp;"Female")</div>
<div>who_tsftmm2centile(agedays, tsftmm, sex&nbsp;=&nbsp;"Female")</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
agedays
</dt>
<dd class="rd-dd">
age in days
</dd>
<dt>
wtkg
</dt>
<dd class="rd-dd">
weight (kg) measurement(s) to convert
</dd>
<dt>
sex
</dt>
<dd class="rd-dd">
“Male” or “Female”
</dd>
<dt>
htcm
</dt>
<dd class="rd-dd">
height(cm) measurement(s) to convert
</dd>
<dt>
bmi
</dt>
<dd class="rd-dd">
body-mass index measurement(s) to convert
</dd>
<dt>
hcircm
</dt>
<dd class="rd-dd">
head circumference (cm) measurement(s) to convert
</dd>
<dt>
muaccm
</dt>
<dd class="rd-dd">
mid-upper arm circumference (cm) measurement(s) to convert
</dd>
<dt>
ssftmm
</dt>
<dd class="rd-dd">
subscalpular skinfold (mm) measurement(s) to convert
</dd>
<dt>
tsftmm
</dt>
<dd class="rd-dd">
triceps skinfold (mm) measurement(s) to convert
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>haz &lt;- who_htcm2zscore(cpp$agedays, cpp$htcm, cpp$sex)</code></pre>
</div>
</div>
<div id="intergrowth-birth-standards" class="section level1">
<h1>Intergrowth Birth Standards</h1>
<div id="generic-centilez-score-to-value-1" class="section level2">
<h2>generic centile/z-score to value</h2>
<a id="igb_zscore2value_alias"></a>
<h3>
Convert birth measurements to INTERGROWTH z-scores/centiles (generic)
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>igb_centile2value(gagebrth, p&nbsp;=&nbsp;50, var&nbsp;=&nbsp;"lencm", sex&nbsp;=&nbsp;"Female")</div>
<div>igb_zscore2value(gagebrth, z&nbsp;=&nbsp;0, var&nbsp;=&nbsp;"lencm", sex&nbsp;=&nbsp;"Female")</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
gagebrth
</dt>
<dd class="rd-dd">
gestational age at birth in days
</dd>
<dt>
p
</dt>
<dd class="rd-dd">
centile(s) to convert (must be between 0 and 100)
</dd>
<dt>
var
</dt>
<dd class="rd-dd">
the name of the measurement to convert (“lencm”, “wtkg”, “hcircm”)
</dd>
<dt>
sex
</dt>
<dd class="rd-dd">
“Male” or “Female”
</dd>
<dt>
z
</dt>
<dd class="rd-dd">
z-score(s) to convert
</dd>
</dl>
<h4>
Note
</h4>
<p class="rd-p">
For gestational ages between 24 and 33 weeks, the INTERGROWTH very early preterm standard is used.
</p>
<h4>
References
</h4>
<p class="rd-p">
International standards for newborn weight, length, and head circumference by gestational age and sex: the Newborn Cross-Sectional Study of the INTERGROWTH-21st Project Villar, José et al. The Lancet, Volume 384, Issue 9946, 857-868
</p>
<p class="rd-p">
INTERGROWTH-21st very preterm size at birth reference charts. Lancet 2016 doi.org/10.1016/S0140-6736(16) 00384-6. Villar, José et al.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># get 99th centile for Male birth weights across some gestational ages
igb_centile2value(232:300, 99, var = &quot;wtkg&quot;, sex = &quot;Male&quot;)</code></pre>
<pre><code>##  [1] 3.095594 3.134276 3.172468 3.210176 3.247402 3.284150 3.320425
##  [8] 3.356229 3.391566 3.426440 3.460857 3.494817 3.528324 3.561383
## [15] 3.593996 3.626168 3.657900 3.689198 3.720065 3.750502 3.780513
## [22] 3.810103 3.839274 3.868027 3.896370 3.924301 3.951826 3.978946
## [29] 4.005666 4.031988 4.057915 4.083450 4.108594 4.133353 4.157728
## [36] 4.181721 4.205336 4.228576 4.251442 4.273939 4.296067 4.317829
## [43] 4.339230 4.360270 4.380952 4.401281 4.421255 4.440879 4.460156
## [50] 4.479087 4.497674 4.515922 4.533831 4.551403 4.568641 4.585547
## [57] 4.602125 4.618375 4.634299 4.649901 4.665183 4.680145 4.694791
## [64] 4.709122 4.723141 4.736849 4.750250 4.763343 4.776132</code></pre>
</div>
<div id="generic-value-to-centilez-score-1" class="section level2">
<h2>generic value to centile/z-score</h2>
<a id="igb_value2zscore_alias"></a>
<h3>
Convert birth measurements to INTERGROWTH z-scores/centiles (generic)
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>igb_value2centile(gagebrth, val, var&nbsp;=&nbsp;"lencm", sex&nbsp;=&nbsp;"Female")</div>
<div>igb_value2zscore(gagebrth, val, var&nbsp;=&nbsp;"lencm", sex&nbsp;=&nbsp;"Female")</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
gagebrth
</dt>
<dd class="rd-dd">
gestational age at birth in days
</dd>
<dt>
val
</dt>
<dd class="rd-dd">
the value(s) of the anthro measurement to convert
</dd>
<dt>
var
</dt>
<dd class="rd-dd">
the name of the measurement to convert (“lencm”, “wtkg”, “hcircm”)
</dd>
<dt>
sex
</dt>
<dd class="rd-dd">
“Male” or “Female”
</dd>
</dl>
<h4>
Note
</h4>
<p class="rd-p">
For gestational ages between 24 and 33 weeks, the INTERGROWTH very early preterm standard is used.
</p>
<h4>
References
</h4>
<p class="rd-p">
International standards for newborn weight, length, and head circumference by gestational age and sex: the Newborn Cross-Sectional Study of the INTERGROWTH-21st Project Villar, José et al. The Lancet, Volume 384, Issue 9946, 857-868
</p>
<p class="rd-p">
INTERGROWTH-21st very preterm size at birth reference charts. Lancet 2016 doi.org/10.1016/S0140-6736(16) 00384-6. Villar, José et al.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># get Male birth length z-scores
# first we need just 1 record per subject with subject-level data
cppsubj &lt;- get_subject_data(cpp)
cppsubj &lt;- subset(cppsubj, sex == &quot;Male&quot;)
igb_value2zscore(cpp$gagebrth, cpp$birthlen, var = &quot;lencm&quot;, sex = &quot;Male&quot;)</code></pre>
<pre><code>##    [1]  2.57008863  2.57008863  2.57008863  0.66769390  0.66769390
##    [6]  0.66769390  0.66769390  2.77551410  0.24012569  1.20761609
##   [11]  0.43007110  1.53920598  1.53920598  1.53920598  1.53920598
##   [16]  1.53920598  1.53920598  1.53920598  1.53920598  1.53920598
##   [21]  2.57008863  2.57008863  2.57008863  2.57008863  2.57008863
##   [26]          NA          NA  1.37080474  1.37080474  1.37080474
##   [31]  2.08629993  2.08629993  2.08167545  2.08167545  2.08167545
##   [36] -0.92887191 -0.92887191 -0.92887191 -0.92887191 -0.17659363
##   [41] -0.17659363 -0.17659363 -0.17659363 -0.17659363  0.43007110
##   [46]  0.43007110  0.43007110  0.43007110  0.04777744  0.04777744
##   [51]  0.04777744  0.04777744 -0.95427104 -0.95427104 -0.95427104
##   [56] -0.95427104 -0.95427104  0.04777744  0.04777744  0.04777744
##   [61]  0.04777744  0.10144540  0.10144540  0.10144540  1.01947447
##   [66]  1.01947447  1.01947447  1.01947447  1.26177582  1.26177582
##   [71]  1.26177582  1.26177582  1.26177582  1.01947447  1.01947447
##   [76]  1.01947447  1.01947447  1.01947447  0.04777744  0.04777744
##   [81]  0.04777744  0.04777744  0.04777744  2.08629993  2.08629993
##   [86]  2.08629993  2.08629993  0.43007110  0.43007110  0.43007110
##   [91]  0.43007110  0.04777744  2.08629993  2.08629993  2.08629993
##   [96]  0.81893628  0.81893628  0.81893628  1.01947447  1.01947447
##  [101]  1.01947447  1.01947447  0.24012569  0.24012569  0.24012569
##  [106]  0.24012569  0.94776774  0.94776774  0.94776774  0.94776774
##  [111]  1.26326658  1.26326658  1.26326658  1.26326658  1.26326658
##  [116]  0.04777744  0.04777744  0.04777744  0.04777744  0.66769390
##  [121]  0.66769390  0.66769390 -0.17659363 -0.17659363 -0.17659363
##  [126] -0.17659363  0.43007110  0.43007110  0.43007110  0.43007110
##  [131]  1.57506493  1.57506493  1.57506493  1.57506493 -0.57693404
##  [136] -0.57693404 -0.57693404 -0.57693404 -1.18192366 -1.18192366
##  [141] -1.18192366 -1.18192366 -1.18192366  0.32057449  0.32057449
##  [146]  0.32057449  0.32057449 -0.32198638 -0.32198638 -0.32198638
##  [151] -0.32198638 -0.32198638          NA          NA          NA
##  [156]  1.01947447  1.01947447  1.01947447 -0.32198638 -0.32198638
##  [161] -0.32198638 -0.32198638  0.32057449  0.32057449  0.32057449
##  [166]  0.43007110  0.43007110  0.43007110  1.84381500  1.84381500
##  [171]  1.84381500  0.24012569  0.24012569  0.24012569  0.24012569
##  [176]  1.88394745  1.88394745  1.88394745  1.88394745  1.88394745
##  [181] -0.95427104 -0.95427104 -0.95427104 -0.95427104 -0.95427104
##  [186] -0.32198638 -0.32198638 -0.32198638 -0.32198638 -0.32198638
##  [191]  1.57506493  1.57506493  1.57506493  1.57506493 -0.57693404
##  [196] -0.57693404 -0.57693404 -0.57693404  0.04777744  0.04777744
##  [201] -1.88881195 -1.88881195 -1.88881195 -1.88881195  0.43007110
##  [206]  0.43007110  0.43007110 -0.57693404 -0.57693404 -0.57693404
##  [211] -0.57693404  0.10144540  0.10144540  0.10144540  2.54912777
##  [216]  2.54912777  2.54912777  2.54912777  1.53920598  1.53920598
##  [221]  1.53920598  1.53920598 -0.01724797 -0.01724797 -0.01724797
##  [226] -0.01724797 -0.17659363 -0.17659363 -0.17659363 -0.17659363
##  [231]  0.04777744  0.04777744  0.04777744  0.04777744  0.04777744
##  [236]  2.31733522  2.31733522  2.31733522  2.31733522  2.31733522
##  [241]  2.31733522  0.32057449  0.32057449  0.32057449  0.32057449
##  [246]  0.32057449  0.32057449  1.53920598  1.53920598  1.53920598
##  [251]  2.54912777  2.54912777  2.54912777  2.54912777 -1.02459617
##  [256] -1.02459617 -1.02459617 -2.82067962  0.63678619  0.63678619
##  [261]  0.63678619  0.63678619  0.66769390  0.66769390  0.66769390
##  [266]  0.66769390  1.37080474  1.37080474  1.37080474  1.37080474
##  [271]  0.24012569  0.24012569  0.24012569  0.24012569  3.15541741
##  [276]  3.15541741  3.15541741  3.15541741  0.32057449  0.32057449
##  [281]  0.32057449  0.32057449 -0.57693404 -0.57693404 -0.57693404
##  [286] -0.57693404  0.24012569  0.24012569  0.24012569  0.24012569
##  [291]  2.31733522  2.31733522  2.31733522  2.31733522  2.08167545
##  [296]  2.08167545  2.08167545  2.08167545  1.53920598  1.53920598
##  [301]  1.53920598  1.53920598  0.66769390  0.66769390  0.66769390
##  [306]  0.66769390  0.66769390  1.81440917  1.81440917  1.81440917
##  [311]  1.81440917  1.57506493  1.57506493  1.57506493  1.57506493
##  [316]  1.26177582  1.26177582  1.26177582  1.26177582  1.26177582
##  [321]  1.26177582  1.26177582  1.81440917  1.81440917  1.81440917
##  [326]  1.81440917  1.81440917  1.26326658  1.26326658  1.26326658
##  [331]  1.26326658          NA          NA          NA          NA
##  [336] -0.32198638 -0.32198638 -0.32198638 -0.32198638  2.35247762
##  [341]  2.35247762  2.35247762  2.35247762  2.35247762  2.35247762
##  [346]  2.35247762  2.35247762  2.35247762  2.08629993  2.08629993
##  [351]  2.08629993  2.08629993  2.76890374  2.76890374  2.76890374
##  [356]  2.76890374  2.08629993  2.08629993  2.08629993  2.08629993
##  [361]  2.31733522  2.31733522  2.31733522  2.31733522  0.32057449
##  [366]  0.32057449  0.32057449  0.32057449  0.04777744 -0.57693404
##  [371] -0.57693404  1.26177582  1.26177582  1.26177582  1.26177582
##  [376] -1.18192366 -1.18192366 -1.18192366 -1.18192366  0.94776774
##  [381]  0.94776774  0.94776774  0.94776774 -0.95427104 -0.95427104
##  [386] -0.95427104 -0.95427104  0.66523053  0.66523053  0.66523053
##  [391]  0.66523053  0.66523053 -0.57693404 -0.57693404 -0.57693404
##  [396] -0.57693404 -0.57693404 -0.17659363 -0.17659363 -0.17659363
##  [401] -0.17659363 -0.34918388 -0.34918388 -0.34918388 -0.34918388
##  [406]  2.31733522  2.31733522  2.31733522 -0.32198638 -0.32198638
##  [411] -0.32198638 -0.32198638  0.04777744  0.04777744  0.04777744
##  [416]  0.04777744  1.81440917  1.81440917  1.81440917  1.81440917
##  [421]  0.94776774  0.94776774  0.94776774  0.94776774  0.43007110
##  [426]  0.43007110  0.43007110  0.43007110  1.53920598  1.53920598
##  [431]  1.53920598  1.53920598  1.53920598          NA          NA
##  [436]          NA          NA -0.57693404 -0.57693404 -0.57693404
##  [441] -0.57693404 -0.77955940 -0.77955940 -0.77955940 -0.77955940
##  [446] -0.77955940  0.24012569  0.24012569  0.24012569  0.24012569
##  [451]  0.94776774  0.94776774  0.94776774  0.94776774  2.57008863
##  [456]  2.57008863  2.57008863  2.57008863  2.57008863  1.01947447
##  [461]  1.01947447  1.01947447  1.84381500  1.84381500  1.84381500
##  [466]  1.57506493  1.57506493  1.57506493  1.57506493 -5.80376219
##  [471] -5.80376219 -5.80376219 -5.80376219  2.76890374  2.76890374
##  [476]  2.76890374  2.76890374  2.76890374 -0.77955940 -0.77955940
##  [481] -0.77955940 -0.77955940  0.94776774  0.94776774  0.94776774
##  [486]  0.94776774  1.53920598  1.53920598  1.53920598  1.53920598
##  [491]  1.53920598  1.53920598  1.53920598  1.53920598  1.53920598
##  [496]  1.53920598 -0.57693404 -0.57693404 -0.57693404 -0.57693404
##  [501]  0.04777744  0.04777744  0.04777744  0.66769390  0.66769390
##  [506]  0.66769390  0.66769390  0.66769390  1.37080474  1.37080474
##  [511]  1.37080474  1.37080474  0.32057449  0.32057449  0.32057449
##  [516]  0.32057449  0.66769390  0.66769390  0.66769390  0.66769390
##  [521]  0.66769390 -1.18192366 -1.18192366 -1.18192366 -1.18192366
##  [526] -5.39174617 -5.39174617 -5.39174617 -5.39174617 -5.39174617
##  [531] -0.32198638 -0.32198638 -0.32198638 -2.10044386 -2.10044386
##  [536] -2.10044386  1.81440917  1.81440917  1.81440917  1.81440917
##  [541]  0.10144540  0.10144540  0.10144540  0.10144540  0.10144540
##  [546]  2.31733522  2.31733522  2.31733522  2.31733522  0.04777744
##  [551]  0.04777744  0.04777744  0.04777744  0.04777744          NA
##  [556]          NA          NA          NA  0.66769390  0.66769390
##  [561]  0.66769390  0.32057449  0.32057449  0.32057449  1.26177582
##  [566]  1.26177582  1.26177582  1.26177582 -0.32198638 -0.32198638
##  [571] -0.32198638 -0.32198638  0.04777744  0.04777744  0.04777744
##  [576]  0.04777744          NA -1.55221271 -1.55221271 -0.57693404
##  [581] -0.57693404 -0.57693404 -0.57693404  0.94776774 -4.28567708
##  [586] -4.28567708 -4.28567708 -4.28567708 -3.21277379 -3.21277379
##  [591] -3.21277379 -3.21277379 -3.21277379 -1.74780621 -1.74780621
##  [596] -1.74780621 -1.74780621 -0.67380818 -0.67380818 -0.67380818
##  [601] -0.67380818  2.31733522  2.31733522  2.31733522  0.04777744
##  [606]  0.04777744  0.04777744  0.04777744 -1.48019642 -1.48019642
##  [611] -1.48019642 -1.48019642  1.26177582  1.26177582  1.26177582
##  [616]  1.26177582 -0.95427104 -0.95427104 -0.95427104  0.32057449
##  [621]  0.32057449  0.32057449  1.81440917  1.81440917  1.81440917
##  [626] -1.74780621 -1.74780621 -1.74780621          NA  0.43007110
##  [631]  0.43007110  0.43007110  0.43007110 -0.77955940 -0.77955940
##  [636] -0.77955940 -0.77955940 -0.77955940  1.20761609  1.20761609
##  [641]  1.20761609  1.20761609  1.20761609 -0.34918388 -0.34918388
##  [646] -0.34918388 -0.34918388  0.81893628  0.81893628  0.81893628
##  [651]  0.81893628  0.81893628  1.20761609  1.20761609  1.20761609
##  [656]  1.20761609  1.20761609  1.26177582  1.26177582  1.26177582
##  [661] -0.77955940 -0.77955940 -0.77955940 -0.77955940  1.01947447
##  [666]  1.01947447  1.01947447  1.01947447  2.08167545  2.08167545
##  [671]  2.08167545  2.08167545  1.84381500  1.84381500  1.84381500
##  [676]  1.84381500  0.94776774  0.94776774  0.94776774  0.94776774
##  [681]  2.76890374  2.76890374  0.04777744  1.81440917  1.81440917
##  [686]  1.81440917  1.81440917  1.81440917  1.53920598  1.53920598
##  [691]  1.53920598  1.53920598 -0.67380818 -0.67380818 -0.67380818
##  [696] -0.67380818  0.04777744  0.04777744  0.04777744  0.94776774
##  [701]  0.94776774  0.94776774  2.35247762  2.35247762  2.35247762
##  [706]  2.35247762 -0.17659363 -0.17659363 -0.17659363 -0.17659363
##  [711]  0.66769390  0.66769390  0.66769390  0.66769390  0.66769390
##  [716]  2.08167545  2.08167545  2.08167545  2.08167545  0.32057449
##  [721]  0.32057449  0.32057449  0.32057449  0.32057449  0.43007110
##  [726]  0.43007110  0.43007110  0.43007110          NA          NA
##  [731]          NA          NA          NA  2.76890374  2.76890374
##  [736]  0.43007110  0.43007110  0.43007110  0.43007110  0.32057449
##  [741]  0.32057449  0.32057449  0.32057449 -0.95427104 -0.95427104
##  [746] -0.95427104 -0.95427104 -1.74780621 -1.74780621 -1.74780621
##  [751] -1.74780621  0.66769390  0.66769390  0.66769390  0.66769390
##  [756]  0.66769390 -1.35698291 -1.35698291 -1.35698291 -1.35698291
##  [761] -1.35698291          NA          NA          NA          NA
##  [766]  2.54912777  2.54912777  2.54912777  2.54912777  2.54912777
##  [771]          NA -1.30459500 -1.30459500 -1.30459500 -1.30459500
##  [776]  2.76890374  2.76890374  2.76890374  2.76890374          NA
##  [781]          NA          NA          NA          NA  0.32057449
##  [786]  0.32057449  0.32057449  0.32057449  0.32057449  1.53920598
##  [791]  1.53920598  1.53920598  1.53920598  1.01947447  1.01947447
##  [796]  1.01947447  1.01947447  1.01947447  2.96436156  2.96436156
##  [801]  2.96436156  2.96436156  2.96436156  2.18498566  2.18498566
##  [806]  2.18498566  0.66769390  0.66769390  0.66769390  0.66769390
##  [811]  3.39217340  3.39217340  3.39217340  3.39217340          NA
##  [816]          NA          NA          NA  3.49617450  3.49617450
##  [821]  3.49617450  3.49617450  3.49617450  1.26177582  1.26177582
##  [826]  1.26177582  1.26177582  3.53071911  3.53071911  3.53071911
##  [831]  3.53071911  3.53071911  1.71653479  1.71653479  1.71653479
##  [836]  1.71653479  1.71653479  0.81893628  0.81893628  0.81893628
##  [841]  0.81893628  0.81893628  3.33560617  3.33560617  3.33560617
##  [846]  3.33560617  3.33560617  2.18498566  2.18498566  2.18498566
##  [851]  2.18498566 -0.95427104 -0.95427104 -0.95427104 -0.95427104
##  [856]  0.04777744  0.04777744  0.04777744  0.04777744  0.04777744
##  [861] -2.10044386 -2.10044386 -2.10044386  0.66769390  0.66769390
##  [866]  0.66769390  0.66769390  2.61075974  2.61075974  2.61075974
##  [871]  2.61075974  2.61075974  0.24012569  0.24012569  0.24012569
##  [876]  0.24012569  0.24012569 -0.17659363 -0.17659363 -0.17659363
##  [881] -0.17659363  0.43007110  0.43007110  0.43007110  0.66769390
##  [886]  0.66769390  0.66769390  0.66769390  0.04777744  0.04777744
##  [891]  0.04777744  1.81440917  1.81440917  1.81440917 -1.18192366
##  [896] -1.18192366 -1.18192366 -1.18192366 -0.17659363 -0.17659363
##  [901] -0.17659363 -0.17659363 -0.17659363  2.35247762  2.35247762
##  [906]  2.35247762  2.35247762          NA          NA          NA
##  [911]          NA          NA -2.59359762 -2.59359762 -2.59359762
##  [916] -2.59359762 -1.30459500 -1.30459500 -1.30459500  1.81440917
##  [921]  1.81440917  1.81440917  1.81440917  1.81440917  0.66769390
##  [926]  0.66769390  0.66769390  0.66769390          NA          NA
##  [931]          NA          NA  2.31733522  2.31733522  2.31733522
##  [936]  2.31733522  1.57506493  1.57506493  1.57506493  1.57506493
##  [941]  1.26177582  1.26177582  1.26177582  1.26177582  1.26177582
##  [946]  2.08629993  2.08629993  2.08629993  0.43007110  0.43007110
##  [951]  0.43007110  0.43007110  0.43007110  0.43007110  0.43007110
##  [956]  0.43007110 -2.26398780 -2.26398780 -2.26398780  0.43007110
##  [961]  0.43007110  0.43007110  0.43007110  0.66769390  0.66769390
##  [966]  0.66769390  0.66769390  0.66769390  1.57506493  1.57506493
##  [971]  1.57506493  1.57506493  1.57506493  1.26177582  1.26177582
##  [976]  1.26177582  1.26177582  1.26177582  0.32057449  0.32057449
##  [981]  0.32057449  0.66769390  0.66769390  0.66769390  0.66769390
##  [986]  0.66769390          NA          NA  1.26177582  1.26177582
##  [991]  1.26177582  1.26177582  1.26177582  1.53920598  1.53920598
##  [996]  1.53920598  1.53920598  0.04777744  0.04777744  0.04777744
## [1001]  0.04777744  0.04777744  0.04777744  0.04777744  0.04777744
## [1006]  0.04777744  0.63678619  0.63678619  0.63678619  0.63678619
## [1011] -0.77955940 -0.77955940 -0.77955940 -0.77955940 -0.77955940
## [1016]  0.43007110  0.43007110  0.43007110  0.43007110  1.26177582
## [1021] -0.17659363 -0.17659363 -0.17659363 -0.17659363  1.01947447
## [1026]  1.01947447  1.01947447  0.04777744  0.04777744  0.04777744
## [1031]  0.04777744  0.04777744  0.66769390  0.66769390  0.66769390
## [1036]  0.66769390  0.32057449  0.32057449  0.32057449  0.32057449
## [1041]  0.32057449 -0.32198638 -0.32198638 -0.32198638 -0.32198638
## [1046] -0.32198638 -1.18192366 -1.18192366 -1.18192366 -1.18192366
## [1051]  1.37080474  1.37080474  1.37080474  0.81893628  0.81893628
## [1056]  0.81893628  0.81893628 -0.17659363  2.76890374 -0.32198638
## [1061] -0.32198638 -0.32198638 -0.32198638 -2.26398780 -2.26398780
## [1066] -2.26398780  1.37080474  1.37080474  1.37080474  1.37080474
## [1071] -1.55209653 -1.55209653 -1.55209653 -1.55209653 -1.55209653
## [1076]  1.01947447  1.01947447  1.01947447  1.01947447  0.32057449
## [1081]  0.32057449  0.32057449 -0.34918388  1.01947447  1.01947447
## [1086]  1.01947447  1.01947447  1.81440917  1.81440917  0.94776774
## [1091]  1.20761609  0.43007110  0.43007110  0.43007110  0.43007110
## [1096]  0.94776774  0.94776774  0.94776774  0.66769390  0.66769390
## [1101]  0.66769390  0.66769390  0.66769390  2.08629993  2.08629993
## [1106]  2.08629993 -0.57693404 -0.57693404 -0.57693404 -0.57693404
## [1111] -0.92887191 -0.92887191 -0.92887191  1.37080474  1.37080474
## [1116]  1.37080474  1.37080474  2.96436156  2.96436156  2.96436156
## [1121]  2.96436156  2.96436156  2.57008863  2.57008863  2.57008863
## [1126]  2.57008863  1.81440917  1.81440917  1.81440917  1.81440917
## [1131]  1.81440917  0.04777744  0.04777744  0.04777744  0.04777744
## [1136] -2.72758934 -2.72758934 -2.72758934 -2.72758934  2.08167545
## [1141]  2.08167545  0.94776774  0.94776774  0.94776774  0.94776774
## [1146]  1.81440917  1.81440917  1.81440917  1.57506493  1.57506493
## [1151] -0.95427104 -0.95427104 -0.95427104 -0.95427104 -1.35698291
## [1156] -1.35698291 -1.35698291 -1.35698291 -1.55209653 -1.55209653
## [1161] -1.55209653 -1.55209653 -1.55209653 -1.55209653 -1.55209653
## [1166] -1.55209653 -1.55209653  0.04777744  0.04777744  0.04777744
## [1171]  0.04777744  0.04777744  0.81893628  0.81893628  0.81893628
## [1176]  0.81893628  0.81893628  0.66769390  0.66769390  0.66769390
## [1181]  0.66769390  1.81440917  1.81440917  1.81440917  1.81440917
## [1186]  1.81440917  1.88394745  1.88394745  1.88394745  1.88394745
## [1191]  1.71653479  1.71653479  1.71653479  1.71653479  0.66769390
## [1196]  0.66769390  0.66769390 -0.32198638  1.57506493  1.57506493
## [1201]  1.57506493  1.57506493  2.76890374  0.66769390  0.66769390
## [1206] -0.34918388 -0.34918388 -0.34918388 -0.34918388 -0.34918388
## [1211] -0.34918388 -0.34918388 -0.34918388          NA          NA
## [1216]          NA          NA -0.77955940 -0.77955940 -0.77955940
## [1221] -0.77955940  0.32057449  0.24012569  0.24012569  0.24012569
## [1226]  0.24012569  1.37080474  1.37080474  1.37080474  1.26177582
## [1231]  1.26177582  1.26177582  2.76890374  2.76890374  2.76890374
## [1236]  2.76890374  0.04777744  0.04777744  0.04777744  0.04777744
## [1241]  1.57506493  1.57506493  1.57506493  1.57506493  1.57506493
## [1246] -0.77955940 -0.77955940 -0.77955940 -0.77955940  0.43007110
## [1251]  0.43007110  0.43007110  0.43007110  0.43007110  2.57008863
## [1256]  2.57008863  2.57008863  2.57008863  2.57008863 -0.77955940
## [1261] -0.77955940 -0.77955940 -0.77955940 -0.77955940  0.43007110
## [1266]  0.43007110  0.43007110  0.43007110  0.32057449  0.32057449
## [1271]  1.26177582  1.26177582 -0.17659363 -0.17659363 -0.17659363
## [1276] -1.35698291 -1.35698291 -1.35698291 -1.35698291  0.94776774
## [1281]  0.94776774  0.94776774  0.94776774          NA          NA
## [1286]          NA          NA          NA          NA          NA
## [1291]          NA          NA  1.01947447  1.01947447  1.01947447
## [1296]  1.01947447 -0.17659363 -0.17659363 -0.17659363 -0.92887191
## [1301] -0.92887191 -0.92887191 -0.92887191 -0.92887191  1.01947447
## [1306]  1.01947447  1.01947447  1.01947447  1.37080474  1.37080474
## [1311]  1.37080474  1.37080474  1.37080474 -0.95427104 -0.95427104
## [1316] -0.95427104 -0.95427104  0.66769390  0.66769390  0.66769390
## [1321]  0.66769390  0.66769390 -0.32198638 -0.32198638 -0.32198638
## [1326] -0.32198638  2.08629993  2.08629993  2.08629993  1.26177582
## [1331]  2.08167545  2.08167545  2.08167545  2.08167545 -1.48019642
## [1336] -1.48019642 -1.48019642 -1.30459500 -1.30459500 -1.30459500
## [1341] -1.30459500  2.57008863  2.57008863  2.57008863  2.57008863
## [1346]  2.57008863  1.81440917  1.81440917  1.81440917  1.81440917
## [1351] -0.01724797 -0.01724797 -0.01724797  0.66769390  0.66769390
## [1356]  0.66769390  0.66769390  1.26177582  1.26177582  1.26177582
## [1361]  1.26177582  1.01947447  1.01947447  1.01947447  1.01947447
## [1366]  1.01947447  2.08629993  2.08629993  2.08629993  2.08629993
## [1371] -0.17659363 -0.17659363 -0.17659363 -0.17659363 -0.17659363
## [1376] -0.17659363 -0.17659363 -0.17659363 -0.17659363 -0.67380818
## [1381] -0.67380818 -0.67380818 -0.67380818 -1.18192366 -1.18192366
## [1386] -1.18192366 -1.18192366  0.66769390  0.66769390  0.66769390
## [1391]  0.66769390  3.85113993  3.85113993  3.85113993  3.85113993
## [1396]  3.85113993 -2.38186551 -2.38186551 -2.38186551 -2.38186551
## [1401] -1.48019642 -1.48019642 -1.48019642 -1.48019642 -1.48019642
## [1406]  0.66769390  1.20761609  1.20761609  1.20761609  1.20761609
## [1411] -0.17659363 -0.17659363 -0.17659363 -0.17659363 -0.77955940
## [1416] -0.77955940 -0.77955940 -0.77955940  2.57008863  2.57008863
## [1421]  2.57008863  2.57008863  2.35247762  2.35247762  2.35247762
## [1426]  2.35247762  2.35247762 -2.59359762 -2.59359762 -2.59359762
## [1431] -0.57693404 -0.57693404 -0.57693404 -0.57693404 -0.57693404
## [1436]  2.57008863  2.57008863  2.57008863  2.57008863 -0.17659363
## [1441] -0.17659363 -0.17659363 -0.17659363 -0.17659363  2.08167545
## [1446]  2.08167545  2.08167545  2.36901940  2.36901940  2.36901940
## [1451]  2.36901940  1.88394745  1.88394745  1.88394745  1.88394745
## [1456]  2.96436156  2.96436156  2.96436156  2.96436156  2.96436156
## [1461]  2.31733522  2.31733522  2.31733522  1.81440917  1.81440917
## [1466]  1.81440917  1.84381500  1.84381500  1.84381500  1.84381500
## [1471]  1.26177582  1.26177582  1.26177582  1.26177582  1.57506493
## [1476]  1.57506493  1.57506493  1.57506493 -0.67380818 -0.67380818
## [1481] -0.67380818 -0.67380818  0.66523053  0.66523053  0.66523053
## [1486]  0.66523053  0.66523053 -0.32198638 -0.32198638 -0.32198638
## [1491] -2.10044386 -2.10044386 -2.10044386 -2.10044386 -0.77955940
## [1496] -0.77955940 -0.77955940 -0.77955940 -0.77955940          NA
## [1501]          NA          NA          NA  1.26177582  1.26177582
## [1506]  1.26177582  2.08629993  2.08629993  2.08629993  2.08629993
## [1511]          NA          NA          NA          NA -1.18192366
## [1516] -1.18192366 -1.18192366 -1.18192366  3.00545515  3.00545515
## [1521]  3.00545515  3.00545515  3.00545515  1.88394745  1.88394745
## [1526]  1.88394745  1.88394745  1.37080474  1.37080474  1.37080474
## [1531]  1.37080474  1.37080474  1.01947447  1.01947447  1.01947447
## [1536] -0.34918388 -0.34918388 -0.34918388 -0.34918388 -0.34918388
## [1541]  1.53920598  1.53920598  1.53920598  1.53920598  2.54912777
## [1546]  2.54912777  2.54912777  2.54912777  0.32057449  0.32057449
## [1551]  0.32057449  0.32057449          NA          NA          NA
## [1556]          NA  0.43007110  0.43007110  0.43007110  0.43007110
## [1561] -0.17659363 -0.17659363 -0.17659363 -0.17659363 -0.17659363
## [1566] -0.32198638 -0.32198638 -0.32198638 -0.32198638 -0.32198638
## [1571]  1.81440917  1.81440917  1.81440917  1.81440917  1.81440917
## [1576] -0.57693404 -0.57693404 -0.57693404 -0.57693404  0.66769390
## [1581]  0.66769390  0.66769390  0.66769390  4.04258904  4.04258904
## [1586]  4.04258904  4.04258904  4.04258904 -1.55209653 -1.55209653
## [1591] -1.55209653 -1.55209653  2.77551410  2.77551410  2.77551410
## [1596]  0.66769390  0.66769390  0.66769390  0.66769390 -0.67380818
## [1601] -0.67380818 -0.67380818 -0.67380818 -0.67380818  1.01947447
## [1606]  1.01947447  1.01947447  1.01947447  1.01947447  2.31733522
## [1611]  2.31733522  2.31733522  2.31733522  2.76890374  2.76890374
## [1616]  2.76890374  2.76890374  2.76890374  1.37080474  1.37080474
## [1621]  1.37080474  0.63678619  0.63678619  0.63678619  0.63678619
## [1626]  0.63678619  1.88394745  1.88394745  1.88394745 -1.18192366
## [1631] -1.18192366 -1.18192366  1.01947447  1.01947447  0.43007110
## [1636]  0.43007110  0.43007110  0.66769390  0.66769390  1.53920598
## [1641]  1.53920598  1.53920598  1.53920598  1.57506493  1.57506493
## [1646]  1.57506493  1.57506493  1.57506493  0.66769390  0.66769390
## [1651]  0.66769390  1.37080474  1.37080474  1.37080474  1.37080474
## [1656] -0.92887191 -0.92887191 -0.92887191 -0.92887191 -0.92887191
## [1661] -0.57693404 -0.57693404 -0.57693404 -0.57693404  2.08167545
## [1666]  2.08167545  2.08167545  2.08167545  0.43007110  0.43007110
## [1671]  0.43007110  0.43007110 -1.18192366 -1.18192366 -1.18192366
## [1676] -1.18192366  1.84381500  1.84381500  1.84381500  1.84381500
## [1681]  1.37080474  1.57506493  1.57506493  1.57506493  0.43007110
## [1686]  0.43007110  1.26177582  1.26177582  1.26177582  1.26177582
## [1691] -0.17659363 -0.17659363 -0.17659363 -0.17659363 -0.92887191
## [1696] -0.92887191 -0.92887191 -0.92887191  1.88394745  1.88394745
## [1701]  1.88394745  0.04777744  0.04777744  0.04777744  0.04777744
## [1706]          NA          NA          NA -0.17659363 -0.17659363
## [1711] -0.17659363 -0.01724797 -0.01724797  0.43007110  0.43007110
## [1716]  0.43007110  0.43007110  1.20761609  1.20761609  1.20761609
## [1721]  1.20761609  1.20761609 -1.30459500 -1.30459500 -1.30459500
## [1726] -1.30459500 -1.30459500  1.53920598  1.53920598  1.53920598
## [1731] -0.17659363 -0.17659363 -0.17659363 -0.17659363 -0.17659363
## [1736]  0.66769390  0.66769390  0.66769390  0.66769390  0.66769390
## [1741] -0.01724797 -0.01724797 -0.01724797 -0.01724797 -0.32198638
## [1746] -0.32198638 -0.32198638 -0.32198638  0.32057449  0.32057449
## [1751]  0.32057449  0.32057449  0.32057449          NA -2.87419725
## [1756] -2.87419725 -2.87419725 -0.77955940 -0.77955940 -0.77955940
## [1761] -0.77955940  0.24012569  0.24012569  0.24012569  0.24012569
## [1766] -0.32198638 -0.32198638 -0.32198638 -0.32198638 -0.32198638
## [1771]  0.32057449  0.32057449  0.32057449  0.32057449 -0.77955940
## [1776] -0.77955940 -0.77955940 -0.77955940 -0.77955940  3.39217340
## [1781]  3.39217340  3.39217340  3.39217340  3.39217340  3.33560617
## [1786]  3.33560617  3.33560617  3.33560617  3.33560617  3.17177418
## [1791]  3.17177418  3.17177418  3.17177418 -1.35698291 -1.35698291
## [1796] -1.35698291 -1.35698291  0.04777744  0.04777744  0.04777744
## [1801]  0.04777744  0.04777744  1.37080474  1.37080474  1.37080474
## [1806]  1.37080474  0.43007110  0.43007110  0.43007110  0.43007110
## [1811]  2.54912777  2.54912777  2.54912777  2.54912777  2.54912777
## [1816]  2.54912777  2.54912777  2.54912777  2.54912777  2.54912777
## [1821]  0.94776774  0.94776774  0.94776774  0.94776774  2.36901940
## [1826]  2.36901940  2.36901940  2.36901940 -0.95427104 -0.95427104
## [1831] -0.95427104 -0.95427104  0.63678619  0.63678619  0.63678619
## [1836]  0.63678619  0.63678619  2.57008863  2.57008863  2.57008863
## [1841]  2.57008863  2.57008863  0.63678619  0.63678619  0.63678619
## [1846]  0.63678619  0.63678619  1.57506493  1.57506493  1.57506493
## [1851]  1.57506493  0.94776774  0.94776774  0.94776774  0.94776774
## [1856]  0.04777744  0.04777744  0.04777744 -0.57693404 -0.57693404
## [1861] -0.57693404 -0.57693404 -0.17659363 -0.17659363 -0.17659363
## [1866] -0.17659363 -1.18192366 -1.18192366 -1.18192366 -1.18192366
## [1871] -1.35698291 -1.35698291 -1.35698291 -1.35698291  0.63678619
## [1876]  0.63678619  0.63678619  0.63678619  0.94776774  0.94776774
## [1881]  0.94776774  0.94776774  0.94776774 -2.10044386 -2.10044386
## [1886] -2.10044386 -2.10044386  0.04777744  0.04777744  1.26177582
## [1891]  1.26177582  1.26177582  1.26177582  1.01947447  1.01947447
## [1896]  1.01947447  1.53920598  1.53920598  1.53920598  1.53920598
## [1901]  1.81440917  1.81440917  1.81440917  1.81440917  1.81440917
## [1906]  0.94776774  0.94776774  0.94776774  0.94776774 -2.59359762
## [1911] -2.59359762 -2.59359762</code></pre>
</div>
<div id="specific-centilez-score-to-value-1" class="section level2">
<h2>specific centile/z-score to value</h2>
<a id="igb_zscore2var_alias"></a>
<h3>
Convert INTERGROWTH z-scores/centiles to birth measurements
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>igb_zscore2lencm(gagebrth, z&nbsp;=&nbsp;0, sex&nbsp;=&nbsp;"Female")</div>
<div>igb_zscore2wtkg(gagebrth, z&nbsp;=&nbsp;0, sex&nbsp;=&nbsp;"Female")</div>
<div>igb_zscore2hcircm(gagebrth, z&nbsp;=&nbsp;0, sex&nbsp;=&nbsp;"Female")</div>
<div>igb_centile2lencm(gagebrth, p&nbsp;=&nbsp;50, sex&nbsp;=&nbsp;"Female")</div>
<div>igb_centile2wtkg(gagebrth, p&nbsp;=&nbsp;50, sex&nbsp;=&nbsp;"Female")</div>
<div>igb_centile2hcircm(gagebrth, p&nbsp;=&nbsp;50, sex&nbsp;=&nbsp;"Female")</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
gagebrth
</dt>
<dd class="rd-dd">
gestational age at birth in days
</dd>
<dt>
z
</dt>
<dd class="rd-dd">
z-score(s) to convert
</dd>
<dt>
sex
</dt>
<dd class="rd-dd">
“Male” or “Female”
</dd>
<dt>
p
</dt>
<dd class="rd-dd">
centile(s) to convert (must be between 0 and 100)
</dd>
</dl>
<h4>
Note
</h4>
<p class="rd-p">
For gestational ages between 24 and 33 weeks, the INTERGROWTH very early preterm standard is used.
</p>
<h4>
References
</h4>
<p class="rd-p">
International standards for newborn weight, length, and head circumference by gestational age and sex: the Newborn Cross-Sectional Study of the INTERGROWTH-21st Project Villar, José et al. The Lancet, Volume 384, Issue 9946, 857-868
</p>
<p class="rd-p">
INTERGROWTH-21st very preterm size at birth reference charts. Lancet 2016 doi.org/10.1016/S0140-6736(16) 00384-6. Villar, José et al.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># get 99th centile for Male birth weights across some gestational ages
igb_centile2wtkg(168:300, 99, sex = &quot;Male&quot;)</code></pre>
<pre><code>##   [1] 0.9991985 1.0186739 1.0384696 1.0585902 1.0790402 1.0998242 1.1209468
##   [8] 1.1424126 1.1642266 1.1863934 1.2089179 1.2318051 1.2550599 1.2786874
##  [15] 1.3026927 1.3270809 1.3518573 1.3770272 1.4025958 1.4285686 1.4549511
##  [22] 1.4817488 1.5089673 1.5366123 1.5646895 1.5932047 1.6221637 1.6515726
##  [29] 1.6814372 1.7117637 1.7425582 1.7738270 1.8055762 1.8378124 1.8705418
##  [36] 1.9037710 1.9375065 1.9717551 2.0065234 2.0418183 2.0776467 2.1140154
##  [43] 2.1509315 2.1884022 2.2264347 2.2650362 2.3042141 2.3439758 2.3843289
##  [50] 2.4252810 2.4668398 2.5090130 2.5518086 2.5952345 2.6392988 2.6840095
##  [57] 2.7293750 2.7754036 2.8221036 2.8694835 2.9175521 2.9663179 3.0157898
##  [64] 3.0564180 3.0955936 3.1342758 3.1724682 3.2101759 3.2474019 3.2841504
##  [71] 3.3204248 3.3562286 3.3915659 3.4264403 3.4608566 3.4948170 3.5283240
##  [78] 3.5613826 3.5939964 3.6261678 3.6579000 3.6891984 3.7200645 3.7505016
##  [85] 3.7805132 3.8101031 3.8392735 3.8680271 3.8963698 3.9243013 3.9518260
##  [92] 3.9789462 4.0056661 4.0319877 4.0579147 4.0834500 4.1085945 4.1333530
##  [99] 4.1577278 4.1817214 4.2053359 4.2285764 4.2514424 4.2739387 4.2960668
## [106] 4.3178294 4.3392300 4.3602701 4.3809523 4.4012807 4.4212552 4.4408793
## [113] 4.4601555 4.4790866 4.4976743 4.5159215 4.5338306 4.5514030 4.5686409
## [120] 4.5855474 4.6021249 4.6183750 4.6342991 4.6499014 4.6651828 4.6801452
## [127] 4.6947905 4.7091219 4.7231409 4.7368487 4.7502495 4.7633430 4.7761319</code></pre>
<pre class="r"><code># recreate figure from preterm paper
d &lt;- expand.grid(centile = c(3, 50, 97), gage = 168:300)
d$value &lt;- igb_centile2lencm(d$gage, d$centile, sex = &quot;Male&quot;)
lattice::xyplot(value ~ gage / 7, groups = centile, data = d, type = &quot;l&quot;)</code></pre>
<p><img src="rd_files/figure-html/igb_zscore2var_id_13-1.png" width="624" /></p>
</div>
<div id="specific-value-to-centilez-score-1" class="section level2">
<h2>specific value to centile/z-score</h2>
<a id="igb_var2zscore_alias"></a>
<h3>
Convert birth measurements to INTERGROWTH z-scores/centiles
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>igb_lencm2zscore(gagebrth, lencm, sex&nbsp;=&nbsp;"Female")</div>
<div>igb_wtkg2zscore(gagebrth, wtkg, sex&nbsp;=&nbsp;"Female")</div>
<div>igb_hcircm2zscore(gagebrth, hcircm, sex&nbsp;=&nbsp;"Female")</div>
<div>igb_lencm2centile(gagebrth, lencm, sex&nbsp;=&nbsp;"Female")</div>
<div>igb_wtkg2centile(gagebrth, wtkg, sex&nbsp;=&nbsp;"Female")</div>
<div>igb_hcircm2centile(gagebrth, hcircm, sex&nbsp;=&nbsp;"Female")</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
gagebrth
</dt>
<dd class="rd-dd">
gestational age at birth in days
</dd>
<dt>
lencm
</dt>
<dd class="rd-dd">
length(cm) measurement(s) to convert
</dd>
<dt>
sex
</dt>
<dd class="rd-dd">
“Male” or “Female”
</dd>
<dt>
wtkg
</dt>
<dd class="rd-dd">
weight (kg) measurement(s) to convert
</dd>
<dt>
hcircm
</dt>
<dd class="rd-dd">
head circumference (cm) measurement(s) to convert
</dd>
</dl>
<h4>
Note
</h4>
<p class="rd-p">
For gestational ages between 24 and 33 weeks, the INTERGROWTH very early preterm standard is used.
</p>
<h4>
References
</h4>
<p class="rd-p">
International standards for newborn weight, length, and head circumference by gestational age and sex: the Newborn Cross-Sectional Study of the INTERGROWTH-21st Project Villar, José et al. The Lancet, Volume 384, Issue 9946, 857-868
</p>
<p class="rd-p">
INTERGROWTH-21st very preterm size at birth reference charts. Lancet 2016 doi.org/10.1016/S0140-6736(16) 00384-6. Villar, José et al.
</p>
<h4>
Examples
</h4>
<pre class="r"><code># get Male birth length z-scores
# first we need just 1 record per subject with subject-level data
cppsubj &lt;- get_subject_data(cpp)
cppsubj &lt;- subset(cppsubj, sex == &quot;Male&quot;)
igb_lencm2zscore(cpp$gagebrth, cpp$birthlen, sex = &quot;Male&quot;)</code></pre>
<pre><code>##    [1]  2.57008863  2.57008863  2.57008863  0.66769390  0.66769390
##    [6]  0.66769390  0.66769390  2.77551410  0.24012569  1.20761609
##   [11]  0.43007110  1.53920598  1.53920598  1.53920598  1.53920598
##   [16]  1.53920598  1.53920598  1.53920598  1.53920598  1.53920598
##   [21]  2.57008863  2.57008863  2.57008863  2.57008863  2.57008863
##   [26]          NA          NA  1.37080474  1.37080474  1.37080474
##   [31]  2.08629993  2.08629993  2.08167545  2.08167545  2.08167545
##   [36] -0.92887191 -0.92887191 -0.92887191 -0.92887191 -0.17659363
##   [41] -0.17659363 -0.17659363 -0.17659363 -0.17659363  0.43007110
##   [46]  0.43007110  0.43007110  0.43007110  0.04777744  0.04777744
##   [51]  0.04777744  0.04777744 -0.95427104 -0.95427104 -0.95427104
##   [56] -0.95427104 -0.95427104  0.04777744  0.04777744  0.04777744
##   [61]  0.04777744  0.10144540  0.10144540  0.10144540  1.01947447
##   [66]  1.01947447  1.01947447  1.01947447  1.26177582  1.26177582
##   [71]  1.26177582  1.26177582  1.26177582  1.01947447  1.01947447
##   [76]  1.01947447  1.01947447  1.01947447  0.04777744  0.04777744
##   [81]  0.04777744  0.04777744  0.04777744  2.08629993  2.08629993
##   [86]  2.08629993  2.08629993  0.43007110  0.43007110  0.43007110
##   [91]  0.43007110  0.04777744  2.08629993  2.08629993  2.08629993
##   [96]  0.81893628  0.81893628  0.81893628  1.01947447  1.01947447
##  [101]  1.01947447  1.01947447  0.24012569  0.24012569  0.24012569
##  [106]  0.24012569  0.94776774  0.94776774  0.94776774  0.94776774
##  [111]  1.26326658  1.26326658  1.26326658  1.26326658  1.26326658
##  [116]  0.04777744  0.04777744  0.04777744  0.04777744  0.66769390
##  [121]  0.66769390  0.66769390 -0.17659363 -0.17659363 -0.17659363
##  [126] -0.17659363  0.43007110  0.43007110  0.43007110  0.43007110
##  [131]  1.57506493  1.57506493  1.57506493  1.57506493 -0.57693404
##  [136] -0.57693404 -0.57693404 -0.57693404 -1.18192366 -1.18192366
##  [141] -1.18192366 -1.18192366 -1.18192366  0.32057449  0.32057449
##  [146]  0.32057449  0.32057449 -0.32198638 -0.32198638 -0.32198638
##  [151] -0.32198638 -0.32198638          NA          NA          NA
##  [156]  1.01947447  1.01947447  1.01947447 -0.32198638 -0.32198638
##  [161] -0.32198638 -0.32198638  0.32057449  0.32057449  0.32057449
##  [166]  0.43007110  0.43007110  0.43007110  1.84381500  1.84381500
##  [171]  1.84381500  0.24012569  0.24012569  0.24012569  0.24012569
##  [176]  1.88394745  1.88394745  1.88394745  1.88394745  1.88394745
##  [181] -0.95427104 -0.95427104 -0.95427104 -0.95427104 -0.95427104
##  [186] -0.32198638 -0.32198638 -0.32198638 -0.32198638 -0.32198638
##  [191]  1.57506493  1.57506493  1.57506493  1.57506493 -0.57693404
##  [196] -0.57693404 -0.57693404 -0.57693404  0.04777744  0.04777744
##  [201] -1.88881195 -1.88881195 -1.88881195 -1.88881195  0.43007110
##  [206]  0.43007110  0.43007110 -0.57693404 -0.57693404 -0.57693404
##  [211] -0.57693404  0.10144540  0.10144540  0.10144540  2.54912777
##  [216]  2.54912777  2.54912777  2.54912777  1.53920598  1.53920598
##  [221]  1.53920598  1.53920598 -0.01724797 -0.01724797 -0.01724797
##  [226] -0.01724797 -0.17659363 -0.17659363 -0.17659363 -0.17659363
##  [231]  0.04777744  0.04777744  0.04777744  0.04777744  0.04777744
##  [236]  2.31733522  2.31733522  2.31733522  2.31733522  2.31733522
##  [241]  2.31733522  0.32057449  0.32057449  0.32057449  0.32057449
##  [246]  0.32057449  0.32057449  1.53920598  1.53920598  1.53920598
##  [251]  2.54912777  2.54912777  2.54912777  2.54912777 -1.02459617
##  [256] -1.02459617 -1.02459617 -2.82067962  0.63678619  0.63678619
##  [261]  0.63678619  0.63678619  0.66769390  0.66769390  0.66769390
##  [266]  0.66769390  1.37080474  1.37080474  1.37080474  1.37080474
##  [271]  0.24012569  0.24012569  0.24012569  0.24012569  3.15541741
##  [276]  3.15541741  3.15541741  3.15541741  0.32057449  0.32057449
##  [281]  0.32057449  0.32057449 -0.57693404 -0.57693404 -0.57693404
##  [286] -0.57693404  0.24012569  0.24012569  0.24012569  0.24012569
##  [291]  2.31733522  2.31733522  2.31733522  2.31733522  2.08167545
##  [296]  2.08167545  2.08167545  2.08167545  1.53920598  1.53920598
##  [301]  1.53920598  1.53920598  0.66769390  0.66769390  0.66769390
##  [306]  0.66769390  0.66769390  1.81440917  1.81440917  1.81440917
##  [311]  1.81440917  1.57506493  1.57506493  1.57506493  1.57506493
##  [316]  1.26177582  1.26177582  1.26177582  1.26177582  1.26177582
##  [321]  1.26177582  1.26177582  1.81440917  1.81440917  1.81440917
##  [326]  1.81440917  1.81440917  1.26326658  1.26326658  1.26326658
##  [331]  1.26326658          NA          NA          NA          NA
##  [336] -0.32198638 -0.32198638 -0.32198638 -0.32198638  2.35247762
##  [341]  2.35247762  2.35247762  2.35247762  2.35247762  2.35247762
##  [346]  2.35247762  2.35247762  2.35247762  2.08629993  2.08629993
##  [351]  2.08629993  2.08629993  2.76890374  2.76890374  2.76890374
##  [356]  2.76890374  2.08629993  2.08629993  2.08629993  2.08629993
##  [361]  2.31733522  2.31733522  2.31733522  2.31733522  0.32057449
##  [366]  0.32057449  0.32057449  0.32057449  0.04777744 -0.57693404
##  [371] -0.57693404  1.26177582  1.26177582  1.26177582  1.26177582
##  [376] -1.18192366 -1.18192366 -1.18192366 -1.18192366  0.94776774
##  [381]  0.94776774  0.94776774  0.94776774 -0.95427104 -0.95427104
##  [386] -0.95427104 -0.95427104  0.66523053  0.66523053  0.66523053
##  [391]  0.66523053  0.66523053 -0.57693404 -0.57693404 -0.57693404
##  [396] -0.57693404 -0.57693404 -0.17659363 -0.17659363 -0.17659363
##  [401] -0.17659363 -0.34918388 -0.34918388 -0.34918388 -0.34918388
##  [406]  2.31733522  2.31733522  2.31733522 -0.32198638 -0.32198638
##  [411] -0.32198638 -0.32198638  0.04777744  0.04777744  0.04777744
##  [416]  0.04777744  1.81440917  1.81440917  1.81440917  1.81440917
##  [421]  0.94776774  0.94776774  0.94776774  0.94776774  0.43007110
##  [426]  0.43007110  0.43007110  0.43007110  1.53920598  1.53920598
##  [431]  1.53920598  1.53920598  1.53920598          NA          NA
##  [436]          NA          NA -0.57693404 -0.57693404 -0.57693404
##  [441] -0.57693404 -0.77955940 -0.77955940 -0.77955940 -0.77955940
##  [446] -0.77955940  0.24012569  0.24012569  0.24012569  0.24012569
##  [451]  0.94776774  0.94776774  0.94776774  0.94776774  2.57008863
##  [456]  2.57008863  2.57008863  2.57008863  2.57008863  1.01947447
##  [461]  1.01947447  1.01947447  1.84381500  1.84381500  1.84381500
##  [466]  1.57506493  1.57506493  1.57506493  1.57506493 -5.80376219
##  [471] -5.80376219 -5.80376219 -5.80376219  2.76890374  2.76890374
##  [476]  2.76890374  2.76890374  2.76890374 -0.77955940 -0.77955940
##  [481] -0.77955940 -0.77955940  0.94776774  0.94776774  0.94776774
##  [486]  0.94776774  1.53920598  1.53920598  1.53920598  1.53920598
##  [491]  1.53920598  1.53920598  1.53920598  1.53920598  1.53920598
##  [496]  1.53920598 -0.57693404 -0.57693404 -0.57693404 -0.57693404
##  [501]  0.04777744  0.04777744  0.04777744  0.66769390  0.66769390
##  [506]  0.66769390  0.66769390  0.66769390  1.37080474  1.37080474
##  [511]  1.37080474  1.37080474  0.32057449  0.32057449  0.32057449
##  [516]  0.32057449  0.66769390  0.66769390  0.66769390  0.66769390
##  [521]  0.66769390 -1.18192366 -1.18192366 -1.18192366 -1.18192366
##  [526] -5.39174617 -5.39174617 -5.39174617 -5.39174617 -5.39174617
##  [531] -0.32198638 -0.32198638 -0.32198638 -2.10044386 -2.10044386
##  [536] -2.10044386  1.81440917  1.81440917  1.81440917  1.81440917
##  [541]  0.10144540  0.10144540  0.10144540  0.10144540  0.10144540
##  [546]  2.31733522  2.31733522  2.31733522  2.31733522  0.04777744
##  [551]  0.04777744  0.04777744  0.04777744  0.04777744          NA
##  [556]          NA          NA          NA  0.66769390  0.66769390
##  [561]  0.66769390  0.32057449  0.32057449  0.32057449  1.26177582
##  [566]  1.26177582  1.26177582  1.26177582 -0.32198638 -0.32198638
##  [571] -0.32198638 -0.32198638  0.04777744  0.04777744  0.04777744
##  [576]  0.04777744          NA -1.55221271 -1.55221271 -0.57693404
##  [581] -0.57693404 -0.57693404 -0.57693404  0.94776774 -4.28567708
##  [586] -4.28567708 -4.28567708 -4.28567708 -3.21277379 -3.21277379
##  [591] -3.21277379 -3.21277379 -3.21277379 -1.74780621 -1.74780621
##  [596] -1.74780621 -1.74780621 -0.67380818 -0.67380818 -0.67380818
##  [601] -0.67380818  2.31733522  2.31733522  2.31733522  0.04777744
##  [606]  0.04777744  0.04777744  0.04777744 -1.48019642 -1.48019642
##  [611] -1.48019642 -1.48019642  1.26177582  1.26177582  1.26177582
##  [616]  1.26177582 -0.95427104 -0.95427104 -0.95427104  0.32057449
##  [621]  0.32057449  0.32057449  1.81440917  1.81440917  1.81440917
##  [626] -1.74780621 -1.74780621 -1.74780621          NA  0.43007110
##  [631]  0.43007110  0.43007110  0.43007110 -0.77955940 -0.77955940
##  [636] -0.77955940 -0.77955940 -0.77955940  1.20761609  1.20761609
##  [641]  1.20761609  1.20761609  1.20761609 -0.34918388 -0.34918388
##  [646] -0.34918388 -0.34918388  0.81893628  0.81893628  0.81893628
##  [651]  0.81893628  0.81893628  1.20761609  1.20761609  1.20761609
##  [656]  1.20761609  1.20761609  1.26177582  1.26177582  1.26177582
##  [661] -0.77955940 -0.77955940 -0.77955940 -0.77955940  1.01947447
##  [666]  1.01947447  1.01947447  1.01947447  2.08167545  2.08167545
##  [671]  2.08167545  2.08167545  1.84381500  1.84381500  1.84381500
##  [676]  1.84381500  0.94776774  0.94776774  0.94776774  0.94776774
##  [681]  2.76890374  2.76890374  0.04777744  1.81440917  1.81440917
##  [686]  1.81440917  1.81440917  1.81440917  1.53920598  1.53920598
##  [691]  1.53920598  1.53920598 -0.67380818 -0.67380818 -0.67380818
##  [696] -0.67380818  0.04777744  0.04777744  0.04777744  0.94776774
##  [701]  0.94776774  0.94776774  2.35247762  2.35247762  2.35247762
##  [706]  2.35247762 -0.17659363 -0.17659363 -0.17659363 -0.17659363
##  [711]  0.66769390  0.66769390  0.66769390  0.66769390  0.66769390
##  [716]  2.08167545  2.08167545  2.08167545  2.08167545  0.32057449
##  [721]  0.32057449  0.32057449  0.32057449  0.32057449  0.43007110
##  [726]  0.43007110  0.43007110  0.43007110          NA          NA
##  [731]          NA          NA          NA  2.76890374  2.76890374
##  [736]  0.43007110  0.43007110  0.43007110  0.43007110  0.32057449
##  [741]  0.32057449  0.32057449  0.32057449 -0.95427104 -0.95427104
##  [746] -0.95427104 -0.95427104 -1.74780621 -1.74780621 -1.74780621
##  [751] -1.74780621  0.66769390  0.66769390  0.66769390  0.66769390
##  [756]  0.66769390 -1.35698291 -1.35698291 -1.35698291 -1.35698291
##  [761] -1.35698291          NA          NA          NA          NA
##  [766]  2.54912777  2.54912777  2.54912777  2.54912777  2.54912777
##  [771]          NA -1.30459500 -1.30459500 -1.30459500 -1.30459500
##  [776]  2.76890374  2.76890374  2.76890374  2.76890374          NA
##  [781]          NA          NA          NA          NA  0.32057449
##  [786]  0.32057449  0.32057449  0.32057449  0.32057449  1.53920598
##  [791]  1.53920598  1.53920598  1.53920598  1.01947447  1.01947447
##  [796]  1.01947447  1.01947447  1.01947447  2.96436156  2.96436156
##  [801]  2.96436156  2.96436156  2.96436156  2.18498566  2.18498566
##  [806]  2.18498566  0.66769390  0.66769390  0.66769390  0.66769390
##  [811]  3.39217340  3.39217340  3.39217340  3.39217340          NA
##  [816]          NA          NA          NA  3.49617450  3.49617450
##  [821]  3.49617450  3.49617450  3.49617450  1.26177582  1.26177582
##  [826]  1.26177582  1.26177582  3.53071911  3.53071911  3.53071911
##  [831]  3.53071911  3.53071911  1.71653479  1.71653479  1.71653479
##  [836]  1.71653479  1.71653479  0.81893628  0.81893628  0.81893628
##  [841]  0.81893628  0.81893628  3.33560617  3.33560617  3.33560617
##  [846]  3.33560617  3.33560617  2.18498566  2.18498566  2.18498566
##  [851]  2.18498566 -0.95427104 -0.95427104 -0.95427104 -0.95427104
##  [856]  0.04777744  0.04777744  0.04777744  0.04777744  0.04777744
##  [861] -2.10044386 -2.10044386 -2.10044386  0.66769390  0.66769390
##  [866]  0.66769390  0.66769390  2.61075974  2.61075974  2.61075974
##  [871]  2.61075974  2.61075974  0.24012569  0.24012569  0.24012569
##  [876]  0.24012569  0.24012569 -0.17659363 -0.17659363 -0.17659363
##  [881] -0.17659363  0.43007110  0.43007110  0.43007110  0.66769390
##  [886]  0.66769390  0.66769390  0.66769390  0.04777744  0.04777744
##  [891]  0.04777744  1.81440917  1.81440917  1.81440917 -1.18192366
##  [896] -1.18192366 -1.18192366 -1.18192366 -0.17659363 -0.17659363
##  [901] -0.17659363 -0.17659363 -0.17659363  2.35247762  2.35247762
##  [906]  2.35247762  2.35247762          NA          NA          NA
##  [911]          NA          NA -2.59359762 -2.59359762 -2.59359762
##  [916] -2.59359762 -1.30459500 -1.30459500 -1.30459500  1.81440917
##  [921]  1.81440917  1.81440917  1.81440917  1.81440917  0.66769390
##  [926]  0.66769390  0.66769390  0.66769390          NA          NA
##  [931]          NA          NA  2.31733522  2.31733522  2.31733522
##  [936]  2.31733522  1.57506493  1.57506493  1.57506493  1.57506493
##  [941]  1.26177582  1.26177582  1.26177582  1.26177582  1.26177582
##  [946]  2.08629993  2.08629993  2.08629993  0.43007110  0.43007110
##  [951]  0.43007110  0.43007110  0.43007110  0.43007110  0.43007110
##  [956]  0.43007110 -2.26398780 -2.26398780 -2.26398780  0.43007110
##  [961]  0.43007110  0.43007110  0.43007110  0.66769390  0.66769390
##  [966]  0.66769390  0.66769390  0.66769390  1.57506493  1.57506493
##  [971]  1.57506493  1.57506493  1.57506493  1.26177582  1.26177582
##  [976]  1.26177582  1.26177582  1.26177582  0.32057449  0.32057449
##  [981]  0.32057449  0.66769390  0.66769390  0.66769390  0.66769390
##  [986]  0.66769390          NA          NA  1.26177582  1.26177582
##  [991]  1.26177582  1.26177582  1.26177582  1.53920598  1.53920598
##  [996]  1.53920598  1.53920598  0.04777744  0.04777744  0.04777744
## [1001]  0.04777744  0.04777744  0.04777744  0.04777744  0.04777744
## [1006]  0.04777744  0.63678619  0.63678619  0.63678619  0.63678619
## [1011] -0.77955940 -0.77955940 -0.77955940 -0.77955940 -0.77955940
## [1016]  0.43007110  0.43007110  0.43007110  0.43007110  1.26177582
## [1021] -0.17659363 -0.17659363 -0.17659363 -0.17659363  1.01947447
## [1026]  1.01947447  1.01947447  0.04777744  0.04777744  0.04777744
## [1031]  0.04777744  0.04777744  0.66769390  0.66769390  0.66769390
## [1036]  0.66769390  0.32057449  0.32057449  0.32057449  0.32057449
## [1041]  0.32057449 -0.32198638 -0.32198638 -0.32198638 -0.32198638
## [1046] -0.32198638 -1.18192366 -1.18192366 -1.18192366 -1.18192366
## [1051]  1.37080474  1.37080474  1.37080474  0.81893628  0.81893628
## [1056]  0.81893628  0.81893628 -0.17659363  2.76890374 -0.32198638
## [1061] -0.32198638 -0.32198638 -0.32198638 -2.26398780 -2.26398780
## [1066] -2.26398780  1.37080474  1.37080474  1.37080474  1.37080474
## [1071] -1.55209653 -1.55209653 -1.55209653 -1.55209653 -1.55209653
## [1076]  1.01947447  1.01947447  1.01947447  1.01947447  0.32057449
## [1081]  0.32057449  0.32057449 -0.34918388  1.01947447  1.01947447
## [1086]  1.01947447  1.01947447  1.81440917  1.81440917  0.94776774
## [1091]  1.20761609  0.43007110  0.43007110  0.43007110  0.43007110
## [1096]  0.94776774  0.94776774  0.94776774  0.66769390  0.66769390
## [1101]  0.66769390  0.66769390  0.66769390  2.08629993  2.08629993
## [1106]  2.08629993 -0.57693404 -0.57693404 -0.57693404 -0.57693404
## [1111] -0.92887191 -0.92887191 -0.92887191  1.37080474  1.37080474
## [1116]  1.37080474  1.37080474  2.96436156  2.96436156  2.96436156
## [1121]  2.96436156  2.96436156  2.57008863  2.57008863  2.57008863
## [1126]  2.57008863  1.81440917  1.81440917  1.81440917  1.81440917
## [1131]  1.81440917  0.04777744  0.04777744  0.04777744  0.04777744
## [1136] -2.72758934 -2.72758934 -2.72758934 -2.72758934  2.08167545
## [1141]  2.08167545  0.94776774  0.94776774  0.94776774  0.94776774
## [1146]  1.81440917  1.81440917  1.81440917  1.57506493  1.57506493
## [1151] -0.95427104 -0.95427104 -0.95427104 -0.95427104 -1.35698291
## [1156] -1.35698291 -1.35698291 -1.35698291 -1.55209653 -1.55209653
## [1161] -1.55209653 -1.55209653 -1.55209653 -1.55209653 -1.55209653
## [1166] -1.55209653 -1.55209653  0.04777744  0.04777744  0.04777744
## [1171]  0.04777744  0.04777744  0.81893628  0.81893628  0.81893628
## [1176]  0.81893628  0.81893628  0.66769390  0.66769390  0.66769390
## [1181]  0.66769390  1.81440917  1.81440917  1.81440917  1.81440917
## [1186]  1.81440917  1.88394745  1.88394745  1.88394745  1.88394745
## [1191]  1.71653479  1.71653479  1.71653479  1.71653479  0.66769390
## [1196]  0.66769390  0.66769390 -0.32198638  1.57506493  1.57506493
## [1201]  1.57506493  1.57506493  2.76890374  0.66769390  0.66769390
## [1206] -0.34918388 -0.34918388 -0.34918388 -0.34918388 -0.34918388
## [1211] -0.34918388 -0.34918388 -0.34918388          NA          NA
## [1216]          NA          NA -0.77955940 -0.77955940 -0.77955940
## [1221] -0.77955940  0.32057449  0.24012569  0.24012569  0.24012569
## [1226]  0.24012569  1.37080474  1.37080474  1.37080474  1.26177582
## [1231]  1.26177582  1.26177582  2.76890374  2.76890374  2.76890374
## [1236]  2.76890374  0.04777744  0.04777744  0.04777744  0.04777744
## [1241]  1.57506493  1.57506493  1.57506493  1.57506493  1.57506493
## [1246] -0.77955940 -0.77955940 -0.77955940 -0.77955940  0.43007110
## [1251]  0.43007110  0.43007110  0.43007110  0.43007110  2.57008863
## [1256]  2.57008863  2.57008863  2.57008863  2.57008863 -0.77955940
## [1261] -0.77955940 -0.77955940 -0.77955940 -0.77955940  0.43007110
## [1266]  0.43007110  0.43007110  0.43007110  0.32057449  0.32057449
## [1271]  1.26177582  1.26177582 -0.17659363 -0.17659363 -0.17659363
## [1276] -1.35698291 -1.35698291 -1.35698291 -1.35698291  0.94776774
## [1281]  0.94776774  0.94776774  0.94776774          NA          NA
## [1286]          NA          NA          NA          NA          NA
## [1291]          NA          NA  1.01947447  1.01947447  1.01947447
## [1296]  1.01947447 -0.17659363 -0.17659363 -0.17659363 -0.92887191
## [1301] -0.92887191 -0.92887191 -0.92887191 -0.92887191  1.01947447
## [1306]  1.01947447  1.01947447  1.01947447  1.37080474  1.37080474
## [1311]  1.37080474  1.37080474  1.37080474 -0.95427104 -0.95427104
## [1316] -0.95427104 -0.95427104  0.66769390  0.66769390  0.66769390
## [1321]  0.66769390  0.66769390 -0.32198638 -0.32198638 -0.32198638
## [1326] -0.32198638  2.08629993  2.08629993  2.08629993  1.26177582
## [1331]  2.08167545  2.08167545  2.08167545  2.08167545 -1.48019642
## [1336] -1.48019642 -1.48019642 -1.30459500 -1.30459500 -1.30459500
## [1341] -1.30459500  2.57008863  2.57008863  2.57008863  2.57008863
## [1346]  2.57008863  1.81440917  1.81440917  1.81440917  1.81440917
## [1351] -0.01724797 -0.01724797 -0.01724797  0.66769390  0.66769390
## [1356]  0.66769390  0.66769390  1.26177582  1.26177582  1.26177582
## [1361]  1.26177582  1.01947447  1.01947447  1.01947447  1.01947447
## [1366]  1.01947447  2.08629993  2.08629993  2.08629993  2.08629993
## [1371] -0.17659363 -0.17659363 -0.17659363 -0.17659363 -0.17659363
## [1376] -0.17659363 -0.17659363 -0.17659363 -0.17659363 -0.67380818
## [1381] -0.67380818 -0.67380818 -0.67380818 -1.18192366 -1.18192366
## [1386] -1.18192366 -1.18192366  0.66769390  0.66769390  0.66769390
## [1391]  0.66769390  3.85113993  3.85113993  3.85113993  3.85113993
## [1396]  3.85113993 -2.38186551 -2.38186551 -2.38186551 -2.38186551
## [1401] -1.48019642 -1.48019642 -1.48019642 -1.48019642 -1.48019642
## [1406]  0.66769390  1.20761609  1.20761609  1.20761609  1.20761609
## [1411] -0.17659363 -0.17659363 -0.17659363 -0.17659363 -0.77955940
## [1416] -0.77955940 -0.77955940 -0.77955940  2.57008863  2.57008863
## [1421]  2.57008863  2.57008863  2.35247762  2.35247762  2.35247762
## [1426]  2.35247762  2.35247762 -2.59359762 -2.59359762 -2.59359762
## [1431] -0.57693404 -0.57693404 -0.57693404 -0.57693404 -0.57693404
## [1436]  2.57008863  2.57008863  2.57008863  2.57008863 -0.17659363
## [1441] -0.17659363 -0.17659363 -0.17659363 -0.17659363  2.08167545
## [1446]  2.08167545  2.08167545  2.36901940  2.36901940  2.36901940
## [1451]  2.36901940  1.88394745  1.88394745  1.88394745  1.88394745
## [1456]  2.96436156  2.96436156  2.96436156  2.96436156  2.96436156
## [1461]  2.31733522  2.31733522  2.31733522  1.81440917  1.81440917
## [1466]  1.81440917  1.84381500  1.84381500  1.84381500  1.84381500
## [1471]  1.26177582  1.26177582  1.26177582  1.26177582  1.57506493
## [1476]  1.57506493  1.57506493  1.57506493 -0.67380818 -0.67380818
## [1481] -0.67380818 -0.67380818  0.66523053  0.66523053  0.66523053
## [1486]  0.66523053  0.66523053 -0.32198638 -0.32198638 -0.32198638
## [1491] -2.10044386 -2.10044386 -2.10044386 -2.10044386 -0.77955940
## [1496] -0.77955940 -0.77955940 -0.77955940 -0.77955940          NA
## [1501]          NA          NA          NA  1.26177582  1.26177582
## [1506]  1.26177582  2.08629993  2.08629993  2.08629993  2.08629993
## [1511]          NA          NA          NA          NA -1.18192366
## [1516] -1.18192366 -1.18192366 -1.18192366  3.00545515  3.00545515
## [1521]  3.00545515  3.00545515  3.00545515  1.88394745  1.88394745
## [1526]  1.88394745  1.88394745  1.37080474  1.37080474  1.37080474
## [1531]  1.37080474  1.37080474  1.01947447  1.01947447  1.01947447
## [1536] -0.34918388 -0.34918388 -0.34918388 -0.34918388 -0.34918388
## [1541]  1.53920598  1.53920598  1.53920598  1.53920598  2.54912777
## [1546]  2.54912777  2.54912777  2.54912777  0.32057449  0.32057449
## [1551]  0.32057449  0.32057449          NA          NA          NA
## [1556]          NA  0.43007110  0.43007110  0.43007110  0.43007110
## [1561] -0.17659363 -0.17659363 -0.17659363 -0.17659363 -0.17659363
## [1566] -0.32198638 -0.32198638 -0.32198638 -0.32198638 -0.32198638
## [1571]  1.81440917  1.81440917  1.81440917  1.81440917  1.81440917
## [1576] -0.57693404 -0.57693404 -0.57693404 -0.57693404  0.66769390
## [1581]  0.66769390  0.66769390  0.66769390  4.04258904  4.04258904
## [1586]  4.04258904  4.04258904  4.04258904 -1.55209653 -1.55209653
## [1591] -1.55209653 -1.55209653  2.77551410  2.77551410  2.77551410
## [1596]  0.66769390  0.66769390  0.66769390  0.66769390 -0.67380818
## [1601] -0.67380818 -0.67380818 -0.67380818 -0.67380818  1.01947447
## [1606]  1.01947447  1.01947447  1.01947447  1.01947447  2.31733522
## [1611]  2.31733522  2.31733522  2.31733522  2.76890374  2.76890374
## [1616]  2.76890374  2.76890374  2.76890374  1.37080474  1.37080474
## [1621]  1.37080474  0.63678619  0.63678619  0.63678619  0.63678619
## [1626]  0.63678619  1.88394745  1.88394745  1.88394745 -1.18192366
## [1631] -1.18192366 -1.18192366  1.01947447  1.01947447  0.43007110
## [1636]  0.43007110  0.43007110  0.66769390  0.66769390  1.53920598
## [1641]  1.53920598  1.53920598  1.53920598  1.57506493  1.57506493
## [1646]  1.57506493  1.57506493  1.57506493  0.66769390  0.66769390
## [1651]  0.66769390  1.37080474  1.37080474  1.37080474  1.37080474
## [1656] -0.92887191 -0.92887191 -0.92887191 -0.92887191 -0.92887191
## [1661] -0.57693404 -0.57693404 -0.57693404 -0.57693404  2.08167545
## [1666]  2.08167545  2.08167545  2.08167545  0.43007110  0.43007110
## [1671]  0.43007110  0.43007110 -1.18192366 -1.18192366 -1.18192366
## [1676] -1.18192366  1.84381500  1.84381500  1.84381500  1.84381500
## [1681]  1.37080474  1.57506493  1.57506493  1.57506493  0.43007110
## [1686]  0.43007110  1.26177582  1.26177582  1.26177582  1.26177582
## [1691] -0.17659363 -0.17659363 -0.17659363 -0.17659363 -0.92887191
## [1696] -0.92887191 -0.92887191 -0.92887191  1.88394745  1.88394745
## [1701]  1.88394745  0.04777744  0.04777744  0.04777744  0.04777744
## [1706]          NA          NA          NA -0.17659363 -0.17659363
## [1711] -0.17659363 -0.01724797 -0.01724797  0.43007110  0.43007110
## [1716]  0.43007110  0.43007110  1.20761609  1.20761609  1.20761609
## [1721]  1.20761609  1.20761609 -1.30459500 -1.30459500 -1.30459500
## [1726] -1.30459500 -1.30459500  1.53920598  1.53920598  1.53920598
## [1731] -0.17659363 -0.17659363 -0.17659363 -0.17659363 -0.17659363
## [1736]  0.66769390  0.66769390  0.66769390  0.66769390  0.66769390
## [1741] -0.01724797 -0.01724797 -0.01724797 -0.01724797 -0.32198638
## [1746] -0.32198638 -0.32198638 -0.32198638  0.32057449  0.32057449
## [1751]  0.32057449  0.32057449  0.32057449          NA -2.87419725
## [1756] -2.87419725 -2.87419725 -0.77955940 -0.77955940 -0.77955940
## [1761] -0.77955940  0.24012569  0.24012569  0.24012569  0.24012569
## [1766] -0.32198638 -0.32198638 -0.32198638 -0.32198638 -0.32198638
## [1771]  0.32057449  0.32057449  0.32057449  0.32057449 -0.77955940
## [1776] -0.77955940 -0.77955940 -0.77955940 -0.77955940  3.39217340
## [1781]  3.39217340  3.39217340  3.39217340  3.39217340  3.33560617
## [1786]  3.33560617  3.33560617  3.33560617  3.33560617  3.17177418
## [1791]  3.17177418  3.17177418  3.17177418 -1.35698291 -1.35698291
## [1796] -1.35698291 -1.35698291  0.04777744  0.04777744  0.04777744
## [1801]  0.04777744  0.04777744  1.37080474  1.37080474  1.37080474
## [1806]  1.37080474  0.43007110  0.43007110  0.43007110  0.43007110
## [1811]  2.54912777  2.54912777  2.54912777  2.54912777  2.54912777
## [1816]  2.54912777  2.54912777  2.54912777  2.54912777  2.54912777
## [1821]  0.94776774  0.94776774  0.94776774  0.94776774  2.36901940
## [1826]  2.36901940  2.36901940  2.36901940 -0.95427104 -0.95427104
## [1831] -0.95427104 -0.95427104  0.63678619  0.63678619  0.63678619
## [1836]  0.63678619  0.63678619  2.57008863  2.57008863  2.57008863
## [1841]  2.57008863  2.57008863  0.63678619  0.63678619  0.63678619
## [1846]  0.63678619  0.63678619  1.57506493  1.57506493  1.57506493
## [1851]  1.57506493  0.94776774  0.94776774  0.94776774  0.94776774
## [1856]  0.04777744  0.04777744  0.04777744 -0.57693404 -0.57693404
## [1861] -0.57693404 -0.57693404 -0.17659363 -0.17659363 -0.17659363
## [1866] -0.17659363 -1.18192366 -1.18192366 -1.18192366 -1.18192366
## [1871] -1.35698291 -1.35698291 -1.35698291 -1.35698291  0.63678619
## [1876]  0.63678619  0.63678619  0.63678619  0.94776774  0.94776774
## [1881]  0.94776774  0.94776774  0.94776774 -2.10044386 -2.10044386
## [1886] -2.10044386 -2.10044386  0.04777744  0.04777744  1.26177582
## [1891]  1.26177582  1.26177582  1.26177582  1.01947447  1.01947447
## [1896]  1.01947447  1.53920598  1.53920598  1.53920598  1.53920598
## [1901]  1.81440917  1.81440917  1.81440917  1.81440917  1.81440917
## [1906]  0.94776774  0.94776774  0.94776774  0.94776774 -2.59359762
## [1911] -2.59359762 -2.59359762</code></pre>
</div>
</div>
<div id="intergrowth-fetal-standards" class="section level1">
<h1>Intergrowth Fetal Standards</h1>
<div id="generic-centilez-score-to-value-2" class="section level2">
<h2>generic centile/z-score to value</h2>
<a id="igfet_zscore2value_alias"></a>
<h3>
Convert INTERGROWTH z-scores/centiles to fetal ultrasound measurements (generic)
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>igfet_zscore2value(gagedays, z&nbsp;=&nbsp;0, var&nbsp;=&nbsp;c("hccm", "bpdcm", "ofdcm", "accm", "flcm"))</div>
<div>igfet_centile2value(gagedays, p&nbsp;=&nbsp;50, var&nbsp;=&nbsp;c("hccm", "bpdcm", "ofdcm", "accm", "flcm"))</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
gagedays
</dt>
<dd class="rd-dd">
gestational age in days
</dd>
<dt>
z
</dt>
<dd class="rd-dd">
z-score(s) to convert
</dd>
<dt>
var
</dt>
<dd class="rd-dd">
the name of the measurement to convert (“hccm”, “bpdcm”, “ofdcm”, “accm”, “flcm”)
</dd>
<dt>
p
</dt>
<dd class="rd-dd">
centile(s) to convert (must be between 0 and 100)
</dd>
</dl>
<h4>
References
</h4>
<p class="rd-p">
International standards for fetal growth based on serial ultrasound measurements: the Fetal Growth Longitudinal Study of the INTERGROWTH-21st Project Papageorghiou, Aris T et al. The Lancet, Volume 384, Issue 9946, 869-879
</p>
<h4>
Examples
</h4>
<pre class="r"><code># get value for median head circumference for child at 100 gestational days
igfet_centile2value(100, 50, var = &quot;hccm&quot;)</code></pre>
<pre><code>## [1] 10.14404</code></pre>
</div>
<div id="generic-value-to-centilez-score-2" class="section level2">
<h2>generic value to centile/z-score</h2>
<a id="igfet_value2zscore_alias"></a>
<h3>
Convert fetal ultrasound measurements to INTERGROWTH z-scores/centiles (generic)
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>igfet_value2zscore(gagedays, val, var&nbsp;=&nbsp;c("hccm", "bpdcm", "ofdcm", "accm", "flcm"))</div>
<div>igfet_value2centile(gagedays, val, var&nbsp;=&nbsp;c("hccm", "bpdcm", "ofdcm", "accm", "flcm"))</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
gagedays
</dt>
<dd class="rd-dd">
gestational age in days
</dd>
<dt>
val
</dt>
<dd class="rd-dd">
the value(s) of the anthro measurement to convert
</dd>
<dt>
var
</dt>
<dd class="rd-dd">
the name of the measurement to convert (“hccm”, “bpdcm”, “ofdcm”, “accm”, “flcm”)
</dd>
</dl>
<h4>
References
</h4>
<p class="rd-p">
International standards for fetal growth based on serial ultrasound measurements: the Fetal Growth Longitudinal Study of the INTERGROWTH-21st Project Papageorghiou, Aris T et al. The Lancet, Volume 384, Issue 9946, 869-879
</p>
<h4>
Examples
</h4>
<pre class="r"><code># get centile for child at 100 gestational days with 11 cm head circumference
igfet_hccm2centile(100, 11)</code></pre>
<pre><code>## [1] 93.39812</code></pre>
</div>
<div id="specific-centilez-score-to-value-2" class="section level2">
<h2>specific centile/z-score to value</h2>
<a id="igfet_zscore2var_alias"></a>
<h3>
Convert INTERGROWTH z-scores/centiles to fetal ultrasound measurements
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>igfet_zscore2hccm(gagedays, z&nbsp;=&nbsp;0)</div>
<div>igfet_zscore2bpdcm(gagedays, z&nbsp;=&nbsp;0)</div>
<div>igfet_zscore2ofdcm(gagedays, z&nbsp;=&nbsp;0)</div>
<div>igfet_zscore2accm(gagedays, z&nbsp;=&nbsp;0)</div>
<div>igfet_zscore2flcm(gagedays, z&nbsp;=&nbsp;0)</div>
<div>igfet_centile2hccm(gagedays, p&nbsp;=&nbsp;50)</div>
<div>igfet_centile2bpdcm(gagedays, p&nbsp;=&nbsp;50)</div>
<div>igfet_centile2ofdcm(gagedays, p&nbsp;=&nbsp;50)</div>
<div>igfet_centile2accm(gagedays, p&nbsp;=&nbsp;50)</div>
<div>igfet_centile2flcm(gagedays, p&nbsp;=&nbsp;50)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
gagedays
</dt>
<dd class="rd-dd">
gestational age in days
</dd>
<dt>
z
</dt>
<dd class="rd-dd">
z-score(s) to convert
</dd>
<dt>
p
</dt>
<dd class="rd-dd">
centile(s) to convert (must be between 0 and 100)
</dd>
</dl>
<h4>
References
</h4>
<p class="rd-p">
International standards for fetal growth based on serial ultrasound measurements: the Fetal Growth Longitudinal Study of the INTERGROWTH-21st Project Papageorghiou, Aris T et al. The Lancet, Volume 384, Issue 9946, 869-879
</p>
<h4>
Examples
</h4>
<pre class="r"><code># get value for median head circumference for child at 100 gestational days
igfet_centile2hccm(100, 50)</code></pre>
<pre><code>## [1] 10.14404</code></pre>
</div>
<div id="specific-value-to-centilez-score-2" class="section level2">
<h2>specific value to centile/z-score</h2>
<a id="igfet_var2zscore_alias"></a>
<h3>
Convert fetal ultrasound measurements to INTERGROWTH z-scores/centiles
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>igfet_hccm2zscore(gagedays, hccm)</div>
<div>igfet_bpdcm2zscore(gagedays, bpdcm)</div>
<div>igfet_ofdcm2zscore(gagedays, ofdcm)</div>
<div>igfet_accm2zscore(gagedays, accm)</div>
<div>igfet_flcm2zscore(gagedays, flcm)</div>
<div>igfet_hccm2centile(gagedays, hccm)</div>
<div>igfet_bpdcm2centile(gagedays, bpdcm)</div>
<div>igfet_ofdcm2centile(gagedays, ofdcm)</div>
<div>igfet_accm2centile(gagedays, accm)</div>
<div>igfet_flcm2centile(gagedays, flcm)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
gagedays
</dt>
<dd class="rd-dd">
gestational age in days
</dd>
<dt>
hccm
</dt>
<dd class="rd-dd">
head circumference (cm) measurement(s) to convert
</dd>
<dt>
bpdcm
</dt>
<dd class="rd-dd">
biparietel diameter (cm) measurement(s) to convert
</dd>
<dt>
ofdcm
</dt>
<dd class="rd-dd">
occipito-frontal diameter (cm) measurement(s) to convert
</dd>
<dt>
accm
</dt>
<dd class="rd-dd">
abdominal circumference (cm) measurement(s) to convert
</dd>
<dt>
flcm
</dt>
<dd class="rd-dd">
femur length (cm) measurement(s) to convert
</dd>
</dl>
<h4>
References
</h4>
<p class="rd-p">
International standards for fetal growth based on serial ultrasound measurements: the Fetal Growth Longitudinal Study of the INTERGROWTH-21st Project Papageorghiou, Aris T et al. The Lancet, Volume 384, Issue 9946, 869-879
</p>
<h4>
Examples
</h4>
<pre class="r"><code># get centile for child at 100 gestational days with 11 cm head circumference
igfet_hccm2centile(100, 11)</code></pre>
<pre><code>## [1] 93.39812</code></pre>
</div>
</div>
<div id="growth-standard-vis" class="section level1">
<h1>Growth Standard Vis</h1>
<div id="growth-standard-methods" class="section level2">
<h2>Growth standard methods</h2>
<a id="plot_growth_alias"></a>
<h3>
Utility functions for adding growth standard bands to rbokeh/lattice/ggplot2 plots
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>panel.who(x, x_var&nbsp;=&nbsp;"agedays", y_var&nbsp;=&nbsp;"htcm", sex&nbsp;=&nbsp;"Female", p&nbsp;=&nbsp;c(1, 5, 25, 50), color&nbsp;=&nbsp;NULL, alpha&nbsp;=&nbsp;0.15, center&nbsp;=&nbsp;FALSE, labels&nbsp;=&nbsp;TRUE, x_trans&nbsp;=&nbsp;identity, y_trans&nbsp;=&nbsp;identity)</div>
<div>panel.igb(gagebrth, var&nbsp;=&nbsp;"lencm", sex&nbsp;=&nbsp;"Female", p&nbsp;=&nbsp;c(1, 5, 25, 50), color&nbsp;=&nbsp;NULL, alpha&nbsp;=&nbsp;0.15, center&nbsp;=&nbsp;FALSE, labels&nbsp;=&nbsp;TRUE, x_trans&nbsp;=&nbsp;identity, y_trans&nbsp;=&nbsp;identity)</div>
<div>panel.igfet(gagedays, var&nbsp;=&nbsp;"hccm", p&nbsp;=&nbsp;c(1, 5, 25, 50), color&nbsp;=&nbsp;"green", alpha&nbsp;=&nbsp;0.15, center&nbsp;=&nbsp;FALSE, labels&nbsp;=&nbsp;TRUE, x_trans&nbsp;=&nbsp;identity, y_trans&nbsp;=&nbsp;identity)</div>
<div>geom_growthstandard(mapping&nbsp;=&nbsp;NULL, data&nbsp;=&nbsp;NULL, x_seq, x_var&nbsp;=&nbsp;"agedays", y_var, sex&nbsp;=&nbsp;"Female", p&nbsp;=&nbsp;c(1, 5, 25, 50), shade&nbsp;=&nbsp;NULL, alpha&nbsp;=&nbsp;0.15, center&nbsp;=&nbsp;FALSE, x_trans&nbsp;=&nbsp;identity, y_trans&nbsp;=&nbsp;identity, standard&nbsp;=&nbsp;"who", inherit.aes&nbsp;=&nbsp;TRUE)</div>
<div>geom_who(...)</div>
<div>geom_igb(..., var&nbsp;=&nbsp;"lencm")</div>
<div>geom_igfet(..., var&nbsp;=&nbsp;"hccm", color&nbsp;=&nbsp;"green")</div>
<div>ly_who(fig, x, x_var&nbsp;=&nbsp;"agedays", y_var&nbsp;=&nbsp;"htcm", sex&nbsp;=&nbsp;"Female", p&nbsp;=&nbsp;c(1, 5, 25, 50), color&nbsp;=&nbsp;NULL, alpha&nbsp;=&nbsp;0.15, center&nbsp;=&nbsp;FALSE, labels&nbsp;=&nbsp;TRUE, x_trans&nbsp;=&nbsp;identity, y_trans&nbsp;=&nbsp;identity, x_units&nbsp;=&nbsp;c("days", "months", "years"))</div>
<div>ly_igb(fig, gagebrth, var&nbsp;=&nbsp;"lencm", sex&nbsp;=&nbsp;"Female", p&nbsp;=&nbsp;c(1, 5, 25, 50), color&nbsp;=&nbsp;NULL, alpha&nbsp;=&nbsp;0.15, center&nbsp;=&nbsp;FALSE, labels&nbsp;=&nbsp;TRUE, x_trans&nbsp;=&nbsp;identity, y_trans&nbsp;=&nbsp;identity)</div>
<div>ly_igfet(fig, gagedays, var&nbsp;=&nbsp;"hccm", p&nbsp;=&nbsp;c(1, 5, 25, 50), color&nbsp;=&nbsp;"green", alpha&nbsp;=&nbsp;0.15, center&nbsp;=&nbsp;FALSE, labels&nbsp;=&nbsp;TRUE, x_trans&nbsp;=&nbsp;identity, y_trans&nbsp;=&nbsp;identity)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x, x_seq
</dt>
<dd class="rd-dd">
value or vector of values that correspond to a measure defined by <code>x_var</code>. <code>x_seq</code> is used with geom_*
</dd>
<dt>
x_var
</dt>
<dd class="rd-dd">
x variable name (typically “agedays”)
</dd>
<dt>
y_var
</dt>
<dd class="rd-dd">
y variable name (typically “htcm” or “wtkg”)
</dd>
<dt>
sex
</dt>
<dd class="rd-dd">
“Male” or “Female”
</dd>
<dt>
p
</dt>
<dd class="rd-dd">
centiles at which to draw the growth standard band polygons (only need to specify on one side of the median)
</dd>
<dt>
color, shade
</dt>
<dd class="rd-dd">
optional color to use for bands (will use <code>sex</code> to determine if not specified). <code>shade</code> is used with geom_*
</dd>
<dt>
alpha
</dt>
<dd class="rd-dd">
transparency of the bands
</dd>
<dt>
center
</dt>
<dd class="rd-dd">
should the bands be centered around the median?
</dd>
<dt>
labels
</dt>
<dd class="rd-dd">
should the centiles be labeled? (not implemented)
</dd>
<dt>
x_trans
</dt>
<dd class="rd-dd">
transformation function to be applied to x-axis
</dd>
<dt>
y_trans
</dt>
<dd class="rd-dd">
transformation function to be applied to y-axis
</dd>
<dt>
gagebrth
</dt>
<dd class="rd-dd">
gestational age at birth in days (for igb plots)
</dd>
<dt>
var
</dt>
<dd class="rd-dd">
variable name for y axis for igb or igfet plots (“lencm”, “wtkg”, or “hcircm” for igb; “accm”, “bpdcm”, “flcm”, “hccm”, or “ofdcm” for igfet)
</dd>
<dt>
gagedays
</dt>
<dd class="rd-dd">
gestational age in days (for igfet plots)
</dd>
<dt>
data, mapping, inherit.aes
</dt>
<dd class="rd-dd">
supplied direclty to <code>ggplot2::layer</code>
</dd>
<dt>
standard
</dt>
<dd class="rd-dd">
standard name to use. Either <code>“who”</code>, <code>“igb”</code>, or <code>“igfet”</code>
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
items supplied direclty to <code>geom_growthstandard</code>
</dd>
<dt>
fig
</dt>
<dd class="rd-dd">
rbokeh figure to add growth standard to
</dd>
<dt>
x_units
</dt>
<dd class="rd-dd">
units of age x-axis (days, months, or years)
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>## Not run: 
# #### rbokeh
# 
# library(rbokeh)
# figure() %&gt;%
#   ly_who(x = seq(0, 2558, by = 30), y_var = &quot;wtkg&quot;,
#     x_trans = days2years, sex = &quot;Male&quot;) %&gt;%
#   ly_points(days2years(agedays), wtkg,
#     data = subset(cpp, subjid == 8), col = &quot;black&quot;,
#     hover = c(agedays, wtkg, lencm, htcm, bmi, geniq, sysbp, diabp))
# 
# cpp$wtkg50 &lt;- who_centile2value(cpp$agedays, y_var = &quot;wtkg&quot;)
# figure() %&gt;%
#   ly_who(x = seq(0, 2558, by = 30), y_var = &quot;wtkg&quot;, color = &quot;blue&quot;,
#     x_trans = days2years, center = TRUE) %&gt;%
#   ly_points(days2years(agedays), wtkg - wtkg50, color = &quot;black&quot;,
#     data = subset(cpp, subjid == 8))
# 
# # look at Male birth lengths superposed on INTERGROWTH birth standard
# # first we need just 1 record per subject with subject-level data
# cppsubj &lt;- get_subject_data(cpp)
# figure(xlab = &quot;Gestational Age at Birth (days)&quot;, ylab = &quot;Birth Length (cm)&quot;) %&gt;%
#   ly_igb(gagebrth = 250:310, var = &quot;lencm&quot;, sex = &quot;Male&quot;) %&gt;%
#   ly_points(jitter(gagebrth), birthlen, data = subset(cppsubj, sex == &quot;Male&quot;),
#     color = &quot;black&quot;)
# 
# # plot growth standard bands at z=1, 2, 3 for fetal head circumference
# figure(xlab = &quot;Gestational Age (days)&quot;,
#   ylab = &quot;Head Circumference (cm)&quot;) %&gt;%
#     ly_igfet(gagedays = 98:280, var = &quot;hccm&quot;, p = pnorm(-3:0) * 100)
# ## End(Not run)

#### lattice

library(lattice)
xyplot(wtkg ~ agedays, data = subset(cpp, subjid == 8),
  panel = function(x, y, ...) {
    panel.who(x = seq(0, 2558, by = 30),
      sex = &quot;Male&quot;, y_var = &quot;wtkg&quot;, p = 100 * pnorm(-3:0))
    panel.xyplot(x, y, ...)
  },
  col = &quot;black&quot;
)</code></pre>
<p><img src="rd_files/figure-html/plot_growth_id_19-1.png" width="624" /></p>
<pre class="r"><code># look at Male birth lengths superposed on INTERGROWTH birth standard
# first we need just 1 record per subject with subject-level data
cppsubj &lt;- get_subject_data(cpp)
xyplot(birthlen ~ jitter(gagebrth), data = subset(cppsubj, sex == &quot;Male&quot;),
  panel = function(x, y, ...) {
    panel.igb(gagebrth = 250:310, var = &quot;lencm&quot;, sex = &quot;Male&quot;)
    panel.points(x, y, ...)
  },
  col = &quot;black&quot;, alpha = 0.75,
  xlab = &quot;Gestational Age at Birth (days)&quot;, ylab = &quot;Birth Length (cm)&quot;
)</code></pre>
<p><img src="rd_files/figure-html/plot_growth_id_19-2.png" width="624" /></p>
<pre class="r"><code>#### ggplot2

library(ggplot2)
p &lt;- ggplot(data = subset(cpp, subjid == 8), aes(x = agedays, y = htcm)) +
  geom_who(x_seq = seq(0, 2600, by = 10), y_var = &quot;htcm&quot;) +
  geom_point()</code></pre>
</div>
<div id="z-score-scale-methods" class="section level2">
<h2>z-score scale methods</h2>
<a id="plot_zband_alias"></a>
<h3>
Utility functions for adding growth standard bands to rbokeh/lattice/ggplot2 plots
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>ly_zband(fig, x, z&nbsp;=&nbsp;-3:0, color&nbsp;=&nbsp;"green", alpha&nbsp;=&nbsp;0.15, x_units&nbsp;=&nbsp;c("days", "months", "years"))</div>
<div>panel.zband(x, z&nbsp;=&nbsp;-3:0, color&nbsp;=&nbsp;"green", alpha&nbsp;=&nbsp;0.25)</div>
<div>geom_zband(obj, x, z&nbsp;=&nbsp;-3:0, color&nbsp;=&nbsp;"green", alpha&nbsp;=&nbsp;0.25)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
fig
</dt>
<dd class="rd-dd">
rbokeh figure to add z bands to
</dd>
<dt>
x
</dt>
<dd class="rd-dd">
range on x axis that should be covered by bands
</dd>
<dt>
z
</dt>
<dd class="rd-dd">
z-scores at which to draw bands (only need to specify on one side of zero)
</dd>
<dt>
color
</dt>
<dd class="rd-dd">
color to use for bands
</dd>
<dt>
alpha
</dt>
<dd class="rd-dd">
transparency of the bands
</dd>
<dt>
x_units
</dt>
<dd class="rd-dd">
units of age x-axis (days, months, or years)
</dd>
<dt>
obj
</dt>
<dd class="rd-dd">
ggplot2 object to add z bands to
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>## Not run: 
# library(rbokeh)
# figure() %&gt;%
#   ly_zband(cpp$agedays) %&gt;%
#   ly_points(jitter(agedays), haz, data = cpp, color = &quot;black&quot;)
# 
# library(lattice)
# xyplot(haz ~ jitter(agedays), data = cpp,
#   panel = function(x, y, ...) {
#     panel.zband(x)
#     panel.xyplot(x, y, ...)
#   },
#   col = &quot;black&quot;, alpha = 0.5
# )
# 
# library(ggplot2)
# p &lt;- ggplot(data = cpp, aes(x = jitter(agedays), y = haz))
# geom_zband(p, x = seq(0, 2600, by = 10)) +
#   geom_point()
# ## End(Not run)</code></pre>
</div>
</div>
<div id="modeling" class="section level1">
<h1>Modeling</h1>
<div id="get_fit" class="section level2">
<h2>get_fit</h2>
<a id="get_fit_alias"></a>
<h3>
Obtain a trajectory “fit” object for a dataset
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>get_fit(dat, x_var&nbsp;=&nbsp;"agedays", y_var&nbsp;=&nbsp;"htcm", method&nbsp;=&nbsp;"fda", holdout&nbsp;=&nbsp;FALSE, x_trans&nbsp;=&nbsp;NULL, x_inv&nbsp;=&nbsp;NULL, y_trans&nbsp;=&nbsp;NULL, y_inv&nbsp;=&nbsp;NULL, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
data frame containing variables to model
</dd>
<dt>
x_var
</dt>
<dd class="rd-dd">
name of x variable to model (default is “agedays”)
</dd>
<dt>
y_var
</dt>
<dd class="rd-dd">
name of y variable to model (usually an anthropometric measure or z-score scaled anthropometric measure)
</dd>
<dt>
method
</dt>
<dd class="rd-dd">
name of fitting method to use (see <code><a href=#get_avail_methods>get_avail_methods</a></code>)
</dd>
<dt>
holdout
</dt>
<dd class="rd-dd">
should an observation be held out for fitting (will use column <code>hold</code> in <code>dat</code> to which observations to hold out)
</dd>
<dt>
x_trans, y_trans
</dt>
<dd class="rd-dd">
transformation functions to be applied to x and y prior to modeling
</dd>
<dt>
x_inv, y_inv
</dt>
<dd class="rd-dd">
inverse transformation functions for x and y to get back to the original scale after modeling
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
parameters passed on to the fitting method
</dd>
</dl>
</div>
<div id="fit_trajectory" class="section level2">
<h2>fit_trajectory</h2>
<a id="fit_trajectory_alias"></a>
<h3>
Apply a model fit to an individual’s trajectory
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>fit_trajectory(dat, fit, xg&nbsp;=&nbsp;NULL, checkpoints&nbsp;=&nbsp;365 * c(1:2), z_bins&nbsp;=&nbsp;-2)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
data frame containing variables for one subject to apply a fit to
</dd>
<dt>
fit
</dt>
<dd class="rd-dd">
an object returned from <code><a href=#get_fit>get_fit</a></code>
</dd>
<dt>
xg
</dt>
<dd class="rd-dd">
grid of x points at which the fit should be evaluated for plotting (if <code>NULL</code> it will be set to an equally-spaced grid of 150 points across <code>x</code>)
</dd>
<dt>
checkpoints
</dt>
<dd class="rd-dd">
x values at which to compute “checkpoints” of the subjectss growth trajectory to compare to other subjects
</dd>
<dt>
z_bins
</dt>
<dd class="rd-dd">
a vector indicating binning of z-scores for the subjects trajectory at each checkpoint with respect to the the WHO growth standard
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>mod &lt;- get_fit(cpp, y_var = &quot;wtkg&quot;)
fit &lt;- fit_trajectory(subset(cpp, subjid == 2), mod)
plot(fit$xy$x, fit$xy$y)
lines(fit$fitgrid$x, fit$fitgrid$y)</code></pre>
<p><img src="rd_files/figure-html/fit_trajectory_id_22-1.png" width="624" /></p>
<pre class="r"><code># there is also a plot method:
plot(fit, x_range = c(0, 2560))</code></pre>
<div style="display: flex; width: 520px; height: 540px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 520px; height: 540px;"></div>
<iframe class="widget-lazyload lazy-loading" width="520" height="540" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/9acdeaffe63eb3125056453d5dfc1ed4.html"></iframe>
</div>
<pre class="r"><code># we can fit the z-scores instead
mod2 &lt;- get_fit(cpp, y_var = &quot;waz&quot;)
fit2 &lt;- fit_trajectory(subset(cpp, subjid == 2), mod2)</code></pre>
<pre><code>## some z-scores were too large - setting to 8</code></pre>
<pre class="r"><code>plot(fit2$xy$x, fit2$xy$z)
lines(fit2$fitgrid$x, fit2$fitgrid$z)</code></pre>
<p><img src="rd_files/figure-html/fit_trajectory_id_22-2.png" width="624" /></p>
<pre class="r"><code># using the plot method
plot(fit2, x_range = c(0, 2560), center = TRUE)</code></pre>
<div style="display: flex; width: 520px; height: 540px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 520px; height: 540px;"></div>
<iframe class="widget-lazyload lazy-loading" width="520" height="540" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/d2ce606da8cce1b0a577d0467a90d686.html"></iframe>
</div>
</div>
<div id="fit_all_trajectories" class="section level2">
<h2>fit_all_trajectories</h2>
<a id="fit_all_trajectories_alias"></a>
<h3>
Apply trajectory fitting to each subject in a dataset
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>fit_all_trajectories(dat, fit, xg&nbsp;=&nbsp;NULL, checkpoints&nbsp;=&nbsp;365 * c(1:2), z_bins&nbsp;=&nbsp;-2)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
a data frame containing data for several subjects or a ddf already divided by subject, as obtained from <code><a href=#by_subject>by_subject</a></code>
</dd>
<dt>
fit
</dt>
<dd class="rd-dd">
an object returned from <code><a href=#get_fit>get_fit</a></code>
</dd>
<dt>
xg
</dt>
<dd class="rd-dd">
grid of x points at which the fit should be evaluated for plotting (if <code>NULL</code> it will be set to an equally-spaced grid of 150 points across <code>x</code>)
</dd>
<dt>
checkpoints
</dt>
<dd class="rd-dd">
x values at which to compute “checkpoints” of the subjectss growth trajectory to compare to other subjects
</dd>
<dt>
z_bins
</dt>
<dd class="rd-dd">
a vector indicating binning of z-scores for the subjects trajectory at each checkpoint with respect to the the WHO growth standard
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>## Not run: 
# cppfit &lt;- get_fit(cpp, y_var = &quot;wtkg&quot;, method = &quot;rlm&quot;)
# cpptr  &lt;- fit_all_trajectories(cpp, cppfit)
# cpptr[[1]]
# plot(cpptr[[1]]$value)
# ## End(Not run)</code></pre>
</div>
<div id="get_fit_holdout_mse" class="section level2">
<h2>get_fit_holdout_mse</h2>
<a id="get_fit_holdout_mse_alias"></a>
<h3>
Get MSE for holdout
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>get_fit_holdout_mse(d, z&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
d
</dt>
<dd class="rd-dd">
an object returned from <code><a href=#fit_all_trajectories>fit_all_trajectories</a></code>
</dd>
<dt>
z
</dt>
<dd class="rd-dd">
compute MSE on z-score scale or original scale?
</dd>
</dl>
</div>
<div id="get_fit_holdout_errors" class="section level2">
<h2>get_fit_holdout_errors</h2>
<a id="get_fit_holdout_errors_alias"></a>
<h3>
Get holdout errors
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>get_fit_holdout_errors(d, z&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
d
</dt>
<dd class="rd-dd">
an object returned from <code><a href=#fit_all_trajectories>fit_all_trajectories</a></code>
</dd>
<dt>
z
</dt>
<dd class="rd-dd">
compute MSE on z-score scale or original scale?
</dd>
</dl>
</div>
<div id="plot.fittedtrajectory" class="section level2">
<h2>plot.fittedTrajectory</h2>
<a id="plot.fittedTrajectory_alias"></a>
<h3>
Plot a fitted trajectory
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>"plot"(x, center&nbsp;=&nbsp;FALSE, x_range&nbsp;=&nbsp;NULL, width&nbsp;=&nbsp;500, height&nbsp;=&nbsp;520, hover&nbsp;=&nbsp;NULL, checkpoints&nbsp;=&nbsp;TRUE, p&nbsp;=&nbsp;100 * pnorm(-3:0), x_units&nbsp;=&nbsp;c("days", "months", "years"), ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
an object returned from <code><a href=#fit_trajectory>fit_trajectory</a></code>
</dd>
<dt>
center
</dt>
<dd class="rd-dd">
should the trajectory be centered around the median WHO standard? This is equivalent to plotting the age difference score (like height-for-age difference - HAD)
</dd>
<dt>
x_range
</dt>
<dd class="rd-dd">
a vector specifying the range (min, max) that the superposed growth standard should span on the x-axis
</dd>
<dt>
width
</dt>
<dd class="rd-dd">
width of the plot
</dd>
<dt>
height
</dt>
<dd class="rd-dd">
height of the plot
</dd>
<dt>
hover
</dt>
<dd class="rd-dd">
variable names in <code>x$data</code> to show on hover for each point (only variables with non-NA data will be shown)
</dd>
<dt>
checkpoints
</dt>
<dd class="rd-dd">
should the checkpoints be plotted (if available)?
</dd>
<dt>
p
</dt>
<dd class="rd-dd">
centiles at which to draw the WHO polygons
</dd>
<dt>
x_units
</dt>
<dd class="rd-dd">
units of age x-axis (days, months, or years)
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/rbokeh/topics/figure>figure</a></code>
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>mod &lt;- get_fit(cpp, y_var = &quot;wtkg&quot;, method = &quot;rlm&quot;)
fit &lt;- fit_trajectory(subset(cpp, subjid == 2), mod)
plot(fit)</code></pre>
<div style="display: flex; width: 520px; height: 540px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 520px; height: 540px;"></div>
<iframe class="widget-lazyload lazy-loading" width="520" height="540" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/f486fa48cf4c8f9ba64b967ba9d48598.html"></iframe>
</div>
<pre class="r"><code>plot(fit, x_units = &quot;years&quot;)</code></pre>
<div style="display: flex; width: 520px; height: 540px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 520px; height: 540px;"></div>
<iframe class="widget-lazyload lazy-loading" width="520" height="540" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/eb9d4c919fbfd0a6dcfcbbc11260d744.html"></iframe>
</div>
<pre class="r"><code>plot(fit, center = TRUE)</code></pre>
<div style="display: flex; width: 520px; height: 540px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 520px; height: 540px;"></div>
<iframe class="widget-lazyload lazy-loading" width="520" height="540" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/76a55e8ddf8e4053894e55989a1af73b.html"></iframe>
</div>
<pre class="r"><code>plot(fit, hover = c(&quot;wtkg&quot;, &quot;bmi&quot;, &quot;waz&quot;, &quot;haz&quot;))</code></pre>
<div style="display: flex; width: 520px; height: 540px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 520px; height: 540px;"></div>
<iframe class="widget-lazyload lazy-loading" width="520" height="540" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/ae195582dc824a2da43de1bba7ec1076.html"></iframe>
</div>
</div>
<div id="plot_z" class="section level2">
<h2>plot_z</h2>
<a id="plot_z_alias"></a>
<h3>
Plot a fitted trajectory on z-score scale
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>plot_z(x, x_range&nbsp;=&nbsp;NULL, nadir&nbsp;=&nbsp;FALSE, recovery&nbsp;=&nbsp;NULL, width&nbsp;=&nbsp;500, height&nbsp;=&nbsp;520, hover&nbsp;=&nbsp;NULL, checkpoints&nbsp;=&nbsp;TRUE, z&nbsp;=&nbsp;-3:0, x_units&nbsp;=&nbsp;c("days", "months", "years"), ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
an object returned from <code><a href=#fit_trajectory>fit_trajectory</a></code>
</dd>
<dt>
x_range
</dt>
<dd class="rd-dd">
a vector specifying the range (min, max) that the superposed z-score bands should span on the x-axis
</dd>
<dt>
nadir
</dt>
<dd class="rd-dd">
should a guide be added to the plot showing the location of the nadir?
</dd>
<dt>
recovery
</dt>
<dd class="rd-dd">
age in days at which to plot recovery from nadir (only valid if nadir is TRUE) - if NULL (default), will not be plotted
</dd>
<dt>
width
</dt>
<dd class="rd-dd">
width of the plot
</dd>
<dt>
height
</dt>
<dd class="rd-dd">
height of the plot
</dd>
<dt>
hover
</dt>
<dd class="rd-dd">
variable names in <code>x$data</code> to show on hover for each point (only variables with non-NA data will be shown)
</dd>
<dt>
checkpoints
</dt>
<dd class="rd-dd">
should the checkpoints be plotted (if available)?
</dd>
<dt>
z
</dt>
<dd class="rd-dd">
z-scores at which to draw the z-score bands
</dd>
<dt>
x_units
</dt>
<dd class="rd-dd">
units of age x-axis (days, months, or years)
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/rbokeh/topics/figure>figure</a></code>
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>mod &lt;- get_fit(cpp, y_var = &quot;wtkg&quot;, method = &quot;rlm&quot;)
fit &lt;- fit_trajectory(subset(cpp, subjid == 2), mod)
plot_z(fit)</code></pre>
<div style="display: flex; width: 520px; height: 540px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 520px; height: 540px;"></div>
<iframe class="widget-lazyload lazy-loading" width="520" height="540" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/45cb51ba2eb4c686974e0a8ed05e3289.html"></iframe>
</div>
</div>
<div id="plot_velocity" class="section level2">
<h2>plot_velocity</h2>
<a id="plot_velocity_alias"></a>
<h3>
Plot a fitted trajectory’s velocity
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>plot_velocity(x, width&nbsp;=&nbsp;500, height&nbsp;=&nbsp;520, x_units&nbsp;=&nbsp;c("days", "months", "years"), ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
an object returned from <code><a href=#fit_trajectory>fit_trajectory</a></code>
</dd>
<dt>
width
</dt>
<dd class="rd-dd">
width of the plot
</dd>
<dt>
height
</dt>
<dd class="rd-dd">
height of the plot
</dd>
<dt>
x_units
</dt>
<dd class="rd-dd">
units of age x-axis (days, months, or years)
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/rbokeh/topics/figure>figure</a></code>
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>mod &lt;- get_fit(cpp, y_var = &quot;wtkg&quot;, method = &quot;rlm&quot;)
fit &lt;- fit_trajectory(subset(cpp, subjid == 2), mod)
plot_velocity(fit)</code></pre>
<div style="display: flex; width: 520px; height: 540px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 520px; height: 540px;"></div>
<iframe class="widget-lazyload lazy-loading" width="520" height="540" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/ea84b41fe4e23ec44e416637eaaea550.html"></iframe>
</div>
</div>
<div id="plot_zvelocity" class="section level2">
<h2>plot_zvelocity</h2>
<a id="plot_zvelocity_alias"></a>
<h3>
Plot a fitted trajectory’s z-score velocity
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>plot_zvelocity(x, width&nbsp;=&nbsp;500, height&nbsp;=&nbsp;520, x_units&nbsp;=&nbsp;c("days", "months", "years"), ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
an object returned from <code><a href=#fit_trajectory>fit_trajectory</a></code>
</dd>
<dt>
width
</dt>
<dd class="rd-dd">
width of the plot
</dd>
<dt>
height
</dt>
<dd class="rd-dd">
height of the plot
</dd>
<dt>
x_units
</dt>
<dd class="rd-dd">
units of age x-axis (days, months, or years)
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/rbokeh/topics/figure>figure</a></code>
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>mod &lt;- get_fit(cpp, y_var = &quot;wtkg&quot;, method = &quot;rlm&quot;)
fit &lt;- fit_trajectory(subset(cpp, subjid == 2), mod)
plot_zvelocity(fit)</code></pre>
<div style="display: flex; width: 520px; height: 540px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 520px; height: 540px;"></div>
<iframe class="widget-lazyload lazy-loading" width="520" height="540" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/aeba32a6cb83cba926a5ccc00f486317.html"></iframe>
</div>
</div>
<div id="get_avail_methods" class="section level2">
<h2>get_avail_methods</h2>
<a id="get_avail_methods_alias"></a>
<h3>
Get names of all available fitting methods
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>get_avail_methods()</div></code></pre>
<h4>
See also
</h4>
<p><code><a href=#get_fit>get_fit</a></code></p>
</div>
<div id="fit_method.brokenstick" class="section level2">
<h2>fit_method.brokenstick</h2>
<a id="fit_method.brokenstick_alias"></a>
<h3>
Get the result of fitting brokenstick to a dataset
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>"fit_method"(dat, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
data frame containing variables to model
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/brokenstick/topics/brokenstick>brokenstick</a></code>, most notably <code>knots</code>
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
This essentially gets an anthropometric dataset into shape for <code><a href=http://www.rdocumentation.org/packages/brokenstick/topics/brokenstick>brokenstick</a></code> (sets appropriate data structure and removes missing values) and runs the fitting routine.
</p>
<h4>
Note
</h4>
<p class="rd-p">
The settings for <code>x_trans</code> and <code>y_trans</code> must match that used in <code><a href=#fit_trajectory>fit_trajectory</a></code> and appropriate inverse transformations must be set there accordingly as well.
</p>
<h4>
Examples
</h4>
<pre class="r"><code>## Not run: 
# bsfit &lt;- get_fit(cpp, y_var = &quot;haz&quot;, method = &quot;brokenstick&quot;)
# fit &lt;- fit_trajectory(subset(cpp, subjid == 2), fit = bsfit)
# plot(fit)
# ## End(Not run)</code></pre>
</div>
<div id="fit_method.face" class="section level2">
<h2>fit_method.face</h2>
<a id="fit_method.face_alias"></a>
<h3>
Get the result of fitting face.sparse to a dataset
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>"fit_method"(dat, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
data frame containing variables to model
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/face/topics/face.sparse>face.sparse</a></code>, most notably <code>knots</code> which defaults to 10
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
This essentially gets an anthropometric dataset into shape for <code><a href=http://www.rdocumentation.org/packages/face/topics/face.sparse>face.sparse</a></code> (sets appropriate data structure and removes missing values) and runs the fitting routine.
</p>
<h4>
Note
</h4>
<p class="rd-p">
The settings for <code>x_trans</code> and <code>y_trans</code> must match that used in <code><a href=#fit_trajectory>fit_trajectory</a></code> and appropriate inverse transformations must be set there accordingly as well.
</p>
<h4>
Examples
</h4>
<pre class="r"><code>## Not run: 
# facefit &lt;- get_fit(cpp, y_var = &quot;haz&quot;, method = &quot;face&quot;)
# fit &lt;- fit_trajectory(subset(cpp, subjid == 2), fit = facefit)
# plot(fit)
# ## End(Not run)</code></pre>
</div>
<div id="fit_method.fda" class="section level2">
<h2>fit_method.fda</h2>
<a id="fit_method.fda_alias"></a>
<h3>
Compute functional “fda” fit of growth trajectory
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>"fit_method"(dat, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
data frame specifying x and y coordinates of data to fit
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/fda/topics/smooth.basisPar>smooth.basisPar</a></code>, notably <code>lambda</code> which defaults to 0.1
</dd>
</dl>
<h4>
Note
</h4>
<p class="rd-p">
The trajectory fitting functions are most easily accessed through calling <code><a href=#fit_trajectory>fit_trajectory</a></code> with the <code>method</code> argument to specify the modeling approach to use.
</p>
<p class="rd-p">
These fitting functions can easily be replaced by simply calling the associated R methods, but are provided for convenience to standardize input/output to simplify swapping fitting methods.
</p>
</div>
<div id="fit_method.gam" class="section level2">
<h2>fit_method.gam</h2>
<a id="fit_method.gam_alias"></a>
<h3>
Compute gam spline fit of growth trajectory
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>"fit_method"(dat, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
data frame specifying x and y coordinates of data to fit
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/mgcv/topics/gam>gam</a></code>
</dd>
</dl>
<h4>
Note
</h4>
<p class="rd-p">
The trajectory fitting functions are most easily accessed through calling <code><a href=#fit_trajectory>fit_trajectory</a></code> with the <code>method</code> argument to specify the modeling approach to use.
</p>
<p class="rd-p">
These fitting functions can easily be replaced by simply calling the associated R methods, but are provided for convenience to standardize input/output to simplify swapping fitting methods.
</p>
</div>
<div id="fit_method.loess" class="section level2">
<h2>fit_method.loess</h2>
<a id="fit_method.loess_alias"></a>
<h3>
Compute loess fit of growth trajectory
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>"fit_method"(dat, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
data frame specifying x and y coordinates of data to fit
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/stats/topics/loess>loess</a></code>, notably <code>span</code>, <code>degree</code>, and <code>family</code>
</dd>
</dl>
<h4>
Note
</h4>
<p class="rd-p">
The trajectory fitting functions are most easily accessed through calling <code><a href=#fit_trajectory>fit_trajectory</a></code> with the <code>method</code> argument to specify the modeling approach to use.
</p>
<p class="rd-p">
These fitting functions can easily be replaced by simply calling the associated R methods, but are provided for convenience to standardize input/output to simplify swapping fitting methods.
</p>
</div>
<div id="fit_method.lwmod" class="section level2">
<h2>fit_method.lwmod</h2>
<a id="fit_method.lwmod_alias"></a>
<h3>
Get the result of fitting a Laird and Ware linear or quadratic model to a dataset
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>"fit_method"(dat, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
data frame containing variables to model
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
additional parameters, most notably <code>deg</code> which controls the degree of polynomial for the fit (1 for linear and 2 for quadratic)
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
This essentially gets an anthropometric dataset into shape for <code><a href=http://www.rdocumentation.org/packages/sitar/topics/sitar>sitar</a></code> (sets appropriate data structure and removes missing values) and runs the fitting routine.
</p>
<h4>
Note
</h4>
<p class="rd-p">
The settings for <code>x_trans</code> and <code>y_trans</code> must match that used in <code><a href=#fit_trajectory>fit_trajectory</a></code> and appropriate inverse transformations must be set there accordingly as well.
</p>
<h4>
Examples
</h4>
<pre class="r"><code>## Not run: 
# lwfit &lt;- get_fit(cpp, y_var = &quot;haz&quot;, method = &quot;lwmod&quot;, deg = 2)
# fit &lt;- fit_trajectory(subset(cpp, subjid == 2), fit = lwfit)
# plot(fit)
# ## End(Not run)</code></pre>
</div>
<div id="fit_method.rlm" class="section level2">
<h2>fit_method.rlm</h2>
<a id="fit_method.rlm_alias"></a>
<h3>
Compute robust linear model fit of growth trajectory
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>"fit_method"(dat, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
data frame specifying x and y coordinates of data to fit
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/MASS/topics/rlm>rlm</a></code>, also <code>p</code> which is the order of polynomial fit (default is quadratic, p=2)
</dd>
</dl>
<h4>
Note
</h4>
<p class="rd-p">
The trajectory fitting functions are most easily accessed through calling <code><a href=#fit_trajectory>fit_trajectory</a></code> with the <code>method</code> argument to specify the modeling approach to use.
</p>
<p class="rd-p">
These fitting functions can easily be replaced by simply calling the associated R methods, but are provided for convenience to standardize input/output to simplify swapping fitting methods.
</p>
</div>
<div id="fit_method.sitar" class="section level2">
<h2>fit_method.sitar</h2>
<a id="fit_method.sitar_alias"></a>
<h3>
Get the result of fitting sitar to a dataset
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>"fit_method"(dat, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
data frame containing variables to model
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/sitar/topics/sitar>sitar</a></code>, most notably <code>df</code> which defaults to 3
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
This essentially gets an anthropometric dataset into shape for <code><a href=http://www.rdocumentation.org/packages/sitar/topics/sitar>sitar</a></code> (sets appropriate data structure and removes missing values) and runs the fitting routine.
</p>
<h4>
Note
</h4>
<p class="rd-p">
The settings for <code>x_trans</code> and <code>y_trans</code> must match that used in <code><a href=#fit_trajectory>fit_trajectory</a></code> and appropriate inverse transformations must be set there accordingly as well.
</p>
<h4>
Examples
</h4>
<pre class="r"><code>## Not run: 
# sitfit &lt;- get_fit(cpp, y_var = &quot;haz&quot;, method = &quot;sitar&quot;)
# fit &lt;- fit_trajectory(subset(cpp, subjid == 2), fit = sitfit)
# plot(fit)
# ## End(Not run)</code></pre>
</div>
<div id="fit_method.smooth.spline" class="section level2">
<h2>fit_method.smooth.spline</h2>
<a id="fit_method.smooth.spline_alias"></a>
<h3>
Compute smooth.spline fit of growth trajectory
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>"fit_method"(dat, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
data frame specifying x and y coordinates of data to fit
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/stats/topics/smooth.spline>smooth.spline</a></code>
</dd>
</dl>
<h4>
Note
</h4>
<p class="rd-p">
The trajectory fitting functions are most easily accessed through calling <code><a href=#fit_trajectory>fit_trajectory</a></code> with the <code>method</code> argument to specify the modeling approach to use.
</p>
<p class="rd-p">
These fitting functions can easily be replaced by simply calling the associated R methods, but are provided for convenience to standardize input/output to simplify swapping fitting methods.
</p>
</div>
<div id="fit_method.wand" class="section level2">
<h2>fit_method.wand</h2>
<a id="fit_method.wand_alias"></a>
<h3>
Get the result of fitting a “Wand” model to a dataset
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>"fit_method"(dat, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
data frame containing variables to model
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
additional parameters, most notably <code>deg</code> which controls the degree of polynomial for the fit (1 for linear and 2 for quadratic)
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
This essentially gets an anthropometric dataset into shape for <code><a href=http://www.rdocumentation.org/packages/sitar/topics/sitar>sitar</a></code> (sets appropriate data structure and removes missing values) and runs the fitting routine.
</p>
<h4>
Note
</h4>
<p class="rd-p">
The settings for <code>x_trans</code> and <code>y_trans</code> must match that used in <code><a href=#fit_trajectory>fit_trajectory</a></code> and appropriate inverse transformations must be set there accordingly as well.
</p>
<h4>
Examples
</h4>
<pre class="r"><code>## Not run: 
# wfit &lt;- get_fit(cpp, y_var = &quot;haz&quot;, method = &quot;lwmod&quot;, deg = 2)
# fit &lt;- fit_trajectory(subset(cpp, subjid == 2), fit = wfit)
# plot(fit)
# ## End(Not run)</code></pre>
</div>
<div id="auto_loess" class="section level2">
<h2>auto_loess</h2>
<a id="auto_loess_alias"></a>
<h3>
Find best loess fit based on aic or gcv
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>auto_loess(data, span&nbsp;=&nbsp;c(0.01, 2), degree&nbsp;=&nbsp;c(1, 2), family&nbsp;=&nbsp;"gaussian", which&nbsp;=&nbsp;"gcv", ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
data
</dt>
<dd class="rd-dd">
a data frame with columns x and y to be used in the fitting
</dd>
<dt>
span
</dt>
<dd class="rd-dd">
a vector indicating a range (min, max) of spans to search over
</dd>
<dt>
degree
</dt>
<dd class="rd-dd">
a vector of degrees to search over (valid values are combinations of 0, 1, 2)
</dd>
<dt>
family
</dt>
<dd class="rd-dd">
loess <code>family</code> parameter
</dd>
<dt>
which
</dt>
<dd class="rd-dd">
which method to use, “aicc” or “gcv”
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/stats/topics/loess>loess</a></code>
</dd>
</dl>
</div>
</div>
<div id="summary-vis" class="section level1">
<h1>Summary Vis</h1>
<div id="plot_univar" class="section level2">
<h2>plot_univar</h2>
<a id="plot_univar_alias"></a>
<h3>
Make a grid of univariate summary plots
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>plot_univar(dat, subject&nbsp;=&nbsp;FALSE, ncol&nbsp;=&nbsp;3, width&nbsp;=&nbsp;300, height&nbsp;=&nbsp;300)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
data frame
</dd>
<dt>
subject
</dt>
<dd class="rd-dd">
should subject-level (TRUE) or time-varying (FALSE) variables be plotted?
</dd>
<dt>
ncol
</dt>
<dd class="rd-dd">
number of columns in the grid
</dd>
<dt>
width
</dt>
<dd class="rd-dd">
width of each plot in pixels
</dd>
<dt>
height
</dt>
<dd class="rd-dd">
height of each plot in pixels
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
Subject-level variables are treated differently than time-varying variables in that they are repeated for each subject. When plotting summaries of subject-level variables, the data is first subset to one record per subject.
</p>
<h4>
Examples
</h4>
<pre class="r"><code>plot_univar(cpp, subject = TRUE)</code></pre>
<div style="display: flex; width: 920px; height: 2720px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 920px; height: 2720px;"></div>
<iframe class="widget-lazyload lazy-loading" width="920" height="2720" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/5bd8d54c533a2df6674475abafec5a66.html"></iframe>
</div>
<pre class="r"><code>plot_univar(cpp)</code></pre>
<div style="display: flex; width: 920px; height: 1220px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 920px; height: 1220px;"></div>
<iframe class="widget-lazyload lazy-loading" width="920" height="1220" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/d8dcdcef1ec9f928be77e3b153918604.html"></iframe>
</div>
</div>
<div id="plot_missing" class="section level2">
<h2>plot_missing</h2>
<a id="plot_missing_alias"></a>
<h3>
Plot a stacked bar chart indicating NAs for each variable in a dataset
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>plot_missing(dat, subject&nbsp;=&nbsp;FALSE, width&nbsp;=&nbsp;800, height&nbsp;=&nbsp;500, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
data frame
</dd>
<dt>
subject
</dt>
<dd class="rd-dd">
should subject-level (TRUE) or time-varying (FALSE) variables be plotted?
</dd>
<dt>
width
</dt>
<dd class="rd-dd">
width of plot in pixels
</dd>
<dt>
height
</dt>
<dd class="rd-dd">
height of plot in pixels
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/rbokeh/topics/figure>figure</a></code>
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
Subject-level variables are treated differently than time-varying variables in that they are repeated for each subject. When plotting summaries of subject-level variables, the data is first subset to one record per subject.
</p>
<h4>
Examples
</h4>
<pre class="r"><code>plot_missing(cpp)</code></pre>
<div style="display: flex; width: 820px; height: 520px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 820px; height: 520px;"></div>
<iframe class="widget-lazyload lazy-loading" width="820" height="520" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/ef0d5f77d5a27a25e3b590282ca1d06d.html"></iframe>
</div>
<pre class="r"><code>plot_missing(cpp, subject = TRUE)</code></pre>
<div style="display: flex; width: 820px; height: 520px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 820px; height: 520px;"></div>
<iframe class="widget-lazyload lazy-loading" width="820" height="520" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/8af3c22070c7fbf2584501d7ef0a6b15.html"></iframe>
</div>
</div>
<div id="plot_complete_pairs" class="section level2">
<h2>plot_complete_pairs</h2>
<a id="plot_complete_pairs_alias"></a>
<h3>
Plot a heat map of frequency of “complete” (both non-NA) pairs of variables
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>plot_complete_pairs(dat, subject&nbsp;=&nbsp;FALSE, width&nbsp;=&nbsp;700, height&nbsp;=&nbsp;700, thresh&nbsp;=&nbsp;0.95, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
data frame
</dd>
<dt>
subject
</dt>
<dd class="rd-dd">
should subject-level (TRUE) or time-varying (FALSE) variables be plotted?
</dd>
<dt>
width
</dt>
<dd class="rd-dd">
width of plot in pixels
</dd>
<dt>
height
</dt>
<dd class="rd-dd">
height of plot in pixels
</dd>
<dt>
thresh
</dt>
<dd class="rd-dd">
percentage NA threshold above which variables will be ignored (to help deal with cases involving many variables)
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/rbokeh/topics/figure>figure</a></code>
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
Subject-level variables are treated differently than time-varying variables in that they are repeated for each subject. When plotting summaries of subject-level variables, the data is first subset to one record per subject.
</p>
<h4>
Examples
</h4>
<pre class="r"><code>plot_complete_pairs(cpp)</code></pre>
<div style="display: flex; width: 720px; height: 720px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 720px; height: 720px;"></div>
<iframe class="widget-lazyload lazy-loading" width="720" height="720" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/3ef4216d23267c163923b8b72d481fb6.html"></iframe>
</div>
<pre class="r"><code>plot_complete_pairs(cpp, subject = TRUE)</code></pre>
<div style="display: flex; width: 720px; height: 720px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 720px; height: 720px;"></div>
<iframe class="widget-lazyload lazy-loading" width="720" height="720" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/d60488eb399adf36b5c1e4f480fd856b.html"></iframe>
</div>
</div>
<div id="plot_agefreq" class="section level2">
<h2>plot_agefreq</h2>
<a id="plot_agefreq_alias"></a>
<h3>
Plot age frequency
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>plot_agefreq(x, xlab&nbsp;=&nbsp;"Age since birth at examination (days)", ylab&nbsp;=&nbsp;"# examinations", width&nbsp;=&nbsp;700, height&nbsp;=&nbsp;350, age_units&nbsp;=&nbsp;c("days", "months", "years"))</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
a data frame of raw data or an object returned from <code><a href=#get_agefreq>get_agefreq</a></code>
</dd>
<dt>
xlab
</dt>
<dd class="rd-dd">
label for x axis
</dd>
<dt>
ylab
</dt>
<dd class="rd-dd">
label for y axis
</dd>
<dt>
width
</dt>
<dd class="rd-dd">
width of plot in pixels
</dd>
<dt>
height
</dt>
<dd class="rd-dd">
height of plot in pixels
</dd>
<dt>
age_units
</dt>
<dd class="rd-dd">
units of age x-axis (days, months, or years)
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>agefreq &lt;- get_agefreq(cpp)
plot_agefreq(agefreq)</code></pre>
<div style="display: flex; width: 720px; height: 370px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 720px; height: 370px;"></div>
<iframe class="widget-lazyload lazy-loading" width="720" height="370" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/4f1c2a91fdaa9fd1c99f360480f62fd2.html"></iframe>
</div>
</div>
<div id="plot_first_visit_age" class="section level2">
<h2>plot_first_visit_age</h2>
<a id="plot_first_visit_age_alias"></a>
<h3>
Plot histogram and quantile plot of age at first visit
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>plot_first_visit_age(dat, agelab&nbsp;=&nbsp;"first visit age (days)", width&nbsp;=&nbsp;450, height&nbsp;=&nbsp;450)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
a longitudinal growth study dataset
</dd>
<dt>
agelab
</dt>
<dd class="rd-dd">
label of the age axis
</dd>
<dt>
width
</dt>
<dd class="rd-dd">
the width of each plot in pixels
</dd>
<dt>
height
</dt>
<dd class="rd-dd">
the height of each plot in pixels
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>plot_first_visit_age(cpp)</code></pre>
<div style="display: flex; width: 920px; height: 470px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 920px; height: 470px;"></div>
<iframe class="widget-lazyload lazy-loading" width="920" height="470" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/140106db16c4c2c9598a23f08f96bf16.html"></iframe>
</div>
</div>
<div id="plot_visit_distn" class="section level2">
<h2>plot_visit_distn</h2>
<a id="plot_visit_distn_alias"></a>
<h3>
Plot histogram and quantile plot of number of “visits” for each subject
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>plot_visit_distn(dat, width&nbsp;=&nbsp;450, height&nbsp;=&nbsp;450)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
a longitudinal growth study dataset
</dd>
<dt>
width
</dt>
<dd class="rd-dd">
the width of each plot in pixels
</dd>
<dt>
height
</dt>
<dd class="rd-dd">
the height of each plot in pixels
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>plot_visit_distn(cpp)</code></pre>
<div style="display: flex; width: 920px; height: 470px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 920px; height: 470px;"></div>
<iframe class="widget-lazyload lazy-loading" width="920" height="470" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/75f86d9b199f04661ed75cc510b2c896.html"></iframe>
</div>
</div>
</div>
<div id="multi-study-vis" class="section level1">
<h1>Multi-Study Vis</h1>
<div id="plot_var_matrix" class="section level2">
<h2>plot_var_matrix</h2>
<a id="plot_var_matrix_alias"></a>
<h3>
Plot a matrix comparing variables present in a list of studies
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>plot_var_matrix(dat_list, width&nbsp;=&nbsp;845, h_padding&nbsp;=&nbsp;0, head&nbsp;=&nbsp;NULL)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat_list
</dt>
<dd class="rd-dd">
a list of data frames containing study data
</dd>
<dt>
width
</dt>
<dd class="rd-dd">
width of the plot in pixels
</dd>
<dt>
h_padding
</dt>
<dd class="rd-dd">
extra height to add to the plot to account for long variable names
</dd>
<dt>
head
</dt>
<dd class="rd-dd">
the number of variables to limit the x-axis to (if negative, it will show all but the first <code>head</code> variables)
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>dat_list &lt;- list(
  cpp1 = cpp[, c(1:5, 7:9, 14:19, 23:32)],
  cpp2 = cpp[, c(1:5, 11:24)],
  cpp3 = cpp
)
plot_var_matrix(dat_list)</code></pre>
<div style="display: flex; width: 865px; height: 270px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 865px; height: 270px;"></div>
<iframe class="widget-lazyload lazy-loading" width="865" height="270" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/aa4c11baeea7c8d4026177ba4101a7c2.html"></iframe>
</div>
</div>
<div id="plot_multi_subj_boxplot" class="section level2">
<h2>plot_multi_subj_boxplot</h2>
<a id="plot_multi_subj_boxplot_alias"></a>
<h3>
Plot boxplots of distrubutions of number of records per subject for a list of studies
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>plot_multi_subj_boxplot(dat_list, width&nbsp;=&nbsp;800, height&nbsp;=&nbsp;500)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat_list
</dt>
<dd class="rd-dd">
a list of data frames containing study data
</dd>
<dt>
width
</dt>
<dd class="rd-dd">
width of the plot in pixels
</dd>
<dt>
height
</dt>
<dd class="rd-dd">
height of the plot in pixels
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>dat_list &lt;- list(
  cpp1 = cpp,
  cpp2 = cpp,
  cpp3 = cpp
)
plot_multi_subj_boxplot(dat_list)</code></pre>
<div style="display: flex; width: 820px; height: 520px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 820px; height: 520px;"></div>
<iframe class="widget-lazyload lazy-loading" width="820" height="520" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/5aed29816e073fe2c34d98815547e918.html"></iframe>
</div>
</div>
<div id="plot_time_count_grid" class="section level2">
<h2>plot_time_count_grid</h2>
<a id="plot_time_count_grid_alias"></a>
<h3>
Plot counts by age for a list of studies
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>plot_time_count_grid(dat_list, xlab&nbsp;=&nbsp;"Age since birth at examination (days)", width&nbsp;=&nbsp;845, height&nbsp;=&nbsp;120, y_margin&nbsp;=&nbsp;100)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat_list
</dt>
<dd class="rd-dd">
a list of data frames containing study data
</dd>
<dt>
xlab
</dt>
<dd class="rd-dd">
label for x axis
</dd>
<dt>
width
</dt>
<dd class="rd-dd">
width of the plot in pixels
</dd>
<dt>
height
</dt>
<dd class="rd-dd">
height of each panel of the plot in pixels
</dd>
<dt>
y_margin
</dt>
<dd class="rd-dd">
minimum padding for axis tick labels on left
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>dat_list &lt;- list(
  cpp1 = cpp,
  cpp2 = cpp,
  cpp3 = cpp
)
plot_time_count_grid(dat_list)</code></pre>
<div style="display: flex; width: 865px; height: 386px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 865px; height: 386px;"></div>
<iframe class="widget-lazyload lazy-loading" width="865" height="386" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/89d9120df4e0a73e14975e4c3ed78088.html"></iframe>
</div>
</div>
</div>
<div id="trelliscope-vis" class="section level1">
<h1>Trelliscope Vis</h1>
<div id="trscope_trajectories" class="section level2">
<h2>trscope_trajectories</h2>
<a id="trscope_trajectories_alias"></a>
<h3>
Create Trelliscope display of per-subject data and fitted trajectories
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>trscope_trajectories(dat, z&nbsp;=&nbsp;FALSE, center&nbsp;=&nbsp;FALSE, x_range&nbsp;=&nbsp;NULL, width&nbsp;=&nbsp;500, height&nbsp;=&nbsp;520, name&nbsp;=&nbsp;NULL, desc&nbsp;=&nbsp;"", group&nbsp;=&nbsp;NULL, vdb_conn&nbsp;=&nbsp;getOption("vdbConn"), nadir&nbsp;=&nbsp;FALSE, recovery&nbsp;=&nbsp;NULL, x_units&nbsp;=&nbsp;"days")</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
either a data frame or object created by <code><a href=#by_subject>by_subject</a></code> or <code><a href=#fit_all_trajectories>fit_all_trajectories</a></code>
</dd>
<dt>
z
</dt>
<dd class="rd-dd">
should the trajectory fit be plotted on the z-scale?
</dd>
<dt>
center
</dt>
<dd class="rd-dd">
should the trajectory be centered around the median WHO standard?
</dd>
<dt>
x_range
</dt>
<dd class="rd-dd">
a vector specifying the range (min, max) that the superposed WHO growth standard should span on the x-axis
</dd>
<dt>
width
</dt>
<dd class="rd-dd">
width of the plot
</dd>
<dt>
height
</dt>
<dd class="rd-dd">
height of the plot
</dd>
<dt>
name
</dt>
<dd class="rd-dd">
name of the Trelliscope display (if left NULL, will be implied by the variables being plotted and the method name)
</dd>
<dt>
desc
</dt>
<dd class="rd-dd">
description of the Trelliscope display
</dd>
<dt>
group
</dt>
<dd class="rd-dd">
group in which to place the Trelliscope display
</dd>
<dt>
vdb_conn
</dt>
<dd class="rd-dd">
an optional VDB connection
</dd>
<dt>
nadir
</dt>
<dd class="rd-dd">
should a guide be added to the plot showing the location of the nadir? (only valid when z = TRUE)
</dd>
<dt>
recovery
</dt>
<dd class="rd-dd">
age in days at which to plot recovery from nadir (only valid when z = TRUE) - if NULL (default), will not be plotted
</dd>
<dt>
x_units
</dt>
<dd class="rd-dd">
units of age x-axis (days, months, or years)
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>## Not run: 
# cppsubj  &lt;- by_subject(cpp)
# cppfit   &lt;- get_fit(cpp, method = &quot;rlm&quot;)
# cpptr    &lt;- fit_all_trajectories(cppsubj, cppfit)
# cppplot  &lt;- trscope_trajectories(cpptr)
# cppzplot &lt;- trscope_trajectories(cpptr, z = TRUE, nadir = TRUE, x_units = &quot;months&quot;)
# ## End(Not run)</code></pre>
</div>
<div id="trscope_velocities" class="section level2">
<h2>trscope_velocities</h2>
<a id="trscope_velocities_alias"></a>
<h3>
Create Trelliscope display of the velocities of per-subject fitted trajectories
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>trscope_velocities(dat, z&nbsp;=&nbsp;FALSE, x_range&nbsp;=&nbsp;NULL, width&nbsp;=&nbsp;500, height&nbsp;=&nbsp;520, name&nbsp;=&nbsp;NULL, desc&nbsp;=&nbsp;"", group&nbsp;=&nbsp;NULL, vdb_conn&nbsp;=&nbsp;getOption("vdbConn"), nadir&nbsp;=&nbsp;FALSE, recovery&nbsp;=&nbsp;NULL, x_units&nbsp;=&nbsp;"days")</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
either a data frame or object created by <code><a href=#by_subject>by_subject</a></code> or <code><a href=#fit_all_trajectories>fit_all_trajectories</a></code>
</dd>
<dt>
z
</dt>
<dd class="rd-dd">
should velocities according to z-score scale or raw scale be plotted?
</dd>
<dt>
x_range
</dt>
<dd class="rd-dd">
a vector specifying the range (min, max) that the x-axis should span
</dd>
<dt>
width
</dt>
<dd class="rd-dd">
width of the plot
</dd>
<dt>
height
</dt>
<dd class="rd-dd">
height of the plot
</dd>
<dt>
name
</dt>
<dd class="rd-dd">
name of the Trelliscope display (if NULL, will be implied by the variables being plotted and the method name)
</dd>
<dt>
desc
</dt>
<dd class="rd-dd">
description of the Trelliscope display
</dd>
<dt>
group
</dt>
<dd class="rd-dd">
group in which to place the Trelliscope display
</dd>
<dt>
vdb_conn
</dt>
<dd class="rd-dd">
an optional VDB connection
</dd>
<dt>
nadir
</dt>
<dd class="rd-dd">
should a guide be added to the plot showing the location of the nadir? (only valid when z = TRUE)
</dd>
<dt>
recovery
</dt>
<dd class="rd-dd">
age in days at which to plot recovery from nadir (only valid when z = TRUE) - if NULL (default), will not be plotted
</dd>
<dt>
x_units
</dt>
<dd class="rd-dd">
units of age x-axis (days, months, or years)
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>## Not run: 
# cppsubj &lt;- by_subject(cpp)
# cppfit  &lt;- get_fit(cpp, method = &quot;rlm&quot;)
# cpptr   &lt;- fit_all_trajectories(cppsubj, cppfit)
# cppplot &lt;- trscope_velocities(cpptr)
# ## End(Not run)</code></pre>
</div>
</div>
<div id="divisions" class="section level1">
<h1>Divisions</h1>
<div id="by_subject" class="section level2">
<h2>by_subject</h2>
<a id="by_subject_alias"></a>
<h3>
Divide a dataset into subsets by subject
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>by_subject(dat)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
dataset to divide by subject
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>cppsubj &lt;- by_subject(cpp)</code></pre>
</div>
<div id="by_trajectory_checkpoints" class="section level2">
<h2>by_trajectory_checkpoints</h2>
<a id="by_trajectory_checkpoints_alias"></a>
<h3>
Split by-subject trajectory-fitted data by checkpoint categorizations
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>by_trajectory_checkpoints(dat, complete&nbsp;=&nbsp;TRUE)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
a data object returned by <code><a href=#fit_all_trajectories>fit_all_trajectories</a></code>
</dd>
<dt>
complete
</dt>
<dd class="rd-dd">
subset only to those that have fitted checkpoints
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>## Not run: 
# cppsubj &lt;- by_subject(cpp)
# cppfit  &lt;- get_fit(cpp, method = &quot;rlm&quot;)
# cpptr   &lt;- fit_all_trajectories(cppsubj, cppfit)
# cppcp   &lt;- by_trajectory_checkpoints(cpptr)
# ## End(Not run)</code></pre>
</div>
</div>
<div id="data-sets" class="section level1">
<h1>Data Sets</h1>
<div id="cpp" class="section level2">
<h2>cpp</h2>
<a id="cpp_alias"></a>
<h3>
Subset of growth data from the collaborative perinatal project (CPP)
</h3>
<p class="rd-p">
Subset of growth data from the collaborative perinatal project (CPP).
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>cpp</div></code></pre>
<h4>
Source
</h4>
<p class="rd-p">
<a href = https://catalog.archives.gov/id/606622>https://catalog.archives.gov/id/606622</a>
</p>
<p class="rd-p">
Broman, Sarah. “The collaborative perinatal project: an overview.” Handbook of longitudinal research 1 (1984): 185-227.
</p>
<h4>
Examples
</h4>
<pre class="r"><code>head(cpp)</code></pre>
<pre><code>##   subjid agedays   wtkg htcm lencm      bmi   waz   haz   whz   baz siteid
## 1      1       1  4.621   55    55 15.27603  2.38  2.61  0.19  1.35      5
## 2      1     123  8.760   NA    NA       NA  1.99    NA    NA    NA      5
## 3      1     366 14.500   79    79 23.23346  3.84  1.35  4.02  3.89      5
## 4      2       1  3.345   51    51 12.86044  0.06  0.50 -0.64 -0.43      5
## 5      2     123  4.340   NA    NA       NA -3.99    NA    NA    NA      5
## 6      2     366  8.400   73    73 15.76281 -1.27 -1.17 -0.96 -0.80      5
##   sexn  sex feedingn feeding gagebrth birthwt birthlen apgar1 apgar5 mage
## 1    1 Male       90 Unknown      287    4621       55      8      9   21
## 2    1 Male       90 Unknown      287    4621       55      8      9   21
## 3    1 Male       90 Unknown      287    4621       55      8      9   21
## 4    1 Male       90 Unknown      280    3345       51      8      9   15
## 5    1 Male       90 Unknown      280    3345       51      8      9   15
## 6    1 Male       90 Unknown      280    3345       51      8      9   15
##   mracen mrace mmaritn  mmarit meducyrs sesn          ses parity gravida
## 1      5 White       1 Married       12   50       Middle      1       1
## 2      5 White       1 Married       12   50       Middle      1       1
## 3      5 White       1 Married       12   50       Middle      1       1
## 4      5 White       1 Married       NA   NA            .      0       0
## 5      5 White       1 Married       NA   NA            .      0       0
## 6      5 White       1 Married       NA   NA            .      0       0
##   smoked mcignum preeclmp comprisk geniq sysbp diabp       haz2
## 1      0       0        0     none    NA    NA    NA  2.6071172
## 2      0       0        0     none    NA    NA    NA         NA
## 3      0       0        0     none    NA    NA    NA  1.3549255
## 4      1      35        0     none    NA    NA    NA  0.4960484
## 5      1      35        0     none    NA    NA    NA         NA
## 6      1      35        0     none    NA    NA    NA -1.1682915</code></pre>
</div>
<div id="get_smocc_data" class="section level2">
<h2>get_smocc_data</h2>
<a id="get_smocc_data_alias"></a>
<h3>
Get SMOCC data from brokenstick, transformed to be hbgd-compatible
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>get_smocc_data()</div></code></pre>
</div>
<div id="who_coefs" class="section level2">
<h2>who_coefs</h2>
<a id="who_coefs_alias"></a>
<h3>
List of WHO growth standard coefficients
</h3>
<p class="rd-p">
A list of coefficients from the WHO for various pairs of growth standards that are used to compute quantiles and z-scores. The format is a list, where each element is a pairing of variables, e.g. “wtkg_agedays”, “htcm_agedays”, “bmi_agedays”, “hcircm_agedays”, “muaccm_agedays”, “ss_agedays”, “tsftmm_agedays”, “wtkg_lencm”“wtkg_htcm”. Within each of these elements is a list for sex with names “Female” and “Male”.
</p>
<h4>
Source
</h4>
<p class="rd-p">
0-5 years: <a href = http://www.who.int/childgrowth/software/en/>http://www.who.int/childgrowth/software/en/</a>
</p>
<p class="rd-p">
5-15 years: <a href = http://www.who.int/growthref/tools/en/>http://www.who.int/growthref/tools/en/</a>
</p>
<h4>
Examples
</h4>
<pre class="r"><code>head(who_coefs$htcm_age$Female$data)</code></pre>
<pre><code>##      x l       m       s loh
## 1858 0 1 49.1477 0.03790   L
## 1859 1 1 49.3166 0.03783   L
## 1860 2 1 49.4854 0.03776   L
## 1861 3 1 49.6543 0.03770   L
## 1862 4 1 49.8232 0.03763   L
## 1863 5 1 49.9921 0.03756   L</code></pre>
<h4>
See also
</h4>
<p><code><a href=#who_centile2value>who_centile2value</a></code>, <code><a href=#who_value2zscore>who_value2centile</a></code>, <code><a href=#who_centile2value>who_zscore2value</a></code>, <code><a href=#who_value2zscore>who_value2zscore</a></code></p>
</div>
<div id="ig_coefs" class="section level2">
<h2>ig_coefs</h2>
<a id="ig_coefs_alias"></a>
<h3>
List of INTERGROWTH birth standard coefficients
</h3>
<p class="rd-p">
A list of coefficients from the INTERGROWTH birth standard.
</p>
<h4>
Source
</h4>
<p class="rd-p">
<a href = https://intergrowth21.tghn.org>https://intergrowth21.tghn.org</a>
</p>
<h4>
References
</h4>
<p class="rd-p">
International standards for newborn weight, length, and head circumference by gestational age and sex: the Newborn Cross-Sectional Study of the INTERGROWTH-21st Project Villar, José et al. The Lancet, Volume 384, Issue 9946, 857-868
</p>
<h4>
Examples
</h4>
<pre class="r"><code>head(ig_coefs$hcircm$Female)</code></pre>
<pre><code>##    ga       mu    sigma       nu      tau
## 1 232 30.47791 1.303260 1.045915 20.97268
## 2 233 30.56873 1.295806 1.045915 20.97268
## 3 234 30.65829 1.288488 1.045915 20.97268
## 4 235 30.74660 1.281304 1.045915 20.97268
## 5 236 30.83370 1.274251 1.045915 20.97268
## 6 237 30.91959 1.267325 1.045915 20.97268</code></pre>
<h4>
See also
</h4>
<p><code><a href=#igb_zscore2value>igb_centile2value</a></code>, <code><a href=#igb_value2zscore>igb_value2centile</a></code>, <code><a href=#igb_zscore2value>igb_zscore2value</a></code>, <code><a href=#igb_value2zscore>igb_value2zscore</a></code></p>
</div>
<div id="ig_early_coefs" class="section level2">
<h2>ig_early_coefs</h2>
<a id="ig_early_coefs_alias"></a>
<h3>
List of INTERGROWTH very preterm birth standard coefficients
</h3>
<p class="rd-p">
A list of coefficients from the INTERGROWTH very preterm birth standard.
</p>
<h4>
Source
</h4>
<p class="rd-p">
<a href = https://intergrowth21.tghn.org>https://intergrowth21.tghn.org</a>
</p>
<h4>
References
</h4>
<p class="rd-p">
INTERGROWTH-21st very preterm size at birth reference charts. Lancet 2016 doi.org/10.1016/S0140-6736(16) 00384-6. Villar, José et al.
</p>
<h4>
Examples
</h4>
<pre class="r"><code>ig_early_coefs$hcircm$Female</code></pre>
<pre><code>## NULL</code></pre>
<h4>
See also
</h4>
<p><code><a href=#igb_zscore2value>igb_centile2value</a></code>, <code><a href=#igb_value2zscore>igb_value2centile</a></code>, <code><a href=#igb_zscore2value>igb_zscore2value</a></code>, <code><a href=#igb_value2zscore>igb_value2zscore</a></code></p>
</div>
<div id="hbgd_labels" class="section level2">
<h2>hbgd_labels</h2>
<a id="hbgd_labels_alias"></a>
<h3>
Labels for common variable names in hbgd data
</h3>
<p class="rd-p">
Labels for common variable names in hbgd data, used in <code><a href='get_data_attributes.html'>get_data_attributes</a></code> if labels are not explicitly provided.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>hbgd_labels</div></code></pre>
<h4>
See also
</h4>
<p><code><a href=#get_data_attributes>get_data_attributes</a></code></p>
</div>
<div id="hbgd_labels_df" class="section level2">
<h2>hbgd_labels_df</h2>
<a id="hbgd_labels_df_alias"></a>
<h3>
Labels for common variable names in hbgd data
</h3>
<p class="rd-p">
Labels for common variable names in hbgd data, used in <code><a href='get_data_attributes.html'>get_data_attributes</a></code> if labels are not explicitly provided.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>hbgd_labels_df</div></code></pre>
</div>
</div>
<div id="misc" class="section level1">
<h1>Misc</h1>
<div id="get_x_range" class="section level2">
<h2>get_x_range</h2>
<a id="get_x_range_alias"></a>
<h3>
Get the x-axis range across all subjects
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>get_x_range(dat, pad&nbsp;=&nbsp;0.07)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
object obtained from <code><a href=#fit_all_trajectories>fit_all_trajectories</a></code>
</dd>
<dt>
pad
</dt>
<dd class="rd-dd">
padding factor - this much space as a multiple of the span of the x range will be added to the min and max
</dd>
</dl>
</div>
<div id="grid_deriv" class="section level2">
<h2>grid_deriv</h2>
<a id="grid_deriv_alias"></a>
<h3>
Estimate derivative given a grid of points
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>grid_deriv(x, y)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
x variable (should be a regularly-spaced grid of points)
</dd>
<dt>
y
</dt>
<dd class="rd-dd">
y variable
</dd>
</dl>
</div>
<div id="get_agefreq" class="section level2">
<h2>get_agefreq</h2>
<a id="get_agefreq_alias"></a>
<h3>
Get age frequency
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>get_agefreq(dat, age_range&nbsp;=&nbsp;NULL)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
dat
</dt>
<dd class="rd-dd">
a longitudinal growth study dataset
</dd>
<dt>
age_range
</dt>
<dd class="rd-dd">
optional range to ….
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>agefreq &lt;- get_agefreq(cpp)
plot_agefreq(agefreq)</code></pre>
<div style="display: flex; width: 720px; height: 370px; overflow: hidden">
<div style="background: white; position: absolute; top: 0px, left: 0px; width: 720px; height: 370px;"></div>
<iframe class="widget-lazyload lazy-loading" width="720" height="370" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" sandbox="allow-forms allow-scripts allow-popups allow-same-origin allow-pointer-lock" data-src="lazy_widgets/f81810a64718770d371f05eb00e48734.html"></iframe>
</div>
</div>
<div id="log10_1" class="section level2">
<h2>log10_1</h2>
<a id="log10_1_alias"></a>
<h3>
log base 10 plus 1
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>log10_1(x)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
vector of data
</dd>
</dl>
</div>
<div id="exp10_1" class="section level2">
<h2>exp10_1</h2>
<a id="exp10_1_alias"></a>
<h3>
Inverse of log base 10 plus 1
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>exp10_1(x)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
vector of data
</dd>
</dl>
</div>
<div id="get_nadir" class="section level2">
<h2>get_nadir</h2>
<a id="get_nadir_alias"></a>
<h3>
Get nadir of z-scale growth trajectory
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>get_nadir(obj)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
obj
</dt>
<dd class="rd-dd">
object created from <code><a href=#fit_trajectory>fit_trajectory</a></code>
</dd>
</dl>
</div>
<div id="get_recovery" class="section level2">
<h2>get_recovery</h2>
<a id="get_recovery_alias"></a>
<h3>
Get recovery statistics of z-scale growth trajectory
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>get_recovery(obj, nadir&nbsp;=&nbsp;NULL, at&nbsp;=&nbsp;365.25 * 3)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
obj
</dt>
<dd class="rd-dd">
object created from <code><a href=#fit_trajectory>fit_trajectory</a></code>
</dd>
<dt>
nadir
</dt>
<dd class="rd-dd">
object created from <code><a href=#get_nadir>get_nadir</a></code> (if NULL, will be automatically generated)
</dd>
<dt>
at
</dt>
<dd class="rd-dd">
age (in days) at which to estimate recovery
</dd>
</dl>
</div>
</div>
<div id="unit-conversion" class="section level1">
<h1>Unit Conversion</h1>
<div id="unit-conversion-1" class="section level2">
<h2>Unit conversion</h2>
<a id="unit_conversion_alias"></a>
<h3>
Unit conversion utility functions
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>cm2in(x)</div>
<div>in2cm(x)</div>
<div>lb2kg(x)</div>
<div>kg2lb(x)</div>
<div>days2years(x)</div>
<div>years2days(x)</div>
<div>days2months(x)</div>
<div>months2days(x)</div>
<div>months2years(x)</div>
<div>years2months(x)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
value(s) to convert
</dd>
</dl>
</div>
</div>


      </div>
    </div>
  </div>

  <div id="footer">
    <div class="container">
      <div class="col-md-6">
                <p>&copy; Ryan Hafen, 2016</p>
              </div>
      <div class="col-md-6">
        <p class="pull-right">created with <a href="https://github.com/hafen/packagedocs">packagedocs</a>
                  </p>
      </div>
    </div>
  </div>

  
</body>
</html>
