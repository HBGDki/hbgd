<h1>Healthy birth, growth &amp; development</h1>

<p><strong>Authors:</strong> <a href="mailto:rhafen@gmail.com">Ryan Hafen</a> [aut, cre],<a href="mailto:craig.anderson@uts.edu.au">Craig Anderson</a> [ctb],<a href="mailto:schloerke@gmail.com">Barret Schloerke</a> [ctb]</p>
<p><strong>Version:</strong> 0.3.6</p>
<p><strong>License:</strong> MIT + file LICENSE</p>

<h4>Description</h4>
<p>A package for visual and analytical methods for the analysis of
longitudinal growth data.</p>

<h4>Depends</h4>
<p>
R (>= 3.1),
datadr (>= 0.8.1),
trelliscope (>= 0.9.2)</p>

<h4>Imports</h4>
<p>
dplyr,
lattice,
rbokeh (>= 0.5.0),
ggplot2,
mgcv,
MASS,
numDeriv,
gamlss.dist,
fda,
face (>= 0.1-2),
sitar (>= 1.0.3),
DT,
lme4,
nlme,
scales,
crayon,
stringdist</p>

<h4>Suggests</h4>
<p>
testthat,
packagedocs,
brokenstick (>= 0.49)</p>



  ```{r packagedocs_load_library, echo=FALSE}
  suppressWarnings(suppressMessages(
    library(hbgd,
      quietly = TRUE, warn.conflicts = FALSE, verbose = FALSE
    )
  ))
  ```
  

# HBGD package





## hbgd package

<a id="hbgd-package_alias"></a><h3>hbgd: Healthy Birth, Growth & Development</h3>

<p class="rd-p">A package for visual and analytical methods for the analysis of
longitudinal growth data.</p>

  <h4>Details</h4>

  <p class="rd-p"><a href = http://hbgdki.github.io/hbgd/>http://hbgdki.github.io/hbgd/</a></p>



<h4>Examples</h4>
```{r hbgd-package_id_1, eval = TRUE, lazy = TRUE }
help(package = "hbgd")

```

# Data Handling





## check_data

<a id="check_data_alias"></a><h3>Check a dataset to ensure it will be compatible with hbgd methods</h3>


<h4>Usage</h4>
<pre class="r"><code><div>check_data(dat, has_height&nbsp;=&nbsp;TRUE, has_weight&nbsp;=&nbsp;TRUE, has_hcir&nbsp;=&nbsp;TRUE)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">a data frame</dd>
  <dt>has_height</dt>
  <dd class="rd-dd">does this dataset contain anthropometric height data?</dd>
  <dt>has_weight</dt>
  <dd class="rd-dd">does this dataset contain anthropometric weight data?</dd>
  <dt>has_hcir</dt>
  <dd class="rd-dd">does this dataset contain anthropometric head circumference data?</dd>
</dl>


<h4>Examples</h4>
```{r check_data_id_2, eval = TRUE, lazy = TRUE }
check_data(cpp, has_hcir = FALSE)

smc <- brokenstick::smocc.hgtwgt
check_data(smc, has_hcir = FALSE)

names(smc)[2] <- "subjid"
names(smc)[5] <- "agedays"
smc$sex <- as.character(smc$sex)
smc$sex[smc$sex == "male"] <- "Male"
smc$sex[smc$sex == "female"] <- "Female"
names(smc)[10] <- "htcm"
names(smc)[11] <- "wtkg"

check_data(smc, has_hcir = FALSE)

names(smc)[12] <- "haz"
smc$waz <- who_wtkg2zscore(smc$agedays, smc$wtkg, smc$sex)
smc$agedays <- smc$agedays * 365.25

check_data(smc, has_hcir = FALSE)

```





## Get subject and time data

<a id="subjecttime_alias"></a><h3>Get subject-level or time-varying variables and rows of longitudinal data</h3>


<h4>Usage</h4>
<pre class="r"><code><div>get_subject_data(dat)</div>
<div>get_time_data(dat)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">data frame with longitudinal data</dd>
</dl>







## fix_height

<a id="fix_height_alias"></a><h3>Merge 'htcm' and 'lencm' into the 'htcm' variable</h3>


<h4>Usage</h4>
<pre class="r"><code><div>fix_height(dat)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">data</dd>
</dl>







## add_holdout_ind

<a id="add_holdout_ind_alias"></a><h3>Add indicator column for per-subject holdout</h3>


<h4>Usage</h4>
<pre class="r"><code><div>add_holdout_ind(dat, random&nbsp;=&nbsp;TRUE)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">data</dd>
  <dt>random</dt>
  <dd class="rd-dd">if TRUE, a random observation per subject will be designated as the holdout, if FALSE, the endpoint for each subject will be designated as the holdout</dd>
</dl>







## view_variables

<a id="view_variables_alias"></a><h3>View known hbgd variables</h3>


<h4>Usage</h4>
<pre class="r"><code><div>view_variables()</div></code></pre>







## get_data_attributes

<a id="get_data_attributes_alias"></a><h3>Infer and attach attributes to a longitudinal growth study dataset</h3>

<p class="rd-p">Infer attributes such as variable types of a longitudinal growth study and add as attributes to the dataset.</p>

<h4>Usage</h4>
<pre class="r"><code><div>get_data_attributes(dat, meta&nbsp;=&nbsp;NULL, study_meta&nbsp;=&nbsp;NULL)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">a longitudinal growth study dataset</dd>
  <dt>meta</dt>
  <dd class="rd-dd">a data frame of meta data about the variables (a row for each variable)</dd>
  <dt>study_meta</dt>
  <dd class="rd-dd">a single-row data frame or named list of meta data about the study (such as study description, etc.)</dd>
</dl>

  <h4>Details</h4>

  <p class="rd-p">attributes added:
- <code>subjectlevel_vars</code>: vector of names of subject-level variables
- <code>timevarying_vars</code>: vector of names of time-varying variables
- <code>time_vars</code>: vector of names of measures of age
- <code>var_summ</code>: data frame containing variable summaries with columns <code>variable</code>, <code>label</code>, <code>type</code>[subject id, time indicator, time-varying, constant], <code>n_unique</code>
- <code>subj_count</code>: data frame of counts of records for each subject with columns <code>subjid</code>, <code>n</code>
- <code>n_subj</code>: scalar containing total number of subjects
- <code>labels</code> named list of variable labels - either populated by matching names with a pre-set list of labels (see <code><a href=#hbgd_labels>hbgd_labels</a></code>) or from a list provided from the <code>meta</code> argument
- <code>study_meta</code>: data frame of meta data (if provided from the <code>study_meta</code> argument)
- <code>short_id</code>: scalar containing the short unique identifier for the study (if <code>study_meta</code> is provided)</p>



<h4>Examples</h4>
```{r get_data_attributes_id_7, eval = TRUE, lazy = TRUE }
cpp <- get_data_attributes(cpp)
str(attributes(cpp))

```

<h4>See also</h4>

<code><a href=#get_data_attributes>get_data_attributes</a></code>


# WHO Growth Standards





## generic centile/z-score to value

<a id="who_centile2value_alias"></a><h3>Convert WHO z-scores/centiles to anthro measurements (generic)</h3>

<p class="rd-p">Get values of a specified measurement for a given WHO centile/z-score and growth standard pair (e.g. length vs. age) and sex over a specified grid</p>

<h4>Usage</h4>
<pre class="r"><code><div>who_centile2value(x, p&nbsp;=&nbsp;50, x_var&nbsp;=&nbsp;"agedays", y_var&nbsp;=&nbsp;"htcm", sex&nbsp;=&nbsp;"Female", data&nbsp;=&nbsp;NULL)</div>
<div>who_zscore2value(x, z&nbsp;=&nbsp;0, y_var&nbsp;=&nbsp;"htcm", x_var&nbsp;=&nbsp;"agedays", sex&nbsp;=&nbsp;"Female", data&nbsp;=&nbsp;NULL)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>x</dt>
  <dd class="rd-dd">vector specifying the values of x over which to provide the centiles for y</dd>
  <dt>p</dt>
  <dd class="rd-dd">centile or vector of centiles at which to compute values (a number between 0 and 100 - 50 is median)</dd>
  <dt>x_var</dt>
  <dd class="rd-dd">x variable name (typically "agedays") - see details</dd>
  <dt>y_var</dt>
  <dd class="rd-dd">y variable name (typically "htcm" or "wtkg") that specifies which variable of values should be returned for the specified value of q - see details</dd>
  <dt>sex</dt>
  <dd class="rd-dd">"Male" or "Female"</dd>
  <dt>data</dt>
  <dd class="rd-dd">optional data frame that supplies any of the other variables provided to the function</dd>
  <dt>z</dt>
  <dd class="rd-dd">z-score or vector of z-scores at which to compute values</dd>
</dl>

  <h4>Details</h4>

  <p class="rd-p">for all supported pairings of <code>x_var</code> and <code>y_var</code>, type <code>names(who)</code></p>



<h4>Examples</h4>
```{r who_centile2value_id_8, eval = TRUE, lazy = TRUE }
# median height vs. age for females
x <- seq(0, 365, by = 7)
med <- who_centile2value(x)
plot(x, med, xlab = "age in days", ylab = "median female height (cm)")

# 99th percentile of weight vs. age for males from age 0 to 1461 days
dat <- data.frame(x = rep(seq(0, 1461, length = 100), 2),
  sex = rep(c("Male", "Female"), each = 100))
dat$p99 <- who_centile2value(x, p = 99, y_var = "wtkg", sex = sex, data = dat)
lattice::xyplot(kg2lb(p99) ~ days2years(x), groups = sex, data = dat,
  ylab = "99th percentile weight (pounds) for males",
  xlab = "age (years)", auto.key = TRUE)

```

<h4>See also</h4>

<code><a href=#who_value2zscore>who_value2centile</a></code>, <code><a href=#who_value2zscore>who_value2zscore</a></code>






## generic value to centile/z-score

<a id="who_value2zscore_alias"></a><h3>Convert anthro measurements to WHO z-scores/centiles (generic)</h3>

<p class="rd-p">Compute z-scores or centiles with respect to the WHO growth standard for given values of x vs. y (typically x is "agedays" and y is a measure like "htcm").</p>

<h4>Usage</h4>
<pre class="r"><code><div>who_value2zscore(x, y, x_var&nbsp;=&nbsp;"agedays", y_var&nbsp;=&nbsp;"htcm", sex&nbsp;=&nbsp;"Female", data&nbsp;=&nbsp;NULL)</div>
<div>who_value2centile(x, y, x_var&nbsp;=&nbsp;"agedays", y_var&nbsp;=&nbsp;"htcm", sex&nbsp;=&nbsp;"Female", data&nbsp;=&nbsp;NULL)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>x</dt>
  <dd class="rd-dd">value or vector of values that correspond to a measure defined by <code>x_var</code></dd>
  <dt>y</dt>
  <dd class="rd-dd">value or vector of values that correspond to a measure defined by <code>y_var</code></dd>
  <dt>x_var</dt>
  <dd class="rd-dd">x variable name (typically "agedays") - see details</dd>
  <dt>y_var</dt>
  <dd class="rd-dd">y variable name (typically "htcm" or "wtkg") - see details</dd>
  <dt>sex</dt>
  <dd class="rd-dd">"Male" or "Female"</dd>
  <dt>data</dt>
  <dd class="rd-dd">optional data frame that supplies any of the other variables provided to the function</dd>
</dl>

  <h4>Details</h4>

  <p class="rd-p">for all supported pairings of <code>x_var</code> and <code>y_var</code>, type <code>names(who)</code></p>



<h4>Examples</h4>
```{r who_value2zscore_id_9, eval = TRUE, lazy = TRUE }
# z-scores
who_value2zscore(1670, in2cm(44))
who_value2zscore(1670, lb2kg(48), y_var = "wtkg")

who_value2centile(1670, in2cm(44))
who_value2centile(1670, lb2kg(48), y_var = "wtkg")

# add haz derived from WHO data and compare to that provided with data
cpp$haz2 <- who_value2zscore(x = agedays,  y = lencm, sex = sex, data = cpp)
plot(cpp$haz, cpp$haz2)

# note that you can also do it this way
#' cpp$haz2 <- who_value2zscore(cpp$agedays, cpp$lencm, sex = cpp$sex)

```

<h4>See also</h4>

<code><a href=#who_centile2value>who_centile2value</a></code>, <code><a href=#who_centile2value>who_zscore2value</a></code>






## specific centile/z-score to value

<a id="who_zscore2var_alias"></a><h3>Convert WHO z-scores/centiles to anthro measurements</h3>


<h4>Usage</h4>
<pre class="r"><code><div>who_zscore2htcm(agedays, z&nbsp;=&nbsp;0, sex&nbsp;=&nbsp;"Female")</div>
<div>who_zscore2wtkg(agedays, z&nbsp;=&nbsp;0, sex&nbsp;=&nbsp;"Female")</div>
<div>who_zscore2bmi(agedays, z&nbsp;=&nbsp;0, sex&nbsp;=&nbsp;"Female")</div>
<div>who_zscore2hcircm(agedays, z&nbsp;=&nbsp;0, sex&nbsp;=&nbsp;"Female")</div>
<div>who_zscore2muaccm(agedays, z&nbsp;=&nbsp;0, sex&nbsp;=&nbsp;"Female")</div>
<div>who_zscore2ssftmm(agedays, z&nbsp;=&nbsp;0, sex&nbsp;=&nbsp;"Female")</div>
<div>who_zscore2tsftmm(agedays, z&nbsp;=&nbsp;0, sex&nbsp;=&nbsp;"Female")</div>
<div>who_centile2htcm(agedays, p&nbsp;=&nbsp;50, sex&nbsp;=&nbsp;"Female")</div>
<div>who_centile2wtkg(agedays, p&nbsp;=&nbsp;50, sex&nbsp;=&nbsp;"Female")</div>
<div>who_centile2bmi(agedays, p&nbsp;=&nbsp;50, sex&nbsp;=&nbsp;"Female")</div>
<div>who_centile2hcircm(agedays, p&nbsp;=&nbsp;50, sex&nbsp;=&nbsp;"Female")</div>
<div>who_centile2muaccm(agedays, p&nbsp;=&nbsp;50, sex&nbsp;=&nbsp;"Female")</div>
<div>who_centile2ssftmm(agedays, p&nbsp;=&nbsp;50, sex&nbsp;=&nbsp;"Female")</div>
<div>who_centile2tsftmm(agedays, p&nbsp;=&nbsp;50, sex&nbsp;=&nbsp;"Female")</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>agedays</dt>
  <dd class="rd-dd">age in days</dd>
  <dt>z</dt>
  <dd class="rd-dd">z-score(s) to convert</dd>
  <dt>sex</dt>
  <dd class="rd-dd">"Male" or "Female"</dd>
  <dt>p</dt>
  <dd class="rd-dd">centile(s) to convert (must be between 0 and 100)</dd>
</dl>


<h4>Examples</h4>
```{r who_zscore2var_id_10, eval = TRUE, lazy = TRUE }
htcm <- who_zscore2htcm(cpp$agedays, cpp$haz, cpp$sex)

```





## specific value to centile/z-score

<a id="who_var2zscore_alias"></a><h3>Convert anthro measurements to WHO z-scores/centiles</h3>


<h4>Usage</h4>
<pre class="r"><code><div>who_wtkg2zscore(agedays, wtkg, sex&nbsp;=&nbsp;"Female")</div>
<div>who_htcm2zscore(agedays, htcm, sex&nbsp;=&nbsp;"Female")</div>
<div>who_bmi2zscore(agedays, bmi, sex&nbsp;=&nbsp;"Female")</div>
<div>who_hcircm2zscore(agedays, hcircm, sex&nbsp;=&nbsp;"Female")</div>
<div>who_muaccm2zscore(agedays, muaccm, sex&nbsp;=&nbsp;"Female")</div>
<div>who_ssftmm2zscore(agedays, ssftmm, sex&nbsp;=&nbsp;"Female")</div>
<div>who_tsftmm2zscore(agedays, tsftmm, sex&nbsp;=&nbsp;"Female")</div>
<div>who_wtkg2centile(agedays, wtkg, sex&nbsp;=&nbsp;"Female")</div>
<div>who_htcm2centile(agedays, htcm, sex&nbsp;=&nbsp;"Female")</div>
<div>who_bmi2centile(agedays, bmi, sex&nbsp;=&nbsp;"Female")</div>
<div>who_hcircm2centile(agedays, hcircm, sex&nbsp;=&nbsp;"Female")</div>
<div>who_muaccm2centile(agedays, muaccm, sex&nbsp;=&nbsp;"Female")</div>
<div>who_ssftmm2centile(agedays, ssftmm, sex&nbsp;=&nbsp;"Female")</div>
<div>who_tsftmm2centile(agedays, tsftmm, sex&nbsp;=&nbsp;"Female")</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>agedays</dt>
  <dd class="rd-dd">age in days</dd>
  <dt>wtkg</dt>
  <dd class="rd-dd">weight (kg) measurement(s) to convert</dd>
  <dt>sex</dt>
  <dd class="rd-dd">"Male" or "Female"</dd>
  <dt>htcm</dt>
  <dd class="rd-dd">height(cm) measurement(s) to convert</dd>
  <dt>bmi</dt>
  <dd class="rd-dd">body-mass index measurement(s) to convert</dd>
  <dt>hcircm</dt>
  <dd class="rd-dd">head circumference (cm) measurement(s) to convert</dd>
  <dt>muaccm</dt>
  <dd class="rd-dd">mid-upper arm circumference (cm) measurement(s) to convert</dd>
  <dt>ssftmm</dt>
  <dd class="rd-dd">subscalpular skinfold (mm) measurement(s) to convert</dd>
  <dt>tsftmm</dt>
  <dd class="rd-dd">triceps skinfold (mm) measurement(s) to convert</dd>
</dl>


<h4>Examples</h4>
```{r who_var2zscore_id_11, eval = TRUE, lazy = TRUE }
haz <- who_htcm2zscore(cpp$agedays, cpp$htcm, cpp$sex)

```

# Intergrowth Birth Standards





## generic centile/z-score to value

<a id="igb_zscore2value_alias"></a><h3>Convert birth measurements to INTERGROWTH z-scores/centiles (generic)</h3>


<h4>Usage</h4>
<pre class="r"><code><div>igb_centile2value(gagebrth, p&nbsp;=&nbsp;50, var&nbsp;=&nbsp;"lencm", sex&nbsp;=&nbsp;"Female")</div>
<div>igb_zscore2value(gagebrth, z&nbsp;=&nbsp;0, var&nbsp;=&nbsp;"lencm", sex&nbsp;=&nbsp;"Female")</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>gagebrth</dt>
  <dd class="rd-dd">gestational age at birth in days</dd>
  <dt>p</dt>
  <dd class="rd-dd">centile(s) to convert (must be between 0 and 100)</dd>
  <dt>var</dt>
  <dd class="rd-dd">the name of the measurement to convert ("lencm", "wtkg", "hcircm")</dd>
  <dt>sex</dt>
  <dd class="rd-dd">"Male" or "Female"</dd>
  <dt>z</dt>
  <dd class="rd-dd">z-score(s) to convert</dd>
</dl>

  <h4>Note</h4>

  <p class="rd-p">For gestational ages between 24 and 33 weeks, the INTERGROWTH very early preterm standard is used.</p>


  <h4>References</h4>

  <p class="rd-p">International standards for newborn weight, length, and head circumference by gestational age and sex: the Newborn Cross-Sectional Study of the INTERGROWTH-21st Project
Villar, José et al.
The Lancet, Volume 384, Issue 9946, 857-868</p>

  <p class="rd-p">INTERGROWTH-21st very preterm size at birth reference charts. Lancet  2016 doi.org/10.1016/S0140-6736(16) 00384-6.
Villar, José et al.</p>



<h4>Examples</h4>
```{r igb_zscore2value_id_12, eval = TRUE, lazy = TRUE }
# get 99th centile for Male birth weights across some gestational ages
igb_centile2value(232:300, 99, var = "wtkg", sex = "Male")

```





## generic value to centile/z-score

<a id="igb_value2zscore_alias"></a><h3>Convert birth measurements to INTERGROWTH z-scores/centiles (generic)</h3>


<h4>Usage</h4>
<pre class="r"><code><div>igb_value2centile(gagebrth, val, var&nbsp;=&nbsp;"lencm", sex&nbsp;=&nbsp;"Female")</div>
<div>igb_value2zscore(gagebrth, val, var&nbsp;=&nbsp;"lencm", sex&nbsp;=&nbsp;"Female")</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>gagebrth</dt>
  <dd class="rd-dd">gestational age at birth in days</dd>
  <dt>val</dt>
  <dd class="rd-dd">the value(s) of the anthro measurement to convert</dd>
  <dt>var</dt>
  <dd class="rd-dd">the name of the measurement to convert ("lencm", "wtkg", "hcircm")</dd>
  <dt>sex</dt>
  <dd class="rd-dd">"Male" or "Female"</dd>
</dl>

  <h4>Note</h4>

  <p class="rd-p">For gestational ages between 24 and 33 weeks, the INTERGROWTH very early preterm standard is used.</p>


  <h4>References</h4>

  <p class="rd-p">International standards for newborn weight, length, and head circumference by gestational age and sex: the Newborn Cross-Sectional Study of the INTERGROWTH-21st Project
Villar, José et al.
The Lancet, Volume 384, Issue 9946, 857-868</p>

  <p class="rd-p">INTERGROWTH-21st very preterm size at birth reference charts. Lancet  2016 doi.org/10.1016/S0140-6736(16) 00384-6.
Villar, José et al.</p>



<h4>Examples</h4>
```{r igb_value2zscore_id_13, eval = TRUE, lazy = TRUE }
# get Male birth length z-scores
# first we need just 1 record per subject with subject-level data
cppsubj <- get_subject_data(cpp)
cppsubj <- subset(cppsubj, sex == "Male")
igb_value2zscore(cpp$gagebrth, cpp$birthlen, var = "lencm", sex = "Male")

```





## specific centile/z-score to value

<a id="igb_zscore2var_alias"></a><h3>Convert INTERGROWTH z-scores/centiles to birth measurements</h3>


<h4>Usage</h4>
<pre class="r"><code><div>igb_zscore2lencm(gagebrth, z&nbsp;=&nbsp;0, sex&nbsp;=&nbsp;"Female")</div>
<div>igb_zscore2wtkg(gagebrth, z&nbsp;=&nbsp;0, sex&nbsp;=&nbsp;"Female")</div>
<div>igb_zscore2hcircm(gagebrth, z&nbsp;=&nbsp;0, sex&nbsp;=&nbsp;"Female")</div>
<div>igb_centile2lencm(gagebrth, p&nbsp;=&nbsp;50, sex&nbsp;=&nbsp;"Female")</div>
<div>igb_centile2wtkg(gagebrth, p&nbsp;=&nbsp;50, sex&nbsp;=&nbsp;"Female")</div>
<div>igb_centile2hcircm(gagebrth, p&nbsp;=&nbsp;50, sex&nbsp;=&nbsp;"Female")</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>gagebrth</dt>
  <dd class="rd-dd">gestational age at birth in days</dd>
  <dt>z</dt>
  <dd class="rd-dd">z-score(s) to convert</dd>
  <dt>sex</dt>
  <dd class="rd-dd">"Male" or "Female"</dd>
  <dt>p</dt>
  <dd class="rd-dd">centile(s) to convert (must be between 0 and 100)</dd>
</dl>

  <h4>Note</h4>

  <p class="rd-p">For gestational ages between 24 and 33 weeks, the INTERGROWTH very early preterm standard is used.</p>


  <h4>References</h4>

  <p class="rd-p">International standards for newborn weight, length, and head circumference by gestational age and sex: the Newborn Cross-Sectional Study of the INTERGROWTH-21st Project
Villar, José et al.
The Lancet, Volume 384, Issue 9946, 857-868</p>

  <p class="rd-p">INTERGROWTH-21st very preterm size at birth reference charts. Lancet  2016 doi.org/10.1016/S0140-6736(16) 00384-6.
Villar, José et al.</p>



<h4>Examples</h4>
```{r igb_zscore2var_id_14, eval = TRUE, lazy = TRUE }
# get 99th centile for Male birth weights across some gestational ages
igb_centile2wtkg(168:300, 99, sex = "Male")

# recreate figure from preterm paper
d <- expand.grid(centile = c(3, 50, 97), gage = 168:300)
d$value <- igb_centile2lencm(d$gage, d$centile, sex = "Male")
lattice::xyplot(value ~ gage / 7, groups = centile, data = d, type = "l")

```





## specific value to centile/z-score

<a id="igb_var2zscore_alias"></a><h3>Convert birth measurements to INTERGROWTH z-scores/centiles</h3>


<h4>Usage</h4>
<pre class="r"><code><div>igb_lencm2zscore(gagebrth, lencm, sex&nbsp;=&nbsp;"Female")</div>
<div>igb_wtkg2zscore(gagebrth, wtkg, sex&nbsp;=&nbsp;"Female")</div>
<div>igb_hcircm2zscore(gagebrth, hcircm, sex&nbsp;=&nbsp;"Female")</div>
<div>igb_lencm2centile(gagebrth, lencm, sex&nbsp;=&nbsp;"Female")</div>
<div>igb_wtkg2centile(gagebrth, wtkg, sex&nbsp;=&nbsp;"Female")</div>
<div>igb_hcircm2centile(gagebrth, hcircm, sex&nbsp;=&nbsp;"Female")</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>gagebrth</dt>
  <dd class="rd-dd">gestational age at birth in days</dd>
  <dt>lencm</dt>
  <dd class="rd-dd">length(cm) measurement(s) to convert</dd>
  <dt>sex</dt>
  <dd class="rd-dd">"Male" or "Female"</dd>
  <dt>wtkg</dt>
  <dd class="rd-dd">weight (kg) measurement(s) to convert</dd>
  <dt>hcircm</dt>
  <dd class="rd-dd">head circumference (cm) measurement(s) to convert</dd>
</dl>

  <h4>Note</h4>

  <p class="rd-p">For gestational ages between 24 and 33 weeks, the INTERGROWTH very early preterm standard is used.</p>


  <h4>References</h4>

  <p class="rd-p">International standards for newborn weight, length, and head circumference by gestational age and sex: the Newborn Cross-Sectional Study of the INTERGROWTH-21st Project
Villar, José et al.
The Lancet, Volume 384, Issue 9946, 857-868</p>

  <p class="rd-p">INTERGROWTH-21st very preterm size at birth reference charts. Lancet  2016 doi.org/10.1016/S0140-6736(16) 00384-6.
Villar, José et al.</p>



<h4>Examples</h4>
```{r igb_var2zscore_id_15, eval = TRUE, lazy = TRUE }
# get Male birth length z-scores
# first we need just 1 record per subject with subject-level data
cppsubj <- get_subject_data(cpp)
cppsubj <- subset(cppsubj, sex == "Male")
igb_lencm2zscore(cpp$gagebrth, cpp$birthlen, sex = "Male")

```

# Intergrowth Fetal Standards





## generic centile/z-score to value

<a id="igfet_zscore2value_alias"></a><h3>Convert INTERGROWTH z-scores/centiles to fetal ultrasound measurements (generic)</h3>


<h4>Usage</h4>
<pre class="r"><code><div>igfet_zscore2value(gagedays, z&nbsp;=&nbsp;0, var&nbsp;=&nbsp;c("hccm", "bpdcm", "ofdcm", "accm", "flcm"))</div>
<div>igfet_centile2value(gagedays, p&nbsp;=&nbsp;50, var&nbsp;=&nbsp;c("hccm", "bpdcm", "ofdcm", "accm", "flcm"))</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>gagedays</dt>
  <dd class="rd-dd">gestational age in days</dd>
  <dt>z</dt>
  <dd class="rd-dd">z-score(s) to convert</dd>
  <dt>var</dt>
  <dd class="rd-dd">the name of the measurement to convert ("hccm", "bpdcm", "ofdcm", "accm", "flcm")</dd>
  <dt>p</dt>
  <dd class="rd-dd">centile(s) to convert (must be between 0 and 100)</dd>
</dl>

  <h4>References</h4>

  <p class="rd-p">International standards for fetal growth based on serial ultrasound measurements: the Fetal Growth Longitudinal Study of the INTERGROWTH-21st Project
Papageorghiou, Aris T et al.
The Lancet, Volume 384, Issue 9946, 869-879</p>



<h4>Examples</h4>
```{r igfet_zscore2value_id_16, eval = TRUE, lazy = TRUE }
# get value for median head circumference for child at 100 gestational days
igfet_centile2value(100, 50, var = "hccm")

```





## generic value to centile/z-score

<a id="igfet_value2zscore_alias"></a><h3>Convert fetal ultrasound measurements to INTERGROWTH z-scores/centiles (generic)</h3>


<h4>Usage</h4>
<pre class="r"><code><div>igfet_value2zscore(gagedays, val, var&nbsp;=&nbsp;c("hccm", "bpdcm", "ofdcm", "accm", "flcm"))</div>
<div>igfet_value2centile(gagedays, val, var&nbsp;=&nbsp;c("hccm", "bpdcm", "ofdcm", "accm", "flcm"))</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>gagedays</dt>
  <dd class="rd-dd">gestational age in days</dd>
  <dt>val</dt>
  <dd class="rd-dd">the value(s) of the anthro measurement to convert</dd>
  <dt>var</dt>
  <dd class="rd-dd">the name of the measurement to convert ("hccm", "bpdcm", "ofdcm", "accm", "flcm")</dd>
</dl>

  <h4>References</h4>

  <p class="rd-p">International standards for fetal growth based on serial ultrasound measurements: the Fetal Growth Longitudinal Study of the INTERGROWTH-21st Project
Papageorghiou, Aris T et al.
The Lancet, Volume 384, Issue 9946, 869-879</p>



<h4>Examples</h4>
```{r igfet_value2zscore_id_17, eval = TRUE, lazy = TRUE }
# get centile for child at 100 gestational days with 11 cm head circumference
igfet_hccm2centile(100, 11)

```





## specific centile/z-score to value

<a id="igfet_zscore2var_alias"></a><h3>Convert INTERGROWTH z-scores/centiles to fetal ultrasound measurements</h3>


<h4>Usage</h4>
<pre class="r"><code><div>igfet_zscore2hccm(gagedays, z&nbsp;=&nbsp;0)</div>
<div>igfet_zscore2bpdcm(gagedays, z&nbsp;=&nbsp;0)</div>
<div>igfet_zscore2ofdcm(gagedays, z&nbsp;=&nbsp;0)</div>
<div>igfet_zscore2accm(gagedays, z&nbsp;=&nbsp;0)</div>
<div>igfet_zscore2flcm(gagedays, z&nbsp;=&nbsp;0)</div>
<div>igfet_centile2hccm(gagedays, p&nbsp;=&nbsp;50)</div>
<div>igfet_centile2bpdcm(gagedays, p&nbsp;=&nbsp;50)</div>
<div>igfet_centile2ofdcm(gagedays, p&nbsp;=&nbsp;50)</div>
<div>igfet_centile2accm(gagedays, p&nbsp;=&nbsp;50)</div>
<div>igfet_centile2flcm(gagedays, p&nbsp;=&nbsp;50)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>gagedays</dt>
  <dd class="rd-dd">gestational age in days</dd>
  <dt>z</dt>
  <dd class="rd-dd">z-score(s) to convert</dd>
  <dt>p</dt>
  <dd class="rd-dd">centile(s) to convert (must be between 0 and 100)</dd>
</dl>

  <h4>References</h4>

  <p class="rd-p">International standards for fetal growth based on serial ultrasound measurements: the Fetal Growth Longitudinal Study of the INTERGROWTH-21st Project
Papageorghiou, Aris T et al.
The Lancet, Volume 384, Issue 9946, 869-879</p>



<h4>Examples</h4>
```{r igfet_zscore2var_id_18, eval = TRUE, lazy = TRUE }
# get value for median head circumference for child at 100 gestational days
igfet_centile2hccm(100, 50)

```





## specific value to centile/z-score

<a id="igfet_var2zscore_alias"></a><h3>Convert fetal ultrasound measurements to INTERGROWTH z-scores/centiles</h3>


<h4>Usage</h4>
<pre class="r"><code><div>igfet_hccm2zscore(gagedays, hccm)</div>
<div>igfet_bpdcm2zscore(gagedays, bpdcm)</div>
<div>igfet_ofdcm2zscore(gagedays, ofdcm)</div>
<div>igfet_accm2zscore(gagedays, accm)</div>
<div>igfet_flcm2zscore(gagedays, flcm)</div>
<div>igfet_hccm2centile(gagedays, hccm)</div>
<div>igfet_bpdcm2centile(gagedays, bpdcm)</div>
<div>igfet_ofdcm2centile(gagedays, ofdcm)</div>
<div>igfet_accm2centile(gagedays, accm)</div>
<div>igfet_flcm2centile(gagedays, flcm)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>gagedays</dt>
  <dd class="rd-dd">gestational age in days</dd>
  <dt>hccm</dt>
  <dd class="rd-dd">head circumference (cm) measurement(s) to convert</dd>
  <dt>bpdcm</dt>
  <dd class="rd-dd">biparietel diameter (cm) measurement(s) to convert</dd>
  <dt>ofdcm</dt>
  <dd class="rd-dd">occipito-frontal diameter (cm) measurement(s) to convert</dd>
  <dt>accm</dt>
  <dd class="rd-dd">abdominal circumference (cm) measurement(s) to convert</dd>
  <dt>flcm</dt>
  <dd class="rd-dd">femur length (cm) measurement(s) to convert</dd>
</dl>

  <h4>References</h4>

  <p class="rd-p">International standards for fetal growth based on serial ultrasound measurements: the Fetal Growth Longitudinal Study of the INTERGROWTH-21st Project
Papageorghiou, Aris T et al.
The Lancet, Volume 384, Issue 9946, 869-879</p>



<h4>Examples</h4>
```{r igfet_var2zscore_id_19, eval = TRUE, lazy = TRUE }
# get centile for child at 100 gestational days with 11 cm head circumference
igfet_hccm2centile(100, 11)

```

# Growth Standard Vis





## Growth standard methods

<a id="plot_growth_alias"></a><h3>Utility functions for adding growth standard bands to rbokeh/lattice/ggplot2 plots</h3>


<h4>Usage</h4>
<pre class="r"><code><div>panel.who(x, x_var&nbsp;=&nbsp;"agedays", y_var&nbsp;=&nbsp;"htcm", sex&nbsp;=&nbsp;"Female", p&nbsp;=&nbsp;c(1, 5, 25, 50), color&nbsp;=&nbsp;NULL, alpha&nbsp;=&nbsp;0.15, center&nbsp;=&nbsp;FALSE, labels&nbsp;=&nbsp;TRUE, x_trans&nbsp;=&nbsp;identity, y_trans&nbsp;=&nbsp;identity)</div>
<div>panel.igb(gagebrth, var&nbsp;=&nbsp;"lencm", sex&nbsp;=&nbsp;"Female", p&nbsp;=&nbsp;c(1, 5, 25, 50), color&nbsp;=&nbsp;NULL, alpha&nbsp;=&nbsp;0.15, center&nbsp;=&nbsp;FALSE, labels&nbsp;=&nbsp;TRUE, x_trans&nbsp;=&nbsp;identity, y_trans&nbsp;=&nbsp;identity)</div>
<div>panel.igfet(gagedays, var&nbsp;=&nbsp;"hccm", p&nbsp;=&nbsp;c(1, 5, 25, 50), color&nbsp;=&nbsp;"green", alpha&nbsp;=&nbsp;0.15, center&nbsp;=&nbsp;FALSE, labels&nbsp;=&nbsp;TRUE, x_trans&nbsp;=&nbsp;identity, y_trans&nbsp;=&nbsp;identity)</div>
<div>geom_growthstandard(mapping&nbsp;=&nbsp;NULL, data&nbsp;=&nbsp;NULL, x_seq, x_var&nbsp;=&nbsp;"agedays", y_var, sex&nbsp;=&nbsp;"Female", p&nbsp;=&nbsp;c(1, 5, 25, 50), shade&nbsp;=&nbsp;NULL, alpha&nbsp;=&nbsp;0.15, center&nbsp;=&nbsp;FALSE, x_trans&nbsp;=&nbsp;identity, y_trans&nbsp;=&nbsp;identity, standard&nbsp;=&nbsp;"who", inherit.aes&nbsp;=&nbsp;TRUE)</div>
<div>geom_who(...)</div>
<div>geom_igb(..., var&nbsp;=&nbsp;"lencm")</div>
<div>geom_igfet(..., var&nbsp;=&nbsp;"hccm", color&nbsp;=&nbsp;"green")</div>
<div>ly_who(fig, x, x_var&nbsp;=&nbsp;"agedays", y_var&nbsp;=&nbsp;"htcm", sex&nbsp;=&nbsp;"Female", p&nbsp;=&nbsp;c(1, 5, 25, 50), color&nbsp;=&nbsp;NULL, alpha&nbsp;=&nbsp;0.15, center&nbsp;=&nbsp;FALSE, labels&nbsp;=&nbsp;TRUE, x_trans&nbsp;=&nbsp;identity, y_trans&nbsp;=&nbsp;identity, x_units&nbsp;=&nbsp;c("days", "months", "years"))</div>
<div>ly_igb(fig, gagebrth, var&nbsp;=&nbsp;"lencm", sex&nbsp;=&nbsp;"Female", p&nbsp;=&nbsp;c(1, 5, 25, 50), color&nbsp;=&nbsp;NULL, alpha&nbsp;=&nbsp;0.15, center&nbsp;=&nbsp;FALSE, labels&nbsp;=&nbsp;TRUE, x_trans&nbsp;=&nbsp;identity, y_trans&nbsp;=&nbsp;identity)</div>
<div>ly_igfet(fig, gagedays, var&nbsp;=&nbsp;"hccm", p&nbsp;=&nbsp;c(1, 5, 25, 50), color&nbsp;=&nbsp;"green", alpha&nbsp;=&nbsp;0.15, center&nbsp;=&nbsp;FALSE, labels&nbsp;=&nbsp;TRUE, x_trans&nbsp;=&nbsp;identity, y_trans&nbsp;=&nbsp;identity)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>x, x_seq</dt>
  <dd class="rd-dd">value or vector of values that correspond to a measure defined by <code>x_var</code>. <code>x_seq</code> is used with geom_*</dd>
  <dt>x_var</dt>
  <dd class="rd-dd">x variable name (typically "agedays")</dd>
  <dt>y_var</dt>
  <dd class="rd-dd">y variable name (typically "htcm" or "wtkg")</dd>
  <dt>sex</dt>
  <dd class="rd-dd">"Male" or "Female"</dd>
  <dt>p</dt>
  <dd class="rd-dd">centiles at which to draw the growth standard band polygons (only need to specify on one side of the median)</dd>
  <dt>color, shade</dt>
  <dd class="rd-dd">optional color to use for bands (will use <code>sex</code> to determine if not specified). <code>shade</code> is used with geom_*</dd>
  <dt>alpha</dt>
  <dd class="rd-dd">transparency of the bands</dd>
  <dt>center</dt>
  <dd class="rd-dd">should the bands be centered around the median?</dd>
  <dt>labels</dt>
  <dd class="rd-dd">should the centiles be labeled? (not implemented)</dd>
  <dt>x_trans</dt>
  <dd class="rd-dd">transformation function to be applied to x-axis</dd>
  <dt>y_trans</dt>
  <dd class="rd-dd">transformation function to be applied to y-axis</dd>
  <dt>gagebrth</dt>
  <dd class="rd-dd">gestational age at birth in days (for igb plots)</dd>
  <dt>var</dt>
  <dd class="rd-dd">variable name for y axis for igb or igfet plots ("lencm", "wtkg", or "hcircm" for igb; "accm", "bpdcm", "flcm", "hccm", or "ofdcm" for igfet)</dd>
  <dt>gagedays</dt>
  <dd class="rd-dd">gestational age in days (for igfet plots)</dd>
  <dt>data, mapping, inherit.aes</dt>
  <dd class="rd-dd">supplied direclty to <code>ggplot2::layer</code></dd>
  <dt>standard</dt>
  <dd class="rd-dd">standard name to use.  Either <code>"who"</code>, <code>"igb"</code>, or <code>"igfet"</code></dd>
  <dt>...</dt>
  <dd class="rd-dd">items supplied direclty to <code>geom_growthstandard</code></dd>
  <dt>fig</dt>
  <dd class="rd-dd">rbokeh figure to add growth standard to</dd>
  <dt>x_units</dt>
  <dd class="rd-dd">units of age x-axis (days, months, or years)</dd>
</dl>


<h4>Examples</h4>
```{r plot_growth_id_20, eval = TRUE, lazy = TRUE }
## Not run: 
# #### rbokeh
# 
# library(rbokeh)
# figure() %>%
#   ly_who(x = seq(0, 2558, by = 30), y_var = "wtkg",
#     x_trans = days2years, sex = "Male") %>%
#   ly_points(days2years(agedays), wtkg,
#     data = subset(cpp, subjid == 8), col = "black",
#     hover = c(agedays, wtkg, lencm, htcm, bmi, geniq, sysbp, diabp))
# 
# cpp$wtkg50 <- who_centile2value(cpp$agedays, y_var = "wtkg")
# figure() %>%
#   ly_who(x = seq(0, 2558, by = 30), y_var = "wtkg", color = "blue",
#     x_trans = days2years, center = TRUE) %>%
#   ly_points(days2years(agedays), wtkg - wtkg50, color = "black",
#     data = subset(cpp, subjid == 8))
# 
# # look at Male birth lengths superposed on INTERGROWTH birth standard
# # first we need just 1 record per subject with subject-level data
# cppsubj <- get_subject_data(cpp)
# figure(xlab = "Gestational Age at Birth (days)", ylab = "Birth Length (cm)") %>%
#   ly_igb(gagebrth = 250:310, var = "lencm", sex = "Male") %>%
#   ly_points(jitter(gagebrth), birthlen, data = subset(cppsubj, sex == "Male"),
#     color = "black")
# 
# # plot growth standard bands at z=1, 2, 3 for fetal head circumference
# figure(xlab = "Gestational Age (days)",
#   ylab = "Head Circumference (cm)") %>%
#     ly_igfet(gagedays = 98:280, var = "hccm", p = pnorm(-3:0) * 100)
# ## End(Not run)

#### lattice

library(lattice)
xyplot(wtkg ~ agedays, data = subset(cpp, subjid == 8),
  panel = function(x, y, ...) {
    panel.who(x = seq(0, 2558, by = 30),
      sex = "Male", y_var = "wtkg", p = 100 * pnorm(-3:0))
    panel.xyplot(x, y, ...)
  },
  col = "black"
)

# look at Male birth lengths superposed on INTERGROWTH birth standard
# first we need just 1 record per subject with subject-level data
cppsubj <- get_subject_data(cpp)
xyplot(birthlen ~ jitter(gagebrth), data = subset(cppsubj, sex == "Male"),
  panel = function(x, y, ...) {
    panel.igb(gagebrth = 250:310, var = "lencm", sex = "Male")
    panel.points(x, y, ...)
  },
  col = "black", alpha = 0.75,
  xlab = "Gestational Age at Birth (days)", ylab = "Birth Length (cm)"
)

#### ggplot2

library(ggplot2)
p <- ggplot(data = subset(cpp, subjid == 8), aes(x = agedays, y = htcm)) +
  geom_who(x_seq = seq(0, 2600, by = 10), y_var = "htcm") +
  geom_point()

```





## z-score scale methods

<a id="plot_zband_alias"></a><h3>Utility functions for adding growth standard bands to rbokeh/lattice/ggplot2 plots</h3>


<h4>Usage</h4>
<pre class="r"><code><div>ly_zband(fig, x, z&nbsp;=&nbsp;-3:0, color&nbsp;=&nbsp;"green", alpha&nbsp;=&nbsp;0.15, x_units&nbsp;=&nbsp;c("days", "months", "years"))</div>
<div>panel.zband(x, z&nbsp;=&nbsp;-3:0, color&nbsp;=&nbsp;"green", alpha&nbsp;=&nbsp;0.25)</div>
<div>geom_zband(obj, x, z&nbsp;=&nbsp;-3:0, color&nbsp;=&nbsp;"green", alpha&nbsp;=&nbsp;0.25)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>fig</dt>
  <dd class="rd-dd">rbokeh figure to add z bands to</dd>
  <dt>x</dt>
  <dd class="rd-dd">range on x axis that should be covered by bands</dd>
  <dt>z</dt>
  <dd class="rd-dd">z-scores at which to draw bands (only need to specify on one side of zero)</dd>
  <dt>color</dt>
  <dd class="rd-dd">color to use for bands</dd>
  <dt>alpha</dt>
  <dd class="rd-dd">transparency of the bands</dd>
  <dt>x_units</dt>
  <dd class="rd-dd">units of age x-axis (days, months, or years)</dd>
  <dt>obj</dt>
  <dd class="rd-dd">ggplot2 object to add z bands to</dd>
</dl>


<h4>Examples</h4>
```{r plot_zband_id_21, eval = TRUE, lazy = TRUE }

## Not run: 
# library(rbokeh)
# figure() %>%
#   ly_zband(cpp$agedays) %>%
#   ly_points(jitter(agedays), haz, data = cpp, color = "black")
# 
# library(lattice)
# xyplot(haz ~ jitter(agedays), data = cpp,
#   panel = function(x, y, ...) {
#     panel.zband(x)
#     panel.xyplot(x, y, ...)
#   },
#   col = "black", alpha = 0.5
# )
# 
# library(ggplot2)
# p <- ggplot(data = cpp, aes(x = jitter(agedays), y = haz))
# geom_zband(p, x = seq(0, 2600, by = 10)) +
#   geom_point()
# ## End(Not run)

```

# Modeling





## get_fit

<a id="get_fit_alias"></a><h3>Obtain a trajectory "fit" object for a dataset</h3>


<h4>Usage</h4>
<pre class="r"><code><div>get_fit(dat, x_var&nbsp;=&nbsp;"agedays", y_var&nbsp;=&nbsp;"htcm", method&nbsp;=&nbsp;"fda", holdout&nbsp;=&nbsp;FALSE, x_trans&nbsp;=&nbsp;NULL, x_inv&nbsp;=&nbsp;NULL, y_trans&nbsp;=&nbsp;NULL, y_inv&nbsp;=&nbsp;NULL, ...)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">data frame containing variables to model</dd>
  <dt>x_var</dt>
  <dd class="rd-dd">name of x variable to model (default is "agedays")</dd>
  <dt>y_var</dt>
  <dd class="rd-dd">name of y variable to model (usually an anthropometric measure or z-score scaled anthropometric measure)</dd>
  <dt>method</dt>
  <dd class="rd-dd">name of fitting method to use (see <code><a href=#get_avail_methods>get_avail_methods</a></code>)</dd>
  <dt>holdout</dt>
  <dd class="rd-dd">should an observation be held out for fitting (will use column <code>hold</code> in <code>dat</code> to which observations to hold out)</dd>
  <dt>x_trans, y_trans</dt>
  <dd class="rd-dd">transformation functions to be applied to x and y prior to modeling</dd>
  <dt>x_inv, y_inv</dt>
  <dd class="rd-dd">inverse transformation functions for x and y to get back to the original scale after modeling</dd>
  <dt>...</dt>
  <dd class="rd-dd">parameters passed on to the fitting method</dd>
</dl>







## fit_trajectory

<a id="fit_trajectory_alias"></a><h3>Apply a model fit to an individual's trajectory</h3>


<h4>Usage</h4>
<pre class="r"><code><div>fit_trajectory(dat, fit, xg&nbsp;=&nbsp;NULL, checkpoints&nbsp;=&nbsp;365 * c(1:2), z_bins&nbsp;=&nbsp;-2)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">data frame containing variables for one subject to apply a fit to</dd>
  <dt>fit</dt>
  <dd class="rd-dd">an object returned from <code><a href=#get_fit>get_fit</a></code></dd>
  <dt>xg</dt>
  <dd class="rd-dd">grid of x points at which the fit should be evaluated for plotting (if <code>NULL</code> it will be set to an equally-spaced grid of 150 points across <code>x</code>)</dd>
  <dt>checkpoints</dt>
  <dd class="rd-dd">x values at which to compute "checkpoints" of the subjectss growth trajectory to compare to other subjects</dd>
  <dt>z_bins</dt>
  <dd class="rd-dd">a vector indicating binning of z-scores for the subjects trajectory at each checkpoint with respect to the the WHO growth standard</dd>
</dl>


<h4>Examples</h4>
```{r fit_trajectory_id_23, eval = TRUE, lazy = TRUE }
mod <- get_fit(cpp, y_var = "wtkg")
fit <- fit_trajectory(subset(cpp, subjid == 2), mod)
plot(fit$xy$x, fit$xy$y)
lines(fit$fitgrid$x, fit$fitgrid$y)
# there is also a plot method:
plot(fit, x_range = c(0, 2560))

# we can fit the z-scores instead
mod2 <- get_fit(cpp, y_var = "waz")
fit2 <- fit_trajectory(subset(cpp, subjid == 2), mod2)
plot(fit2$xy$x, fit2$xy$z)
lines(fit2$fitgrid$x, fit2$fitgrid$z)
# using the plot method
plot(fit2, x_range = c(0, 2560), center = TRUE)

```





## fit_all_trajectories

<a id="fit_all_trajectories_alias"></a><h3>Apply trajectory fitting to each subject in a dataset</h3>


<h4>Usage</h4>
<pre class="r"><code><div>fit_all_trajectories(dat, fit, xg&nbsp;=&nbsp;NULL, checkpoints&nbsp;=&nbsp;365 * c(1:2), z_bins&nbsp;=&nbsp;-2)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">a data frame containing data for several subjects or a ddf already divided by subject, as obtained from <code><a href=#by_subject>by_subject</a></code></dd>
  <dt>fit</dt>
  <dd class="rd-dd">an object returned from <code><a href=#get_fit>get_fit</a></code></dd>
  <dt>xg</dt>
  <dd class="rd-dd">grid of x points at which the fit should be evaluated for plotting (if <code>NULL</code> it will be set to an equally-spaced grid of 150 points across <code>x</code>)</dd>
  <dt>checkpoints</dt>
  <dd class="rd-dd">x values at which to compute "checkpoints" of the subjectss growth trajectory to compare to other subjects</dd>
  <dt>z_bins</dt>
  <dd class="rd-dd">a vector indicating binning of z-scores for the subjects trajectory at each checkpoint with respect to the the WHO growth standard</dd>
</dl>


<h4>Examples</h4>
```{r fit_all_trajectories_id_24, eval = TRUE, lazy = TRUE }
## Not run: 
# cppfit <- get_fit(cpp, y_var = "wtkg", method = "rlm")
# cpptr  <- fit_all_trajectories(cpp, cppfit)
# cpptr[[1]]
# plot(cpptr[[1]]$value)
# ## End(Not run)

```





## get_fit_holdout_mse

<a id="get_fit_holdout_mse_alias"></a><h3>Get MSE for holdout</h3>


<h4>Usage</h4>
<pre class="r"><code><div>get_fit_holdout_mse(d, z&nbsp;=&nbsp;TRUE)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>d</dt>
  <dd class="rd-dd">an object returned from <code><a href=#fit_all_trajectories>fit_all_trajectories</a></code></dd>
  <dt>z</dt>
  <dd class="rd-dd">compute MSE on z-score scale or original scale?</dd>
</dl>







## get_fit_holdout_errors

<a id="get_fit_holdout_errors_alias"></a><h3>Get holdout errors</h3>


<h4>Usage</h4>
<pre class="r"><code><div>get_fit_holdout_errors(d, z&nbsp;=&nbsp;TRUE)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>d</dt>
  <dd class="rd-dd">an object returned from <code><a href=#fit_all_trajectories>fit_all_trajectories</a></code></dd>
  <dt>z</dt>
  <dd class="rd-dd">compute MSE on z-score scale or original scale?</dd>
</dl>







## plot.fittedTrajectory

<a id="plot.fittedTrajectory_alias"></a><h3>Plot a fitted trajectory</h3>


<h4>Usage</h4>
<pre class="r"><code><div>"plot"(x, center&nbsp;=&nbsp;FALSE, x_range&nbsp;=&nbsp;NULL, width&nbsp;=&nbsp;500, height&nbsp;=&nbsp;520, hover&nbsp;=&nbsp;NULL, checkpoints&nbsp;=&nbsp;TRUE, p&nbsp;=&nbsp;100 * pnorm(-3:0), x_units&nbsp;=&nbsp;c("days", "months", "years"), ...)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>x</dt>
  <dd class="rd-dd">an object returned from <code><a href=#fit_trajectory>fit_trajectory</a></code></dd>
  <dt>center</dt>
  <dd class="rd-dd">should the trajectory be centered around the median WHO standard?  This is equivalent to plotting the age difference score (like height-for-age difference - HAD)</dd>
  <dt>x_range</dt>
  <dd class="rd-dd">a vector specifying the range (min, max) that the superposed growth standard should span on the x-axis</dd>
  <dt>width</dt>
  <dd class="rd-dd">width of the plot</dd>
  <dt>height</dt>
  <dd class="rd-dd">height of the plot</dd>
  <dt>hover</dt>
  <dd class="rd-dd">variable names in <code>x$data</code> to show on hover for each point (only variables with non-NA data will be shown)</dd>
  <dt>checkpoints</dt>
  <dd class="rd-dd">should the checkpoints be plotted (if available)?</dd>
  <dt>p</dt>
  <dd class="rd-dd">centiles at which to draw the WHO polygons</dd>
  <dt>x_units</dt>
  <dd class="rd-dd">units of age x-axis (days, months, or years)</dd>
  <dt>...</dt>
  <dd class="rd-dd">additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/rbokeh/topics/figure>figure</a></code></dd>
</dl>


<h4>Examples</h4>
```{r plot.fittedTrajectory_id_27, eval = TRUE, lazy = TRUE }
mod <- get_fit(cpp, y_var = "wtkg", method = "rlm")
fit <- fit_trajectory(subset(cpp, subjid == 2), mod)
plot(fit)
plot(fit, x_units = "years")
plot(fit, center = TRUE)
plot(fit, hover = c("wtkg", "bmi", "waz", "haz"))

```





## plot_z

<a id="plot_z_alias"></a><h3>Plot a fitted trajectory on z-score scale</h3>


<h4>Usage</h4>
<pre class="r"><code><div>plot_z(x, x_range&nbsp;=&nbsp;NULL, nadir&nbsp;=&nbsp;FALSE, recovery&nbsp;=&nbsp;NULL, width&nbsp;=&nbsp;500, height&nbsp;=&nbsp;520, hover&nbsp;=&nbsp;NULL, checkpoints&nbsp;=&nbsp;TRUE, z&nbsp;=&nbsp;-3:0, x_units&nbsp;=&nbsp;c("days", "months", "years"), ...)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>x</dt>
  <dd class="rd-dd">an object returned from <code><a href=#fit_trajectory>fit_trajectory</a></code></dd>
  <dt>x_range</dt>
  <dd class="rd-dd">a vector specifying the range (min, max) that the superposed z-score bands should span on the x-axis</dd>
  <dt>nadir</dt>
  <dd class="rd-dd">should a guide be added to the plot showing the location of the nadir?</dd>
  <dt>recovery</dt>
  <dd class="rd-dd">age in days at which to plot recovery from nadir (only valid if nadir is TRUE) - if NULL (default), will not be plotted</dd>
  <dt>width</dt>
  <dd class="rd-dd">width of the plot</dd>
  <dt>height</dt>
  <dd class="rd-dd">height of the plot</dd>
  <dt>hover</dt>
  <dd class="rd-dd">variable names in <code>x$data</code> to show on hover for each point (only variables with non-NA data will be shown)</dd>
  <dt>checkpoints</dt>
  <dd class="rd-dd">should the checkpoints be plotted (if available)?</dd>
  <dt>z</dt>
  <dd class="rd-dd">z-scores at which to draw the z-score bands</dd>
  <dt>x_units</dt>
  <dd class="rd-dd">units of age x-axis (days, months, or years)</dd>
  <dt>...</dt>
  <dd class="rd-dd">additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/rbokeh/topics/figure>figure</a></code></dd>
</dl>


<h4>Examples</h4>
```{r plot_z_id_28, eval = TRUE, lazy = TRUE }
mod <- get_fit(cpp, y_var = "wtkg", method = "rlm")
fit <- fit_trajectory(subset(cpp, subjid == 2), mod)
plot_z(fit)

```





## plot_velocity

<a id="plot_velocity_alias"></a><h3>Plot a fitted trajectory's velocity</h3>


<h4>Usage</h4>
<pre class="r"><code><div>plot_velocity(x, width&nbsp;=&nbsp;500, height&nbsp;=&nbsp;520, x_units&nbsp;=&nbsp;c("days", "months", "years"), ...)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>x</dt>
  <dd class="rd-dd">an object returned from <code><a href=#fit_trajectory>fit_trajectory</a></code></dd>
  <dt>width</dt>
  <dd class="rd-dd">width of the plot</dd>
  <dt>height</dt>
  <dd class="rd-dd">height of the plot</dd>
  <dt>x_units</dt>
  <dd class="rd-dd">units of age x-axis (days, months, or years)</dd>
  <dt>...</dt>
  <dd class="rd-dd">additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/rbokeh/topics/figure>figure</a></code></dd>
</dl>


<h4>Examples</h4>
```{r plot_velocity_id_29, eval = TRUE, lazy = TRUE }
mod <- get_fit(cpp, y_var = "wtkg", method = "rlm")
fit <- fit_trajectory(subset(cpp, subjid == 2), mod)
plot_velocity(fit)

```





## plot_zvelocity

<a id="plot_zvelocity_alias"></a><h3>Plot a fitted trajectory's z-score velocity</h3>


<h4>Usage</h4>
<pre class="r"><code><div>plot_zvelocity(x, width&nbsp;=&nbsp;500, height&nbsp;=&nbsp;520, x_units&nbsp;=&nbsp;c("days", "months", "years"), ...)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>x</dt>
  <dd class="rd-dd">an object returned from <code><a href=#fit_trajectory>fit_trajectory</a></code></dd>
  <dt>width</dt>
  <dd class="rd-dd">width of the plot</dd>
  <dt>height</dt>
  <dd class="rd-dd">height of the plot</dd>
  <dt>x_units</dt>
  <dd class="rd-dd">units of age x-axis (days, months, or years)</dd>
  <dt>...</dt>
  <dd class="rd-dd">additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/rbokeh/topics/figure>figure</a></code></dd>
</dl>


<h4>Examples</h4>
```{r plot_zvelocity_id_30, eval = TRUE, lazy = TRUE }
mod <- get_fit(cpp, y_var = "wtkg", method = "rlm")
fit <- fit_trajectory(subset(cpp, subjid == 2), mod)
plot_zvelocity(fit)

```





## get_avail_methods

<a id="get_avail_methods_alias"></a><h3>Get names of all available fitting methods</h3>


<h4>Usage</h4>
<pre class="r"><code><div>get_avail_methods()</div></code></pre>



<h4>See also</h4>

<code><a href=#get_fit>get_fit</a></code>






## fit_method.brokenstick

<a id="fit_method.brokenstick_alias"></a><h3>Get the result of fitting brokenstick to a dataset</h3>


<h4>Usage</h4>
<pre class="r"><code><div>"fit_method"(dat, ...)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">data frame containing variables to model</dd>
  <dt>...</dt>
  <dd class="rd-dd">additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/brokenstick/topics/brokenstick>brokenstick</a></code>, most notably <code>knots</code></dd>
</dl>

  <h4>Details</h4>

  <p class="rd-p">This essentially gets an anthropometric dataset into shape for <code><a href=http://www.rdocumentation.org/packages/brokenstick/topics/brokenstick>brokenstick</a></code> (sets appropriate data structure and removes missing values) and runs the fitting routine.</p>


  <h4>Note</h4>

  <p class="rd-p">The settings for <code>x_trans</code> and <code>y_trans</code> must match that used in <code><a href=#fit_trajectory>fit_trajectory</a></code> and appropriate inverse transformations must be set there accordingly as well.</p>



<h4>Examples</h4>
```{r fit_method.brokenstick_id_32, eval = TRUE, lazy = TRUE }
## Not run: 
# bsfit <- get_fit(cpp, y_var = "haz", method = "brokenstick")
# fit <- fit_trajectory(subset(cpp, subjid == 2), fit = bsfit)
# plot(fit)
# ## End(Not run)

```





## fit_method.face

<a id="fit_method.face_alias"></a><h3>Get the result of fitting face.sparse to a dataset</h3>


<h4>Usage</h4>
<pre class="r"><code><div>"fit_method"(dat, ...)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">data frame containing variables to model</dd>
  <dt>...</dt>
  <dd class="rd-dd">additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/face/topics/face.sparse>face.sparse</a></code>, most notably <code>knots</code> which defaults to 10</dd>
</dl>

  <h4>Details</h4>

  <p class="rd-p">This essentially gets an anthropometric dataset into shape for <code><a href=http://www.rdocumentation.org/packages/face/topics/face.sparse>face.sparse</a></code> (sets appropriate data structure and removes missing values) and runs the fitting routine.</p>


  <h4>Note</h4>

  <p class="rd-p">The settings for <code>x_trans</code> and <code>y_trans</code> must match that used in <code><a href=#fit_trajectory>fit_trajectory</a></code> and appropriate inverse transformations must be set there accordingly as well.</p>



<h4>Examples</h4>
```{r fit_method.face_id_33, eval = TRUE, lazy = TRUE }
## Not run: 
# facefit <- get_fit(cpp, y_var = "haz", method = "face")
# fit <- fit_trajectory(subset(cpp, subjid == 2), fit = facefit)
# plot(fit)
# ## End(Not run)

```





## fit_method.fda

<a id="fit_method.fda_alias"></a><h3>Compute functional "fda" fit of growth trajectory</h3>


<h4>Usage</h4>
<pre class="r"><code><div>"fit_method"(dat, ...)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">data frame specifying x and y coordinates of data to fit</dd>
  <dt>...</dt>
  <dd class="rd-dd">additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/fda/topics/smooth.basisPar>smooth.basisPar</a></code>, notably <code>lambda</code> which defaults to 0.1</dd>
</dl>

  <h4>Note</h4>

  <p class="rd-p">The trajectory fitting functions are most easily accessed through calling <code><a href=#fit_trajectory>fit_trajectory</a></code> with the <code>method</code> argument to specify the modeling approach to use.</p>

  <p class="rd-p">These fitting functions can easily be replaced by simply calling the associated R methods, but are provided for convenience to standardize input/output to simplify swapping fitting methods.</p>








## fit_method.gam

<a id="fit_method.gam_alias"></a><h3>Compute gam spline fit of growth trajectory</h3>


<h4>Usage</h4>
<pre class="r"><code><div>"fit_method"(dat, ...)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">data frame specifying x and y coordinates of data to fit</dd>
  <dt>...</dt>
  <dd class="rd-dd">additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/mgcv/topics/gam>gam</a></code></dd>
</dl>

  <h4>Note</h4>

  <p class="rd-p">The trajectory fitting functions are most easily accessed through calling <code><a href=#fit_trajectory>fit_trajectory</a></code> with the <code>method</code> argument to specify the modeling approach to use.</p>

  <p class="rd-p">These fitting functions can easily be replaced by simply calling the associated R methods, but are provided for convenience to standardize input/output to simplify swapping fitting methods.</p>








## fit_method.loess

<a id="fit_method.loess_alias"></a><h3>Compute loess fit of growth trajectory</h3>


<h4>Usage</h4>
<pre class="r"><code><div>"fit_method"(dat, ...)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">data frame specifying x and y coordinates of data to fit</dd>
  <dt>...</dt>
  <dd class="rd-dd">additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/stats/topics/loess>loess</a></code>, notably <code>span</code>, <code>degree</code>, and <code>family</code></dd>
</dl>

  <h4>Note</h4>

  <p class="rd-p">The trajectory fitting functions are most easily accessed through calling <code><a href=#fit_trajectory>fit_trajectory</a></code> with the <code>method</code> argument to specify the modeling approach to use.</p>

  <p class="rd-p">These fitting functions can easily be replaced by simply calling the associated R methods, but are provided for convenience to standardize input/output to simplify swapping fitting methods.</p>








## fit_method.lwmod

<a id="fit_method.lwmod_alias"></a><h3>Get the result of fitting a Laird and Ware linear or quadratic model to a dataset</h3>


<h4>Usage</h4>
<pre class="r"><code><div>"fit_method"(dat, ...)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">data frame containing variables to model</dd>
  <dt>...</dt>
  <dd class="rd-dd">additional parameters, most notably <code>deg</code> which controls the degree of polynomial for the fit (1 for linear and 2 for quadratic)</dd>
</dl>

  <h4>Details</h4>

  <p class="rd-p">This essentially gets an anthropometric dataset into shape for <code><a href=http://www.rdocumentation.org/packages/sitar/topics/sitar>sitar</a></code> (sets appropriate data structure and removes missing values) and runs the fitting routine.</p>


  <h4>Note</h4>

  <p class="rd-p">The settings for <code>x_trans</code> and <code>y_trans</code> must match that used in <code><a href=#fit_trajectory>fit_trajectory</a></code> and appropriate inverse transformations must be set there accordingly as well.</p>



<h4>Examples</h4>
```{r fit_method.lwmod_id_37, eval = TRUE, lazy = TRUE }
## Not run: 
# lwfit <- get_fit(cpp, y_var = "haz", method = "lwmod", deg = 2)
# fit <- fit_trajectory(subset(cpp, subjid == 2), fit = lwfit)
# plot(fit)
# ## End(Not run)

```





## fit_method.rlm

<a id="fit_method.rlm_alias"></a><h3>Compute robust linear model fit of growth trajectory</h3>


<h4>Usage</h4>
<pre class="r"><code><div>"fit_method"(dat, ...)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">data frame specifying x and y coordinates of data to fit</dd>
  <dt>...</dt>
  <dd class="rd-dd">additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/MASS/topics/rlm>rlm</a></code>, also <code>p</code> which is the order of polynomial fit (default is quadratic, p=2)</dd>
</dl>

  <h4>Note</h4>

  <p class="rd-p">The trajectory fitting functions are most easily accessed through calling <code><a href=#fit_trajectory>fit_trajectory</a></code> with the <code>method</code> argument to specify the modeling approach to use.</p>

  <p class="rd-p">These fitting functions can easily be replaced by simply calling the associated R methods, but are provided for convenience to standardize input/output to simplify swapping fitting methods.</p>








## fit_method.sitar

<a id="fit_method.sitar_alias"></a><h3>Get the result of fitting sitar to a dataset</h3>


<h4>Usage</h4>
<pre class="r"><code><div>"fit_method"(dat, ...)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">data frame containing variables to model</dd>
  <dt>...</dt>
  <dd class="rd-dd">additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/sitar/topics/sitar>sitar</a></code>, most notably <code>df</code> which defaults to 3</dd>
</dl>

  <h4>Details</h4>

  <p class="rd-p">This essentially gets an anthropometric dataset into shape for <code><a href=http://www.rdocumentation.org/packages/sitar/topics/sitar>sitar</a></code> (sets appropriate data structure and removes missing values) and runs the fitting routine.</p>


  <h4>Note</h4>

  <p class="rd-p">The settings for <code>x_trans</code> and <code>y_trans</code> must match that used in <code><a href=#fit_trajectory>fit_trajectory</a></code> and appropriate inverse transformations must be set there accordingly as well.</p>



<h4>Examples</h4>
```{r fit_method.sitar_id_39, eval = TRUE, lazy = TRUE }
## Not run: 
# sitfit <- get_fit(cpp, y_var = "haz", method = "sitar")
# fit <- fit_trajectory(subset(cpp, subjid == 2), fit = sitfit)
# plot(fit)
# ## End(Not run)

```





## fit_method.smooth.spline

<a id="fit_method.smooth.spline_alias"></a><h3>Compute smooth.spline fit of growth trajectory</h3>


<h4>Usage</h4>
<pre class="r"><code><div>"fit_method"(dat, ...)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">data frame specifying x and y coordinates of data to fit</dd>
  <dt>...</dt>
  <dd class="rd-dd">additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/stats/topics/smooth.spline>smooth.spline</a></code></dd>
</dl>

  <h4>Note</h4>

  <p class="rd-p">The trajectory fitting functions are most easily accessed through calling <code><a href=#fit_trajectory>fit_trajectory</a></code> with the <code>method</code> argument to specify the modeling approach to use.</p>

  <p class="rd-p">These fitting functions can easily be replaced by simply calling the associated R methods, but are provided for convenience to standardize input/output to simplify swapping fitting methods.</p>








## fit_method.wand

<a id="fit_method.wand_alias"></a><h3>Get the result of fitting a "Wand" model to a dataset</h3>


<h4>Usage</h4>
<pre class="r"><code><div>"fit_method"(dat, ...)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">data frame containing variables to model</dd>
  <dt>...</dt>
  <dd class="rd-dd">additional parameters, most notably <code>deg</code> which controls the degree of polynomial for the fit (1 for linear and 2 for quadratic)</dd>
</dl>

  <h4>Details</h4>

  <p class="rd-p">This essentially gets an anthropometric dataset into shape for <code><a href=http://www.rdocumentation.org/packages/sitar/topics/sitar>sitar</a></code> (sets appropriate data structure and removes missing values) and runs the fitting routine.</p>


  <h4>Note</h4>

  <p class="rd-p">The settings for <code>x_trans</code> and <code>y_trans</code> must match that used in <code><a href=#fit_trajectory>fit_trajectory</a></code> and appropriate inverse transformations must be set there accordingly as well.</p>



<h4>Examples</h4>
```{r fit_method.wand_id_41, eval = TRUE, lazy = TRUE }
## Not run: 
# wfit <- get_fit(cpp, y_var = "haz", method = "lwmod", deg = 2)
# fit <- fit_trajectory(subset(cpp, subjid == 2), fit = wfit)
# plot(fit)
# ## End(Not run)

```





## auto_loess

<a id="auto_loess_alias"></a><h3>Find best loess fit based on aic or gcv</h3>


<h4>Usage</h4>
<pre class="r"><code><div>auto_loess(data, span&nbsp;=&nbsp;c(0.01, 2), degree&nbsp;=&nbsp;c(1, 2), family&nbsp;=&nbsp;"gaussian", which&nbsp;=&nbsp;"gcv", ...)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>data</dt>
  <dd class="rd-dd">a data frame with columns x and y to be used in the fitting</dd>
  <dt>span</dt>
  <dd class="rd-dd">a vector indicating a range (min, max) of spans to search over</dd>
  <dt>degree</dt>
  <dd class="rd-dd">a vector of degrees to search over (valid values are combinations of 0, 1, 2)</dd>
  <dt>family</dt>
  <dd class="rd-dd">loess <code>family</code> parameter</dd>
  <dt>which</dt>
  <dd class="rd-dd">which method to use, "aicc" or "gcv"</dd>
  <dt>...</dt>
  <dd class="rd-dd">additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/stats/topics/loess>loess</a></code></dd>
</dl>



# Summary Vis





## plot_univar

<a id="plot_univar_alias"></a><h3>Make a grid of univariate summary plots</h3>


<h4>Usage</h4>
<pre class="r"><code><div>plot_univar(dat, subject&nbsp;=&nbsp;FALSE, ncol&nbsp;=&nbsp;3, width&nbsp;=&nbsp;300, height&nbsp;=&nbsp;300)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">data frame</dd>
  <dt>subject</dt>
  <dd class="rd-dd">should subject-level (TRUE) or time-varying (FALSE) variables be plotted?</dd>
  <dt>ncol</dt>
  <dd class="rd-dd">number of columns in the grid</dd>
  <dt>width</dt>
  <dd class="rd-dd">width of each plot in pixels</dd>
  <dt>height</dt>
  <dd class="rd-dd">height of each plot in pixels</dd>
</dl>

  <h4>Details</h4>

  <p class="rd-p">Subject-level variables are treated differently than time-varying variables in that they are repeated for each subject.  When plotting summaries of subject-level variables, the data is first subset to one record per subject.</p>



<h4>Examples</h4>
```{r plot_univar_id_43, eval = TRUE, lazy = TRUE }
plot_univar(cpp, subject = TRUE)
plot_univar(cpp)

```





## plot_missing

<a id="plot_missing_alias"></a><h3>Plot a stacked bar chart indicating NAs for each variable in a dataset</h3>


<h4>Usage</h4>
<pre class="r"><code><div>plot_missing(dat, subject&nbsp;=&nbsp;FALSE, width&nbsp;=&nbsp;800, height&nbsp;=&nbsp;500, ...)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">data frame</dd>
  <dt>subject</dt>
  <dd class="rd-dd">should subject-level (TRUE) or time-varying (FALSE) variables be plotted?</dd>
  <dt>width</dt>
  <dd class="rd-dd">width of plot in pixels</dd>
  <dt>height</dt>
  <dd class="rd-dd">height of plot in pixels</dd>
  <dt>...</dt>
  <dd class="rd-dd">additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/rbokeh/topics/figure>figure</a></code></dd>
</dl>

  <h4>Details</h4>

  <p class="rd-p">Subject-level variables are treated differently than time-varying variables in that they are repeated for each subject.  When plotting summaries of subject-level variables, the data is first subset to one record per subject.</p>



<h4>Examples</h4>
```{r plot_missing_id_44, eval = TRUE, lazy = TRUE }
plot_missing(cpp)
plot_missing(cpp, subject = TRUE)

```





## plot_complete_pairs

<a id="plot_complete_pairs_alias"></a><h3>Plot a heat map of frequency of "complete" (both non-NA) pairs of variables</h3>


<h4>Usage</h4>
<pre class="r"><code><div>plot_complete_pairs(dat, subject&nbsp;=&nbsp;FALSE, width&nbsp;=&nbsp;700, height&nbsp;=&nbsp;700, thresh&nbsp;=&nbsp;0.95, ...)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">data frame</dd>
  <dt>subject</dt>
  <dd class="rd-dd">should subject-level (TRUE) or time-varying (FALSE) variables be plotted?</dd>
  <dt>width</dt>
  <dd class="rd-dd">width of plot in pixels</dd>
  <dt>height</dt>
  <dd class="rd-dd">height of plot in pixels</dd>
  <dt>thresh</dt>
  <dd class="rd-dd">percentage NA threshold above which variables will be ignored (to help deal with cases involving many variables)</dd>
  <dt>...</dt>
  <dd class="rd-dd">additional parameters passed to <code><a href=http://www.rdocumentation.org/packages/rbokeh/topics/figure>figure</a></code></dd>
</dl>

  <h4>Details</h4>

  <p class="rd-p">Subject-level variables are treated differently than time-varying variables in that they are repeated for each subject.  When plotting summaries of subject-level variables, the data is first subset to one record per subject.</p>



<h4>Examples</h4>
```{r plot_complete_pairs_id_45, eval = TRUE, lazy = TRUE }
plot_complete_pairs(cpp)
plot_complete_pairs(cpp, subject = TRUE)

```





## plot_agefreq

<a id="plot_agefreq_alias"></a><h3>Plot age frequency</h3>


<h4>Usage</h4>
<pre class="r"><code><div>plot_agefreq(x, xlab&nbsp;=&nbsp;"Age since birth at examination (days)", ylab&nbsp;=&nbsp;"# examinations", width&nbsp;=&nbsp;700, height&nbsp;=&nbsp;350, age_units&nbsp;=&nbsp;c("days", "months", "years"))</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>x</dt>
  <dd class="rd-dd">a data frame of raw data or an object returned from <code><a href=#get_agefreq>get_agefreq</a></code></dd>
  <dt>xlab</dt>
  <dd class="rd-dd">label for x axis</dd>
  <dt>ylab</dt>
  <dd class="rd-dd">label for y axis</dd>
  <dt>width</dt>
  <dd class="rd-dd">width of plot in pixels</dd>
  <dt>height</dt>
  <dd class="rd-dd">height of plot in pixels</dd>
  <dt>age_units</dt>
  <dd class="rd-dd">units of age x-axis (days, months, or years)</dd>
</dl>


<h4>Examples</h4>
```{r plot_agefreq_id_46, eval = TRUE, lazy = TRUE }

agefreq <- get_agefreq(cpp)
plot_agefreq(agefreq)


```





## plot_first_visit_age

<a id="plot_first_visit_age_alias"></a><h3>Plot histogram and quantile plot of age at first visit</h3>


<h4>Usage</h4>
<pre class="r"><code><div>plot_first_visit_age(dat, agelab&nbsp;=&nbsp;"first visit age (days)", width&nbsp;=&nbsp;450, height&nbsp;=&nbsp;450)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">a longitudinal growth study dataset</dd>
  <dt>agelab</dt>
  <dd class="rd-dd">label of the age axis</dd>
  <dt>width</dt>
  <dd class="rd-dd">the width of each plot in pixels</dd>
  <dt>height</dt>
  <dd class="rd-dd">the height of each plot in pixels</dd>
</dl>


<h4>Examples</h4>
```{r plot_first_visit_age_id_47, eval = TRUE, lazy = TRUE }

plot_first_visit_age(cpp)


```





## plot_visit_distn

<a id="plot_visit_distn_alias"></a><h3>Plot histogram and quantile plot of number of "visits" for each subject</h3>


<h4>Usage</h4>
<pre class="r"><code><div>plot_visit_distn(dat, width&nbsp;=&nbsp;450, height&nbsp;=&nbsp;450)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">a longitudinal growth study dataset</dd>
  <dt>width</dt>
  <dd class="rd-dd">the width of each plot in pixels</dd>
  <dt>height</dt>
  <dd class="rd-dd">the height of each plot in pixels</dd>
</dl>


<h4>Examples</h4>
```{r plot_visit_distn_id_48, eval = TRUE, lazy = TRUE }

plot_visit_distn(cpp)


```

# Multi-Study Vis





## plot_var_matrix

<a id="plot_var_matrix_alias"></a><h3>Plot a matrix comparing variables present in a list of studies</h3>


<h4>Usage</h4>
<pre class="r"><code><div>plot_var_matrix(dat_list, width&nbsp;=&nbsp;845, h_padding&nbsp;=&nbsp;0, head&nbsp;=&nbsp;NULL)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat_list</dt>
  <dd class="rd-dd">a list of data frames containing study data</dd>
  <dt>width</dt>
  <dd class="rd-dd">width of the plot in pixels</dd>
  <dt>h_padding</dt>
  <dd class="rd-dd">extra height to add to the plot to account for long variable names</dd>
  <dt>head</dt>
  <dd class="rd-dd">the number of variables to limit the x-axis to (if negative, it will show all but the first <code>head</code> variables)</dd>
</dl>


<h4>Examples</h4>
```{r plot_var_matrix_id_49, eval = TRUE, lazy = TRUE }
dat_list <- list(
  cpp1 = cpp[, c(1:5, 7:9, 14:19, 23:32)],
  cpp2 = cpp[, c(1:5, 11:24)],
  cpp3 = cpp
)
plot_var_matrix(dat_list)

```





## plot_multi_subj_boxplot

<a id="plot_multi_subj_boxplot_alias"></a><h3>Plot boxplots of distrubutions of number of records per subject for a list of studies</h3>


<h4>Usage</h4>
<pre class="r"><code><div>plot_multi_subj_boxplot(dat_list, width&nbsp;=&nbsp;800, height&nbsp;=&nbsp;500)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat_list</dt>
  <dd class="rd-dd">a list of data frames containing study data</dd>
  <dt>width</dt>
  <dd class="rd-dd">width of the plot in pixels</dd>
  <dt>height</dt>
  <dd class="rd-dd">height of the plot in pixels</dd>
</dl>


<h4>Examples</h4>
```{r plot_multi_subj_boxplot_id_50, eval = TRUE, lazy = TRUE }
dat_list <- list(
  cpp1 = cpp,
  cpp2 = cpp,
  cpp3 = cpp
)
plot_multi_subj_boxplot(dat_list)

```





## plot_time_count_grid

<a id="plot_time_count_grid_alias"></a><h3>Plot counts by age for a list of studies</h3>


<h4>Usage</h4>
<pre class="r"><code><div>plot_time_count_grid(dat_list, xlab&nbsp;=&nbsp;"Age since birth at examination (days)", width&nbsp;=&nbsp;845, height&nbsp;=&nbsp;120, y_margin&nbsp;=&nbsp;100)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat_list</dt>
  <dd class="rd-dd">a list of data frames containing study data</dd>
  <dt>xlab</dt>
  <dd class="rd-dd">label for x axis</dd>
  <dt>width</dt>
  <dd class="rd-dd">width of the plot in pixels</dd>
  <dt>height</dt>
  <dd class="rd-dd">height of each panel of the plot in pixels</dd>
  <dt>y_margin</dt>
  <dd class="rd-dd">minimum padding for axis tick labels on left</dd>
</dl>


<h4>Examples</h4>
```{r plot_time_count_grid_id_51, eval = TRUE, lazy = TRUE }
dat_list <- list(
  cpp1 = cpp,
  cpp2 = cpp,
  cpp3 = cpp
)
plot_time_count_grid(dat_list)

```

# Trelliscope Vis





## trscope_trajectories

<a id="trscope_trajectories_alias"></a><h3>Create Trelliscope display of per-subject data and fitted trajectories</h3>


<h4>Usage</h4>
<pre class="r"><code><div>trscope_trajectories(dat, z&nbsp;=&nbsp;FALSE, center&nbsp;=&nbsp;FALSE, x_range&nbsp;=&nbsp;NULL, width&nbsp;=&nbsp;500, height&nbsp;=&nbsp;520, name&nbsp;=&nbsp;NULL, desc&nbsp;=&nbsp;"", group&nbsp;=&nbsp;NULL, vdb_conn&nbsp;=&nbsp;getOption("vdbConn"), nadir&nbsp;=&nbsp;FALSE, recovery&nbsp;=&nbsp;NULL, x_units&nbsp;=&nbsp;"days")</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">either a data frame or object created by <code><a href=#by_subject>by_subject</a></code> or <code><a href=#fit_all_trajectories>fit_all_trajectories</a></code></dd>
  <dt>z</dt>
  <dd class="rd-dd">should the trajectory fit be plotted on the z-scale?</dd>
  <dt>center</dt>
  <dd class="rd-dd">should the trajectory be centered around the median WHO standard?</dd>
  <dt>x_range</dt>
  <dd class="rd-dd">a vector specifying the range (min, max) that the superposed WHO growth standard should span on the x-axis</dd>
  <dt>width</dt>
  <dd class="rd-dd">width of the plot</dd>
  <dt>height</dt>
  <dd class="rd-dd">height of the plot</dd>
  <dt>name</dt>
  <dd class="rd-dd">name of the Trelliscope display (if left NULL, will be implied by the variables being plotted and the method name)</dd>
  <dt>desc</dt>
  <dd class="rd-dd">description of the Trelliscope display</dd>
  <dt>group</dt>
  <dd class="rd-dd">group in which to place the Trelliscope display</dd>
  <dt>vdb_conn</dt>
  <dd class="rd-dd">an optional VDB connection</dd>
  <dt>nadir</dt>
  <dd class="rd-dd">should a guide be added to the plot showing the location of the nadir? (only valid when z = TRUE)</dd>
  <dt>recovery</dt>
  <dd class="rd-dd">age in days at which to plot recovery from nadir (only valid when z = TRUE) - if NULL (default), will not be plotted</dd>
  <dt>x_units</dt>
  <dd class="rd-dd">units of age x-axis (days, months, or years)</dd>
</dl>


<h4>Examples</h4>
```{r trscope_trajectories_id_52, eval = TRUE, lazy = TRUE }
## Not run: 
# cppsubj  <- by_subject(cpp)
# cppfit   <- get_fit(cpp, method = "rlm")
# cpptr    <- fit_all_trajectories(cppsubj, cppfit)
# cppplot  <- trscope_trajectories(cpptr)
# cppzplot <- trscope_trajectories(cpptr, z = TRUE, nadir = TRUE, x_units = "months")
# ## End(Not run)

```





## trscope_velocities

<a id="trscope_velocities_alias"></a><h3>Create Trelliscope display of the velocities of per-subject fitted trajectories</h3>


<h4>Usage</h4>
<pre class="r"><code><div>trscope_velocities(dat, z&nbsp;=&nbsp;FALSE, x_range&nbsp;=&nbsp;NULL, width&nbsp;=&nbsp;500, height&nbsp;=&nbsp;520, name&nbsp;=&nbsp;NULL, desc&nbsp;=&nbsp;"", group&nbsp;=&nbsp;NULL, vdb_conn&nbsp;=&nbsp;getOption("vdbConn"), nadir&nbsp;=&nbsp;FALSE, recovery&nbsp;=&nbsp;NULL, x_units&nbsp;=&nbsp;"days")</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">either a data frame or object created by <code><a href=#by_subject>by_subject</a></code> or <code><a href=#fit_all_trajectories>fit_all_trajectories</a></code></dd>
  <dt>z</dt>
  <dd class="rd-dd">should velocities according to z-score scale or raw scale be plotted?</dd>
  <dt>x_range</dt>
  <dd class="rd-dd">a vector specifying the range (min, max) that the x-axis should span</dd>
  <dt>width</dt>
  <dd class="rd-dd">width of the plot</dd>
  <dt>height</dt>
  <dd class="rd-dd">height of the plot</dd>
  <dt>name</dt>
  <dd class="rd-dd">name of the Trelliscope display (if NULL, will be implied by the variables being plotted and the method name)</dd>
  <dt>desc</dt>
  <dd class="rd-dd">description of the Trelliscope display</dd>
  <dt>group</dt>
  <dd class="rd-dd">group in which to place the Trelliscope display</dd>
  <dt>vdb_conn</dt>
  <dd class="rd-dd">an optional VDB connection</dd>
  <dt>nadir</dt>
  <dd class="rd-dd">should a guide be added to the plot showing the location of the nadir? (only valid when z = TRUE)</dd>
  <dt>recovery</dt>
  <dd class="rd-dd">age in days at which to plot recovery from nadir (only valid when z = TRUE) - if NULL (default), will not be plotted</dd>
  <dt>x_units</dt>
  <dd class="rd-dd">units of age x-axis (days, months, or years)</dd>
</dl>


<h4>Examples</h4>
```{r trscope_velocities_id_53, eval = TRUE, lazy = TRUE }
## Not run: 
# cppsubj <- by_subject(cpp)
# cppfit  <- get_fit(cpp, method = "rlm")
# cpptr   <- fit_all_trajectories(cppsubj, cppfit)
# cppplot <- trscope_velocities(cpptr)
# ## End(Not run)

```

# Divisions





## by_subject

<a id="by_subject_alias"></a><h3>Divide a dataset into subsets by subject</h3>


<h4>Usage</h4>
<pre class="r"><code><div>by_subject(dat)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">dataset to divide by subject</dd>
</dl>


<h4>Examples</h4>
```{r by_subject_id_54, eval = TRUE, lazy = TRUE }
cppsubj <- by_subject(cpp)

```





## by_trajectory_checkpoints

<a id="by_trajectory_checkpoints_alias"></a><h3>Split by-subject trajectory-fitted data by checkpoint categorizations</h3>


<h4>Usage</h4>
<pre class="r"><code><div>by_trajectory_checkpoints(dat, complete&nbsp;=&nbsp;TRUE)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">a data object returned by <code><a href=#fit_all_trajectories>fit_all_trajectories</a></code></dd>
  <dt>complete</dt>
  <dd class="rd-dd">subset only to those that have fitted checkpoints</dd>
</dl>


<h4>Examples</h4>
```{r by_trajectory_checkpoints_id_55, eval = TRUE, lazy = TRUE }
## Not run: 
# cppsubj <- by_subject(cpp)
# cppfit  <- get_fit(cpp, method = "rlm")
# cpptr   <- fit_all_trajectories(cppsubj, cppfit)
# cppcp   <- by_trajectory_checkpoints(cpptr)
# ## End(Not run)

```

# Data Sets





## cpp

<a id="cpp_alias"></a><h3>Subset of growth data from the collaborative perinatal project (CPP)</h3>

<p class="rd-p">Subset of growth data from the collaborative perinatal project (CPP).</p>

<h4>Usage</h4>
<pre class="r"><code><div>cpp</div></code></pre>

  <h4>Source</h4>

  <p class="rd-p"><a href = https://catalog.archives.gov/id/606622>https://catalog.archives.gov/id/606622</a></p>

  <p class="rd-p">Broman, Sarah. "The collaborative perinatal project: an overview." Handbook of longitudinal research 1 (1984): 185-227.</p>



<h4>Examples</h4>
```{r cpp_id_56, eval = TRUE, lazy = TRUE }
head(cpp)

```





## get_smocc_data

<a id="get_smocc_data_alias"></a><h3>Get SMOCC data from brokenstick, transformed to be hbgd-compatible</h3>


<h4>Usage</h4>
<pre class="r"><code><div>get_smocc_data()</div></code></pre>







## who_coefs

<a id="who_coefs_alias"></a><h3>List of WHO growth standard coefficients</h3>

<p class="rd-p">A list of coefficients from the WHO for various pairs of growth standards that are used to compute quantiles and z-scores.  The format is a list, where each element is a pairing of variables, e.g. "wtkg_agedays", "htcm_agedays", "bmi_agedays", "hcircm_agedays", "muaccm_agedays", "ss_agedays", "tsftmm_agedays", "wtkg_lencm""wtkg_htcm".  Within each of these elements is a list for sex with names "Female" and "Male".</p>

  <h4>Source</h4>

  <p class="rd-p">0-5 years: <a href = http://www.who.int/childgrowth/software/en/>http://www.who.int/childgrowth/software/en/</a></p>

  <p class="rd-p">5-15 years: <a href = http://www.who.int/growthref/tools/en/>http://www.who.int/growthref/tools/en/</a></p>



<h4>Examples</h4>
```{r who_coefs_id_58, eval = TRUE, lazy = TRUE }
head(who_coefs$htcm_age$Female$data)

```

<h4>See also</h4>

<code><a href=#who_centile2value>who_centile2value</a></code>, <code><a href=#who_value2zscore>who_value2centile</a></code>, <code><a href=#who_centile2value>who_zscore2value</a></code>, <code><a href=#who_value2zscore>who_value2zscore</a></code>






## ig_coefs

<a id="ig_coefs_alias"></a><h3>List of INTERGROWTH birth standard coefficients</h3>

<p class="rd-p">A list of coefficients from the INTERGROWTH birth standard.</p>

  <h4>Source</h4>

  <p class="rd-p"><a href = https://intergrowth21.tghn.org>https://intergrowth21.tghn.org</a></p>


  <h4>References</h4>

  <p class="rd-p">International standards for newborn weight, length, and head circumference by gestational age and sex: the Newborn Cross-Sectional Study of the INTERGROWTH-21st Project
Villar, José et al.
The Lancet, Volume 384, Issue 9946, 857-868</p>



<h4>Examples</h4>
```{r ig_coefs_id_59, eval = TRUE, lazy = TRUE }
head(ig_coefs$hcircm$Female)

```

<h4>See also</h4>

<code><a href=#igb_zscore2value>igb_centile2value</a></code>, <code><a href=#igb_value2zscore>igb_value2centile</a></code>, <code><a href=#igb_zscore2value>igb_zscore2value</a></code>, <code><a href=#igb_value2zscore>igb_value2zscore</a></code>






## ig_early_coefs

<a id="ig_early_coefs_alias"></a><h3>List of INTERGROWTH very preterm birth standard coefficients</h3>

<p class="rd-p">A list of coefficients from the INTERGROWTH very preterm birth standard.</p>

  <h4>Source</h4>

  <p class="rd-p"><a href = https://intergrowth21.tghn.org>https://intergrowth21.tghn.org</a></p>


  <h4>References</h4>

  <p class="rd-p">INTERGROWTH-21st very preterm size at birth reference charts. Lancet  2016 doi.org/10.1016/S0140-6736(16) 00384-6.
Villar, José et al.</p>



<h4>Examples</h4>
```{r ig_early_coefs_id_60, eval = TRUE, lazy = TRUE }
ig_early_coefs$hcircm$Female

```

<h4>See also</h4>

<code><a href=#igb_zscore2value>igb_centile2value</a></code>, <code><a href=#igb_value2zscore>igb_value2centile</a></code>, <code><a href=#igb_zscore2value>igb_zscore2value</a></code>, <code><a href=#igb_value2zscore>igb_value2zscore</a></code>






## hbgd_labels

<a id="hbgd_labels_alias"></a><h3>Labels for common variable names in hbgd data</h3>

<p class="rd-p">Labels for common variable names in hbgd data, used in <code><a href='get_data_attributes.html'>get_data_attributes</a></code> if labels are not explicitly provided.</p>

<h4>Usage</h4>
<pre class="r"><code><div>hbgd_labels</div></code></pre>



<h4>See also</h4>

<code><a href=#get_data_attributes>get_data_attributes</a></code>






## hbgd_labels_df

<a id="hbgd_labels_df_alias"></a><h3>Labels for common variable names in hbgd data</h3>

<p class="rd-p">Labels for common variable names in hbgd data, used in <code><a href='get_data_attributes.html'>get_data_attributes</a></code> if labels are not explicitly provided.</p>

<h4>Usage</h4>
<pre class="r"><code><div>hbgd_labels_df</div></code></pre>



# Misc





## get_x_range

<a id="get_x_range_alias"></a><h3>Get the x-axis range across all subjects</h3>


<h4>Usage</h4>
<pre class="r"><code><div>get_x_range(dat, pad&nbsp;=&nbsp;0.07)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">object obtained from <code><a href=#fit_all_trajectories>fit_all_trajectories</a></code></dd>
  <dt>pad</dt>
  <dd class="rd-dd">padding factor - this much space as a multiple of the span of the x range will be added to the min and max</dd>
</dl>







## grid_deriv

<a id="grid_deriv_alias"></a><h3>Estimate derivative given a grid of points</h3>


<h4>Usage</h4>
<pre class="r"><code><div>grid_deriv(x, y)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>x</dt>
  <dd class="rd-dd">x variable (should be a regularly-spaced grid of points)</dd>
  <dt>y</dt>
  <dd class="rd-dd">y variable</dd>
</dl>







## get_agefreq

<a id="get_agefreq_alias"></a><h3>Get age frequency</h3>


<h4>Usage</h4>
<pre class="r"><code><div>get_agefreq(dat, age_range&nbsp;=&nbsp;NULL)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>dat</dt>
  <dd class="rd-dd">a longitudinal growth study dataset</dd>
  <dt>age_range</dt>
  <dd class="rd-dd">optional range to ....</dd>
</dl>


<h4>Examples</h4>
```{r get_agefreq_id_65, eval = TRUE, lazy = TRUE }

agefreq <- get_agefreq(cpp)
plot_agefreq(agefreq)


```





## log10_1

<a id="log10_1_alias"></a><h3>log base 10 plus 1</h3>


<h4>Usage</h4>
<pre class="r"><code><div>log10_1(x)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>x</dt>
  <dd class="rd-dd">vector of data</dd>
</dl>







## exp10_1

<a id="exp10_1_alias"></a><h3>Inverse of log base 10 plus 1</h3>


<h4>Usage</h4>
<pre class="r"><code><div>exp10_1(x)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>x</dt>
  <dd class="rd-dd">vector of data</dd>
</dl>







## get_nadir

<a id="get_nadir_alias"></a><h3>Get nadir of z-scale growth trajectory</h3>


<h4>Usage</h4>
<pre class="r"><code><div>get_nadir(obj)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>obj</dt>
  <dd class="rd-dd">object created from <code><a href=#fit_trajectory>fit_trajectory</a></code></dd>
</dl>







## get_recovery

<a id="get_recovery_alias"></a><h3>Get recovery statistics of z-scale growth trajectory</h3>


<h4>Usage</h4>
<pre class="r"><code><div>get_recovery(obj, nadir&nbsp;=&nbsp;NULL, at&nbsp;=&nbsp;365.25 * 3)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>obj</dt>
  <dd class="rd-dd">object created from <code><a href=#fit_trajectory>fit_trajectory</a></code></dd>
  <dt>nadir</dt>
  <dd class="rd-dd">object created from <code><a href=#get_nadir>get_nadir</a></code> (if NULL, will be automatically generated)</dd>
  <dt>at</dt>
  <dd class="rd-dd">age (in days) at which to estimate recovery</dd>
</dl>



# Unit Conversion





## Unit conversion

<a id="unit_conversion_alias"></a><h3>Unit conversion utility functions</h3>


<h4>Usage</h4>
<pre class="r"><code><div>cm2in(x)</div>
<div>in2cm(x)</div>
<div>lb2kg(x)</div>
<div>kg2lb(x)</div>
<div>days2years(x)</div>
<div>years2days(x)</div>
<div>days2months(x)</div>
<div>months2days(x)</div>
<div>months2years(x)</div>
<div>years2months(x)</div></code></pre>

<h4>Arguments</h4>
<dl class="rd-dl">
  <dt>x</dt>
  <dd class="rd-dd">value(s) to convert</dd>
</dl>



